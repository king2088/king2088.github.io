<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>APP开发之在CHROME中进行真机调试</title>
    <url>/2019/12/08/APP%E5%BC%80%E5%8F%91%E4%B9%8B%E5%9C%A8CHROME%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95/</url>
    <content><![CDATA[<p>使用cordova或者ionic进行app开发时，在浏览器端总是无法监听到cordova插件的运行效果，我们总是需要将app安装到手机上进行运行查看，但是在手机上我们仅能进行查看运行效果，如果哪里出错了我们并无法发现，也不会报console错误，chrome为我们提供了一个很不错的设备调试工具，通过chrome的设备调试工具，我们可以连接到手机以及模拟器，并进行监听运行状态。<br>如果你使用的是手机进行调试，那么请打开你的usb调试功能，否则chrome无法识别你的设备，我使用的是android逍遥游模拟器，下面就来看看如何进行调试吧！</p>
<h2 id="手机USB调试打开，数据线连接到电脑"><a href="#手机USB调试打开，数据线连接到电脑" class="headerlink" title="手机USB调试打开，数据线连接到电脑"></a>手机USB调试打开，数据线连接到电脑</h2><p>在命令行输入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">adb devices</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>查看是否已经连接上手机设备<br>（如果是模拟器）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">adb connect 127.0.0.1:端口号</span></pre></td></tr></table></figure>
<h2 id="在chrome中输入如下命令"><a href="#在chrome中输入如下命令" class="headerlink" title="在chrome中输入如下命令"></a>在chrome中输入如下命令</h2><p>chrome://inspect<br>chrome会为你找到目前已经连接的Android设备</p>
<img src="/2019/12/08/APP%E5%BC%80%E5%8F%91%E4%B9%8B%E5%9C%A8CHROME%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95/20170702205222.jpg" class="" title="chrome:&#x2F;&#x2F;inspect界面">
<h2 id="点击inspect"><a href="#点击inspect" class="headerlink" title="点击inspect"></a>点击inspect</h2><img src="/2019/12/08/APP%E5%BC%80%E5%8F%91%E4%B9%8B%E5%9C%A8CHROME%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95/20170702205350.jpg" class="" title="真机调试">
<p>看到鼠标移动到element上的时候，真机中的效果了吧，这样你就可以使用chrome为你的app进行调试了，你可以查看console信息，可以发现是哪里出现了问题！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>app</tag>
        <tag>chrome</tag>
        <tag>真机调试</tag>
      </tags>
  </entry>
  <entry>
    <title>IONIC2+使用SLIDES打造漂亮的导航条</title>
    <url>/2019/12/07/IONIC2-%E4%BD%BF%E7%94%A8SLIDES%E6%89%93%E9%80%A0%E6%BC%82%E4%BA%AE%E7%9A%84%E5%AF%BC%E8%88%AA%E6%9D%A1/</url>
    <content><![CDATA[<p>由于之前遇到一个项目使用的ionic中的tabs来做导航条，实际在使用中，总是觉得怪怪的，并且不只是影响到使用效果，更是发生了很多令我费解的问题，由于导航级别太多、分类太复杂，从而导致了tabs的展示令人头痛。不过由于项目已经固化了，没法再进行相应修改和调整，目前也没有重构的打算。也是由于这个一个tabs，当时让我想到了使用Slides组件来打造一个导航条。大家可以先看一下效果：</p>
<img src="/2019/12/07/IONIC2-%E4%BD%BF%E7%94%A8SLIDES%E6%89%93%E9%80%A0%E6%BC%82%E4%BA%AE%E7%9A%84%E5%AF%BC%E8%88%AA%E6%9D%A1/QQ20180704-164606.gif" class="" title="导航条">
<p>根据Slides的滑动特性，其实还是可以做出很漂亮的导航效果来，下面直接上代码，如果对slides不是很了解的，可以查看相关官方文档<br><a href="https://ionicframework.com/docs/api/components/slides/Slides/" target="_blank" rel="noopener">https://ionicframework.com/docs/api/components/slides/Slides/</a></p>
<a id="more"></a>
<p>1、html代码</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ion-header</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">ion-navbar</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"slides-header"</span> #<span class="attr">sliderHeader</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="tag">&lt;<span class="name">ion-slides</span> #<span class="attr">ionSlides</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">ion-slide</span> *<span class="attr">ngFor</span>=<span class="string">"let nav of navContent"</span> (<span class="attr">click</span>)=<span class="string">"ionSlideDidClick(nav.id)"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"nav-name"</span>&gt;</span>&#123;&#123;nav.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">ion-slide</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="tag">&lt;/<span class="name">ion-slides</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">ion-navbar</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">ion-header</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ion-content</span> <span class="attr">padding</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;&#123; content &#125;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">ion-content</span>&gt;</span></span></pre></td></tr></table></figure>
<p>2、css代码</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">page-home</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    .slides-header&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="selector-class">.slide-zoom</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attribute">font-size</span>: <span class="number">1.6rem</span> <span class="meta">!important</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            .nav-name&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="selector-tag">padding</span>: 8<span class="selector-tag">px</span> 5<span class="selector-tag">px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="selector-class">.active-now</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attribute">color</span>: <span class="number">#038ef9</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>3、typescript代码（采用模拟数据）</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, ViewChild, ElementRef, Renderer2 &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavController, Slides &#125; <span class="keyword">from</span> <span class="string">'ionic-angular'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  selector: <span class="string">'page-home'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  templateUrl: <span class="string">'home.html'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HomePage &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">public</span> navContent = [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">1</span>,name:<span class="string">'热点'</span>,title:<span class="string">'热点新闻'</span>,content:<span class="string">'This starter project comes with simple tabs-based layout for apps that are going to primarily use a Tabbed UI.'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">2</span>,name:<span class="string">'新闻'</span>,title:<span class="string">'国内新闻'</span>,content:<span class="string">'在知乎上得知了有这么一个证,然后自己买了相关书籍看了一遍,发现还是学的不… 显示全部 编辑于 2015-08-19 关注问题 78 条评论 感谢 分享 收藏 • 没有'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">3</span>,name:<span class="string">'推荐'</span>,title:<span class="string">'推荐内容'</span>,content:<span class="string">'新闻，是指报纸、电台、电视台、互联网等媒体经常使用的记录与传播信息的一种文体。是记录社会、传播信息、反映时代的一种文体。新闻概念有广义与狭义之分'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">4</span>,name:<span class="string">'图片'</span>,title:<span class="string">'图片新闻'</span>,content:<span class="string">'江海交汇之处，创新与财富聚集之地。长三角，一个不断扩容的朋友圈，一次又一次给中国和世界带来惊喜。不仅因为庞大的经济体量，还源于用求真务实的态度，解决发展中的难题，将问题变为机遇。'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">5</span>,name:<span class="string">'软件'</span>,title:<span class="string">'软件下载'</span>,content:<span class="string">'这件事情重要。数据告诉我们，长三角不仅是“世界第六大城市群”，还是中国甚至全球经济的一个重要引擎。'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">6</span>,name:<span class="string">'行业'</span>,title:<span class="string">'行业新闻'</span>,content:<span class="string">'根据2016年公布的《长江三角洲城市群发展规划》，当时定义的长三角包括上海、江苏、浙江和安徽的26个城市：'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">7</span>,name:<span class="string">'电商'</span>,title:<span class="string">'电商行情'</span>,content:<span class="string">'截止2018年5月28日，总部位于长三角34个城市的上市公司，总市值已经超过21万亿元人民币。2017财年总营收超过10万亿人民币。'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">8</span>,name:<span class="string">'视频'</span>,title:<span class="string">'视频观看'</span>,content:<span class="string">'长三角在全球经济和资本市场的影响力，不仅在于体量庞大，还因为产业链完备。'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">9</span>,name:<span class="string">'学习'</span>,title:<span class="string">'儿童原地'</span>,content:<span class="string">'长三角的上市公司，广泛的分布在消费、工业、材料、金融、房地产、信息技术、医疗保健、能源和公用事业等领域。'</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;id:<span class="number">10</span>,name:<span class="string">'教程'</span>,title:<span class="string">'编程教程'</span>,content:<span class="string">'经济体量更多代表过去，未来取决于发展，机遇在于解决当前存在的问题。新时代的长三角，正视发展中的问题，在问题中寻找机遇，通过解决问题获得发展动能。'</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">public</span> content: <span class="built_in">string</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">public</span> title: <span class="built_in">string</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="meta">@ViewChild</span>(<span class="string">'ionSlides'</span>) slider: Slides;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="meta">@ViewChild</span>(<span class="string">'sliderHeader'</span>) sliderHeader: ElementRef;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="params">    <span class="keyword">public</span> navCtrl: NavController,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="params">    <span class="keyword">public</span> elementRef: ElementRef,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="params">    <span class="keyword">public</span> renderer: Renderer2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="params">  </span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   </span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  ionViewDidLoad()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.slider.freeMode = <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.slider.slidesPerView = <span class="number">7</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.slider.loop = <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.slider.centeredSlides = <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.slider.slideToClickedSlide = <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//此处直接获得当前默认已选中的slider内容与title</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.content = <span class="keyword">this</span>.navContent[<span class="keyword">this</span>.slider.initialSlide].content</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.title = <span class="keyword">this</span>.navContent[<span class="keyword">this</span>.slider.initialSlide].title</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.slider &amp;&amp; <span class="keyword">this</span>.slider.clickedSlide)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">this</span>.ionSlideDidClick(<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">this</span>.sliderDom(<span class="number">1</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  ionSlideDidClick(id)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.sliderDom(<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.renderer.setAttribute(<span class="keyword">this</span>.slider.clickedSlide, <span class="string">'class'</span>, <span class="string">'swiper-slide active-now'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(!id) <span class="keyword">return</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.navContent.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">if</span>(item.id===id)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.content = item.content</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.title = item.title</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  sliderDom(num)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> allIonSlide = <span class="keyword">this</span>.sliderHeader.nativeElement.querySelectorAll(<span class="string">'ion-slide'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(num)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// allIonSlide[this.slider.initialSlide].style.color = '#038ef9'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      allIonSlide[<span class="keyword">this</span>.slider.initialSlide].setAttribute(<span class="string">'class'</span>, <span class="string">'swiper-slide active-now'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      allIonSlide.forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(element)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          element.setAttribute(<span class="string">'class'</span>, <span class="string">'swiper-slide'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>ionic</tag>
        <tag>slides</tag>
        <tag>导航</tag>
      </tags>
  </entry>
  <entry>
    <title>采用XMLHTTPREQUEST验证URL是否有效</title>
    <url>/2019/12/07/%E9%87%87%E7%94%A8XMLHTTPREQUEST%E9%AA%8C%E8%AF%81URL%E6%98%AF%E5%90%A6%E6%9C%89%E6%95%88/</url>
    <content><![CDATA[<p>有时候在处理某些URL时，可能会遇到404等情况，比如我们在国内使用谷歌地图api一样，我们在请求的时候可能会发生404问题，这个时候我们又想去判断下当前url为404的话，我们则采用其他地图的api，当然我这里所说的仅仅只是一个使用场景，可能你也会遇到其他更多场景，并且也需要验证当前URL的有效性，因此我就直接采用了XMLHttpRequest的方式进行对URL的有效性进行验证。当然对于谷歌地图这个场景，我不建议大家使用这种方法啦，毕竟谷歌地图的api总是抽风，有时候可以访问有时候又不能访问，并且经常不会出现404，基本都是延时很久，所以这个方法不适用与谷歌地图与百度地图的切换判断。<br>代码及其简单，并且测试也通过了，大部分情况下只要遇到404页面，到能判断到是否有效</p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (xmlhttp != <span class="literal">null</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    xmlhttp.onreadystatechange = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState == <span class="number">4</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span> (xmlhttp.status == <span class="number">200</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="built_in">console</span>.log(<span class="string">'验证成功，URL可用'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="built_in">console</span>.log(<span class="string">"验证失败，URL不可用，错误信息:"</span>, xmlhttp.statusText);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    xmlhttp.open(<span class="string">"GET"</span>, url, <span class="literal">false</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    xmlhttp.send(<span class="literal">null</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'你的浏览器OUT了，不支持XMLHTTP，请更换Firefox、Chrome最新版本浏览器'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
  </entry>
  <entry>
    <title>ANGULAR4-HTTP拦截器</title>
    <url>/2019/12/07/ANGULAR4-HTTP%E6%8B%A6%E6%88%AA%E5%99%A8/</url>
    <content><![CDATA[<p>http拦截器的使用主要用于http请求，比如设置http请求头，常用于header中包含token或者cookie，以及设置请求方式为 application/x-www-form-urlencoded 或 application/json等，也可以对请求的api进行拦截。</p>
<p>在angular4中使用 @angular/common/http进行http请求，来做拦截器，相关代码如下：</p>
<p>InterceptorService.ts（此处为ionic3框架使用的方法，angular4 WEB请看下一个实例代码）</p>
<a id="more"></a>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// http 请求拦截器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpEvent, HttpInterceptor, HttpHandler, HttpRequest &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; catchError &#125; <span class="keyword">from</span> <span class="string">'rxjs/operators'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; _throw &#125; <span class="keyword">from</span> <span class="string">'rxjs/observable/throw'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NativeStorage &#125; <span class="keyword">from</span> <span class="string">'@ionic-native/native-storage'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Utils &#125; <span class="keyword">from</span> <span class="string">'./utils'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@Injectable</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> InterceptorService <span class="keyword">implements</span> HttpInterceptor&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">private</span> timeout = <span class="number">1000</span> * <span class="number">30</span> <span class="comment">// 30s超时</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">private</span> timer = <span class="number">0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="params">        <span class="keyword">private</span> utils: Utils,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="params">        <span class="keyword">private</span> storage: NativeStorage</span>)&#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    intercept(request: HttpRequest&amp;lt;<span class="built_in">any</span>&gt;, next: HttpHandler) : Observable&amp;lt;HttpEvent&amp;lt;<span class="built_in">any</span>&gt;&gt;&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 排除不需要进行token验证的接口</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> excludeUrl = [<span class="string">'login'</span>, <span class="string">'logout'</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> isNotVerifyToken = <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        excludeUrl.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(request.url.indexOf(item) &gt; <span class="number">-1</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                isNotVerifyToken = <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(!isNotVerifyToken)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 此处使用promise的方式获取localstorage</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> token = localstorage.getItem(<span class="string">'token'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> cloneRequst = <span class="keyword">this</span>.addToken(request, token)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">return</span> next.handle(cloneRequst).timeout(<span class="keyword">this</span>.timeout).pipe(</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 异常集中处理，只要请求有error就直接返回网络错误+状态code</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">               catchError(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  <span class="comment">// 简单的防抖，防止多次执行提示网络错误</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                  clearTimeout(<span class="keyword">this</span>.timer)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  <span class="keyword">this</span>.timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                      <span class="keyword">let</span> msg = <span class="string">'网络错误'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                      alert(msg)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  &#125;, <span class="number">2000</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  <span class="keyword">return</span> _throw(error)</span></pre></td></tr><tr><td class="code"><pre><span class="line">               &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">             )</span></pre></td></tr><tr><td class="code"><pre><span class="line">           &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> cloneRequst = <span class="keyword">this</span>.addToken(request)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">return</span> next.handle(cloneRequst).timeout(<span class="keyword">this</span>.timeout).pipe(</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 异常集中处理，只要请求有error就直接返回网络错误+状态code</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                catchError(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="comment">// 简单的防抖，防止多次执行提示网络错误</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    clearTimeout(<span class="keyword">this</span>.timer)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">this</span>.timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        <span class="keyword">let</span> msg = <span class="string">'网络错误'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                        alert(msg)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;, <span class="number">2000</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">return</span> _throw(error)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            )</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">private</span> addToken(request: HttpRequest&amp;lt;<span class="built_in">any</span>&gt;, token?: <span class="built_in">any</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> req: HttpRequest&amp;lt;<span class="built_in">any</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(token) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            req = request.clone(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 拦截所有请求，并且在header中增加响应头以及token</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                setHeaders: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="string">'Accept'</span>: <span class="string">'application/json'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="string">'Authorization'</span>: token</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 当页面不需要在header中传递token时设置header</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            req = request.clone(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                setHeaders: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="string">'Accept'</span>: <span class="string">'application/json'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> req</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>app.modules.ts</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//import部分加入以下代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpClientModule, HTTP_INTERCEPTORS &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//@NgModule部分providers最后加入如下代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;provide: HTTP_INTERCEPTORS, useClass: InterceptorService, multi: <span class="literal">true</span>&#125;</span></pre></td></tr></table></figure>

<p>直接使用如下代码进行http请求即可</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.post(url, body).subscribe(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(data) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> data</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> err</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>http</tag>
        <tag>拦截器</tag>
      </tags>
  </entry>
  <entry>
    <title>利用EXPRESSJS编写RESET-API</title>
    <url>/2019/12/07/%E5%88%A9%E7%94%A8EXPRESSJS%E7%BC%96%E5%86%99RESET-API/</url>
    <content><![CDATA[<p>expressJS是个很轻量且简单的JavaScript后端框架，基于nodeJS开发。可以利用express简单的就可以输出reset api，当然它可以连接任意数据库。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>1、安装nodeJS（请自行安装）</p>
<p>2、安装express-generator（采用全局安装）</p>
<p>npm install express-generator -g</p>
<p>3、创建项目（我采用的是ejs模板引擎）</p>
<p>express –view=ejs myapp</p>
<p>4、连接mysql，请自行安装mysql数据库，我们需要安装mysql依赖</p>
<p>npm i mysql</p>
<p>创建数据库名为chat并创建数据库表：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">`<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> message(</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">id</span> <span class="built_in">char</span>(<span class="number">100</span>) PRIMARY <span class="keyword">KEY</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            from_user_id <span class="built_in">int</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            to_user_id <span class="built_in">int</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            read_status <span class="built_in">int</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">content</span> <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            create_time <span class="built_in">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NOW</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;`</span></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="数据库连接编写"><a href="#数据库连接编写" class="headerlink" title="数据库连接编写"></a>数据库连接编写</h2><p>dbConfig.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">'mysql'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> connection = db.createPool(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    host: <span class="string">'localhost'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    user: <span class="string">'root'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    password: <span class="string">'123456'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    database: <span class="string">'chat'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> testMysqlConnection = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 测试mysql是否已经连接成功</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        connection.query(<span class="string">'SELECT 1 + 1 AS solution'</span>, (err, rows, fields) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                reject(&#123;<span class="attr">status</span>: <span class="number">0</span>, err&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            resolve(&#123;<span class="attr">status</span>: rows[<span class="number">0</span>].solution&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;connection, testMysqlConnection&#125;</span></pre></td></tr></table></figure>

<h2 id="reset-api编写（增删改查）"><a href="#reset-api编写（增删改查）" class="headerlink" title="reset api编写（增删改查）"></a>reset api编写（增删改查）</h2><p>msgModel.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">'../config/dbConfig'</span>).connection</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> chat = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 分页查询所有聊天记录</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    getAllMsg: <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 传入页码、数量</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> currentPage = params.currentPage ? +params.currentPage : <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> pageSize = params.pageSize ? +params.pageSize : <span class="number">10</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> count_sql = <span class="string">'select COUNT(*) from users'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> sql=<span class="string">'select SQL_CALC_FOUND_ROWS * from message order by create_time desc limit '</span> + (currentPage - <span class="number">1</span>) + <span class="string">','</span> + pageSize</span></pre></td></tr><tr><td class="code"><pre><span class="line">            db.query(count_sql, (c_err, c_rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(err)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: c_err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                db.query(sql, (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    resolve(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">2</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: rows,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        count: c_rows[<span class="number">0</span>][<span class="string">'COUNT(*)'</span>],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: <span class="string">'Get all message'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">               </span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    getMsgById: <span class="function">(<span class="params">_msg</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 由于消息数量可能会过多，因此需要进行分页，分页条数为50条</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> currentPage = _msg.currentPage ? _msg.currentPage : <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> pageSize = <span class="number">50</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> id = _msg[<span class="string">'id'</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> count_sql = <span class="string">'select COUNT(*) from message where id like "'</span>+ id +<span class="string">'%"'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">           </span></pre></td></tr><tr><td class="code"><pre><span class="line">            db.query(count_sql, (c_err, c_rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(c_err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: c_err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 计算页数总数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> pages</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> pageStart</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(c_rows &amp;amp;&amp;amp; c_rows[<span class="number">0</span>][<span class="string">'COUNT(*)'</span>]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    pages = <span class="built_in">Math</span>.ceil(c_rows[<span class="number">0</span>][<span class="string">'COUNT(*)'</span>] / pageSize)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(pages) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    pageStart = (+pages - +currentPage) &amp;lt;<span class="number">0</span> ? <span class="number">1</span> : (+pages - +currentPage)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    pageStart = <span class="number">0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> sql=<span class="string">'select * from message where id like "'</span>+ id +<span class="string">'%" order by create_time asc limit '</span> + (pageStart * pageSize) + <span class="string">','</span> + pageSize</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="built_in">console</span>.log(pages, sql)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                db.query(sql, [id], (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    resolve(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">2</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: rows,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        count: c_rows[<span class="number">0</span>] &amp;amp;&amp;amp; c_rows[<span class="number">0</span>][<span class="string">'COUNT(*)'</span>] ? c_rows[<span class="number">0</span>][<span class="string">'COUNT(*)'</span>] : [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: <span class="string">'Get all message'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 获取未读状态的信息id</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    getMsgByStatus: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> sql = <span class="string">'select id,from_user_id,to_user_id from message where read_status = 0 and id like "%'</span> + id + <span class="string">'%"'</span> <span class="comment">// (id like "%'+ '_'+id +'%" or id like "%'+ id+'_' +'%")</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// console.log('sql', sql)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            db.query(sql, (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> newData = []</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> data = []</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(rows &amp;amp;&amp;amp; rows.length&gt;<span class="number">0</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &amp;lt; rows.length; i++)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        rows[i][<span class="string">'unreadMessage'</span>] = <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                        newData.push(rows[i])</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> addUnreadMsgHaveSameId = <span class="function">(<span class="params">array</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">const</span> hash = &#123;&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    array.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        <span class="keyword">const</span> id = item[<span class="string">'to_user_id'</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        <span class="keyword">if</span> (hash[id]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            hash[id][<span class="string">'unreadMessage'</span>] += item[<span class="string">'unreadMessage'</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            hash[id] = item;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">return</span> <span class="built_in">Object</span>.values(hash);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  <span class="built_in">console</span>.log(<span class="string">'rows'</span>, rows)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  data = addUnreadMsgHaveSameId(newData)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                resolve(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    status: <span class="number">2</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    data: data,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    msg: <span class="string">'get all unread message'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    addMsg: <span class="function">(<span class="params">_chat</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(_chat)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(_chat.id &amp;amp;&amp;amp; _chat.from_user_id &amp;amp;&amp;amp; _chat.to_user_id &amp;amp;&amp;amp; _chat.content)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> sql = <span class="string">'insert into message(id, from_user_id, to_user_id, content) values(?,?,?,?)'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">let</span> chatParams = [_chat.id, _chat.from_user_id, _chat.to_user_id, _chat.content]</span></pre></td></tr><tr><td class="code"><pre><span class="line">                db.query(sql,  chatParams, (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    resolve(&#123;<span class="attr">status</span>: <span class="number">2</span>, <span class="attr">data</span>: rows, <span class="attr">message</span>: <span class="string">'add message success'</span>&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                resolve(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    message: <span class="string">'Incomplete message information'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    updateMsgReadStatus: <span class="function">(<span class="params">_chat</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(<span class="string">'params'</span>,_chat)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> s_sql = <span class="string">'select * from message where id like "%'</span>+ _chat.id +<span class="string">'%" and from_user_id='</span> + _chat.to_user_id</span></pre></td></tr><tr><td class="code"><pre><span class="line">            db.query(s_sql, (s_err, s_rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(s_err)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: s_err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&amp;lt;s_rows.length;i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">let</span> sql = <span class="string">'update message set read_status = 1 where id=? and from_user_id='</span> + _chat.to_user_id</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    db.query(sql,[s_rows[i][<span class="string">'id'</span>]], (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                                status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                                data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                                message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        resolve(&#123;<span class="attr">status</span>: <span class="number">2</span>, <span class="attr">data</span>: rows, <span class="attr">message</span>: <span class="string">'update message success'</span>&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    updateMsg: <span class="function">(<span class="params">_chat</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 更新仅能更新阅读状态以及消息内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> _chatParams = [</span></pre></td></tr><tr><td class="code"><pre><span class="line">                _chat.read_status ? _chat.read_status : <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                _chat.content ? _chat.content : <span class="literal">null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">            _chatParams = _chatParams.filter(<span class="function"><span class="params">item</span> =&gt;</span> item)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> hasReadStatus = _chat.read_status || _chat.read_status == <span class="number">0</span> ? <span class="string">'read_status=?'</span> : <span class="string">''</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> hasContent = _chat.content ? <span class="string">'content=?'</span> : <span class="string">''</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> haveTwoParams = hasReadStatus &amp;amp;&amp;amp; hasContent ? <span class="string">','</span> : <span class="string">''</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> sql = <span class="string">'update message set '</span> + hasReadStatus + haveTwoParams + hasContent + <span class="string">' where id like "'</span>+ _chat.id +<span class="string">'%"'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(_chat.id) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                db.query(sql, _chatParams, (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                            message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    resolve(&#123;<span class="attr">status</span>: <span class="number">2</span>, <span class="attr">data</span>: rows, <span class="attr">message</span>: <span class="string">'update message success'</span>&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                resolve(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    message: <span class="string">'id is null, please check'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    deleteMsg: <span class="function">(<span class="params">_chat</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 批量删除聊天记录</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> _ids = _chat.ids</span></pre></td></tr><tr><td class="code"><pre><span class="line">            _ids = <span class="string">'"'</span> + <span class="built_in">JSON</span>.parse(_ids).join(<span class="string">'","'</span>) + <span class="string">'"'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">let</span> sql = <span class="string">'delete from message where id in ('</span>+ _ids +<span class="string">')'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            db.query(sql, (err, rows) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">if</span>(err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    reject(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        status: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        data: [],</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        message: err</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                resolve(&#123;<span class="attr">status</span>:<span class="number">2</span>, <span class="attr">data</span>: rows, <span class="attr">message</span>: <span class="string">'delete messages success'</span>&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = chat</span></pre></td></tr></table></figure>

<p>router/msg.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> router = express.Router();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> chat = <span class="built_in">require</span>(<span class="string">'../models/msgModel'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.get(<span class="string">'/:id/:currentPage'</span>, (req, res) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> body = req.params</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log(req.body, req.params, req.query)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    chat.getMsgById(body).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(result)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;, err =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(<span class="number">500</span>, <span class="string">'Select dababase is error'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// add message</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.post(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> body = req.body</span></pre></td></tr><tr><td class="code"><pre><span class="line">    chat.addMsg(body).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(result)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;, err =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(<span class="number">500</span>, <span class="string">'add message is error'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// update msg</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.put(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> body = req.body</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(req.body, req.params, req.query)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    chat.updateMsgReadStatus(body).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(result)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;, err =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(err)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// delete msg 批量删除</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.delete(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 传入一个字符串，但是格式必须为'[1,2,3,4]'，以便后端解析</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'req'</span>, req.body, req.params, req.query)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> body = req.body</span></pre></td></tr><tr><td class="code"><pre><span class="line">    chat.deleteMsg(body).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(result)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;, err =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(err)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = router</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>express</tag>
        <tag>reset api</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVASCRIPT-NODEJS-BASE64加密解密URL参数</title>
    <url>/2019/12/07/JAVASCRIPT-NODEJS-BASE64%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86URL%E5%8F%82%E6%95%B0/</url>
    <content><![CDATA[<p>为了保证全段传递都后端的数据安全性，比如用户登录时输入的密码，在post发送请求中可能会直接暴露了明文。因此可能需要前端进行相应的加密传递到后端，再由后端进行解密后再继续操作。</p>
<p>我使用base64的加密方式对密码进行加密，不过大家都知道base64很容易就被破解了，因此，我会替换掉几个base64生成字符串中的字母，这样就可以达到别人很难破解的目的了。具体直接看代码！</p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//利用base64加密传输数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base64Encryption</span>(<span class="params">str</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> base64 = Buffer.from(str, <span class="string">'utf-8'</span>).toString(<span class="string">'base64'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 把base64源数据中的M与Q替换成其他字符串，防止别人破解</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> base64Confusion = base64.replace(<span class="regexp">/\M/</span>, <span class="string">'=J='</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    base64Confusion = base64Confusion.replace(<span class="regexp">/\Q/</span>, <span class="string">'=V='</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> base64Confusion</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base64Decrypt</span>(<span class="params">str</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 先把base64混淆后的字符串转换为正常额base64字符串，在进行解密</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> base64 = str.replace(<span class="regexp">/=J=/</span>, <span class="string">'M'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    base64 = base64.replace(<span class="regexp">/=V=/</span>, <span class="string">'Q'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> Buffer.from(base64, <span class="string">'base64'</span>).toString(<span class="string">'utf-8'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 此加密不仅可以用于用户密码加密，也可以用于url传参加密</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 一下是加密一般字符串</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> data = <span class="string">'123m你好'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'加密：'</span>, base64Encryption(data))</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'解密：'</span>,base64Decrypt(base64Encryption(data)))</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 一下是加密url传参，如url为http://localhost/users?userName=Jack&amp;password=1234567890</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> userName = <span class="string">'Jack'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> password = <span class="string">'1234567890'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">`加密： http://localhost/users?userName=<span class="subst">$&#123;base64Encryption(userName)&#125;</span>&amp;password=<span class="subst">$&#123;base64Encryption(password)&#125;</span>`</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 后端解码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">`解密： http://localhost/users?userName=<span class="subst">$&#123;base64Decrypt(base64Encryption(userName))&#125;</span>&amp;password=<span class="subst">$&#123;base64Decrypt(base64Encryption(password))&#125;</span>`</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 我们可以这样进行加密连接参数的字符串， 比如字符串是userName=Jack&amp;password=1234567890</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> params = <span class="string">`userName=<span class="subst">$&#123;userName&#125;</span>&amp;password=<span class="subst">$&#123;password&#125;</span>`</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">`加密：http://localhost/users?data=<span class="subst">$&#123;base64Encryption(params)&#125;</span>`</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 后端解码应该是拿到data的值为dXNlck5hbWU9SmFjayYmcGFzc3dvcm=V=9=J=TIzNDU2Nzg5MA==，并解码此值并对其进行分割获取相应的数据内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">`解密data：<span class="subst">$&#123;base64Decrypt(base64Encryption(params))&#125;</span>, 后端分割：<span class="subst">$&#123;base64Decrypt(base64Encryption(params)).split(<span class="string">'&amp;'</span>)&#125;</span>`</span>)</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>node</tag>
        <tag>base64</tag>
      </tags>
  </entry>
  <entry>
    <title>CORDOVA打安卓包报错IONIC ERROR: SPAWN EACCES</title>
    <url>/2019/12/07/CORDOVA%E6%89%93%E5%AE%89%E5%8D%93%E5%8C%85%E6%8A%A5%E9%94%99IONIC-ERROR-SPAWN-EACCES/</url>
    <content><![CDATA[<p>最近升级了cordova到7.1.0后，发现执行打包命令ionic build android的时候就出现了spawn EACCES的错误，搞了半天，到google搜索了半天，找到的解决方法都是直接使用ionic platform rm android;ionic platform add android的方法去解决，但是我试过很多次后，竟然没有任何效果，我直接怀疑起了我自己的人生观。看来google好像也没有找到我需要的答案啊，看来老外的解决办法也是超级LOW啊！都是一个方法，总之我从各类国外的网站寻找答案，最终我被打败了，最终还是使用百度搜索到了答案，看来百度并不坏啊！还是咋们中文强悍。<br>其实出现这个问题主要是由于Android Stdudio中的gradle权限不够导致的android无法打包。下面我们就来设置一下相关权限吧！<br>此方法仅限于Mac以及linux平台，Windows平台的朋友请自寻解决方法。<br>在Android Stdudio安装之后，有这么一个目录<br>/Applications/Android\ Studio.app/Contents/gradle/gradle-4.1/bin/gradle<br>正是由于我们没有权限操作这个目录，由此才需要将此目录设置一下权限，可以设置为777，也可以设置为755，随便你这么设置。使用下面的命令命令设置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo chmod 755 &#x2F;Applications&#x2F;Android\ Studio.app&#x2F;Contents&#x2F;gradle&#x2F;gradle-4.1&#x2F;bin&#x2F;gradle</span></pre></td></tr></table></figure>
<p>上面代码中Android\ Studio.app，一定要有“\”，否则会报错，这是Mac下对目录的处理，linux中也许不需要这样写命令哦！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Cordova</tag>
        <tag>打包</tag>
        <tag>spawn eacces</tag>
      </tags>
  </entry>
  <entry>
    <title>NODEJS ADDONS 中文乱码处理</title>
    <url>/2019/12/07/NODEJS-ADDONS-%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E5%A4%84%E7%90%86/</url>
    <content><![CDATA[<p>使用nodeJS的addons模块进行处理中文字符的时候，总是乱码。期间查询过很多关于C++或者C的中文乱码解决办法，但是大多都是直接在原生的C以及C++中使用，并没有专门的在V8引擎中直接使用的实例，由此我从网上拷贝了几个代码过来后，发现编译的过程中一直都是报错的，也就是说无法直接使用啊！通过跟底层开发的同事的不断努力，终于在nodeJS中搞出来了编码转换的问题，并且测试通过，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">int code_convert(char *from_charset,char *to_charset,char *inbuf,size_t* inlen,char *outbuf,size_t* outlen)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  iconv_t cd;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  int rc;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  char **pin = &amp;inbuf;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  char **pout = &amp;outbuf;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  cd = iconv_open(to_charset,from_charset);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (cd==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  std::memset(outbuf,<span class="number">0</span>,(int)(*outlen));</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (iconv(cd,pin,inlen,pout,outlen)==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    iconv_close(cd);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//UNICODE码转为GB2312码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">int u2g(char *inbuf,size_t* inlen,char *outbuf,size_t* outlen)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> code_convert(<span class="string">"utf-8"</span>,<span class="string">"gb2312"</span>,inbuf,inlen,outbuf,outlen);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//GB2312码转为UNICODE码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">int g2u(char *inbuf,size_t* inlen,char *outbuf,size_t* outlen)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> code_convert(<span class="string">"gb2312"</span>,<span class="string">"utf-8"</span>,inbuf,inlen,outbuf,outlen);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>使用方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">int inLen = strlen(ctext);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  size_t inLenSize,outLenSize;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  inLenSize = inLen;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  outLenSize = <span class="number">256</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  char outBuf[outLenSize];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//printline();</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  int convLen = u2g(ctext, &amp;inLenSize,outBuf,&amp;outLenSize);</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>node</tag>
        <tag>中文</tag>
        <tag>乱码</tag>
        <tag>addons</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVASCRIPT将有相同内容的数组或对象的值进行累加</title>
    <url>/2019/12/07/JAVASCRIPT%E5%B0%86%E6%9C%89%E7%9B%B8%E5%90%8C%E5%86%85%E5%AE%B9%E7%9A%84%E6%95%B0%E7%BB%84%E6%88%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%80%BC%E8%BF%9B%E8%A1%8C%E7%B4%AF%E5%8A%A0/</url>
    <content><![CDATA[<p>我们可能会经常遇到如下这样的问题，就像我们的后端要从数据库中读取相同id的内容，并且合并相同id已有的值。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arry = [&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">123</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info: <span class="string">'男'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">123</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info:<span class="string">'女'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">123</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info: <span class="string">'未知'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">456</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info: <span class="string">'东'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">456</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info:<span class="string">'西'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">456</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info: <span class="string">'南'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pid:<span class="number">456</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        info: <span class="string">'北'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">]</span></pre></td></tr></table></figure>
<p>我们看到以上数组对象中，可以看到有很多个相同pid的属性值，我的目的就是将其相同的pid值的对象的info值全部合并起来，诸如</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="attr">pid</span>:<span class="number">123</span>,<span class="attr">info</span>:<span class="string">'男/女/未知'</span>&#125;,&#123;<span class="attr">pid</span>:<span class="number">456</span>,<span class="attr">info</span>:<span class="string">'东/西/南/北'</span>&#125;]</span></pre></td></tr></table></figure>
<p>也就是说将相同的pid的相关内容进行合并。</p>
<a id="more"></a>
<h2 id="使用reduce方法"><a href="#使用reduce方法" class="headerlink" title="使用reduce方法"></a>使用reduce方法</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> newArr = arry.sort(<span class="function">(<span class="params">pre, next</span>) =&gt;</span> pre.pid &gt; next.pid).reduce(<span class="function">(<span class="params">pre, v</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> lastIndex = pre.length - <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (lastIndex &gt;= <span class="number">0</span> &amp;&amp; pre[lastIndex].pid === v.pid) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    pre[lastIndex].info += v.info;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    pre.push(<span class="built_in">Object</span>.assign(&#123;&#125;, v));</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> pre;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;, []);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(newArr);</span></pre></td></tr></table></figure>
<p>这种方法确实挺不错，也很容易理解，但是不确定是否会对性能造成问题。另外就是对中文的支持并不好！很有可能我们会得到如下内容</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="attr">pid</span>:<span class="number">123</span>,<span class="attr">info</span>:<span class="string">'男'</span>&#125;,&#123;<span class="attr">pid</span>:<span class="number">456</span>,<span class="attr">info</span>:<span class="string">'东/西/南/北'</span>&#125;]</span></pre></td></tr></table></figure>
<p>因此，建议使用另一种遍历的方式进行处理</p>
<h2 id="foreach遍历"><a href="#foreach遍历" class="headerlink" title="foreach遍历"></a>foreach遍历</h2><p>使用遍历，并采用hasOwnProperty判断属性，对象拷贝等实现</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> res = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> tmp = &#123;&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr.forEach(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (!tmp.hasOwnProperty(v.pid)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    tmp[v.pid] = res.length;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> res.push(<span class="built_in">Object</span>.assign(&#123;&#125;, v));</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  res[tmp[v.code]].info += v.info;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> res; <span class="comment">//printer [&#123;pid:123,info:'男/女/未知'&#125;,&#123;pid:456,info:'东/西/南/北'&#125;]</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>对象</tag>
        <tag>累加</tag>
        <tag>合并</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVA-SPRING-BOOT开发环境配置</title>
    <url>/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p>我以前确实玩过一些java web，并且还写过java web，但是那是很久以前的事情了，而且悲催的是我还居然没有用过一个java框架。比如spring、Struts、hibernate之类的框架，我仅仅只是听说过，并未真正研究与使用过。由于工作的需要，我需要搭建一个可以跑起来的 reset api 服务，由此想起之前朋友给我推荐的spring-boot，听说很容易，不过我折腾了一下，环境搭建就花费了我不少时间。下面我就将这过程给大家说一说，当然请先确保你的电脑已经配置好了JDK环境。</p>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>1、java环境配置<br>JDK配置、maven配置，JDK配置网上已经说得一大片了，再说了不论是搞后端还是搞前端开发基本也离不开JDK环境了，这里主要说一下maven配置。<br>首先到maven官方下载一个压缩包，<a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">https://maven.apache.org/download.cgi</a><br>解压后，放到任意位置，我将其放到了/Users/ubeing/Library/maven目录中，这个是MAC开发环境，如果你是windows开发环境，那你可以放到C盘或者其他盘都可以。</p>
<p>接着我们需要配置下环境变量啦，mac下的配置如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim ~&#x2F;.bash_profile</span></pre></td></tr><tr><td class="code"><pre><span class="line">export MAVEN_HOME&#x3D;&#x2F;Users&#x2F;ubeing&#x2F;Library&#x2F;maven</span></pre></td></tr><tr><td class="code"><pre><span class="line">export PATH&#x3D;$MAVEN_HOME&#x2F;bin:$PATH</span></pre></td></tr></table></figure>
<p>windows下，请打开你的环境变量，新建一个MAVEN_HOME的变量，值为C:/Users/ubeing/Library/maven，找到path，添加$MAVEN_HOME/bin即可<br>配置完成后，windows下立即生效，mac下还需要执行source ~/.bash_profile，接着在终端（windows上叫命令提示符）输入以下命令验证一下：</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mvn -v</span></pre></td></tr></table></figure>
<p>如果出现了各种JDK、maven的版本号，那么说明成功了，如果没有出现或者提示找不到mvn命令，那就是配置还未成功，请重试一次。</p>
<p>2、开发工具IDE<br>推荐使用Intellij IDEA</p>
<p>3、创建spring-boot项目<br>点击file-&gt;new-&gt;project,如下图</p>
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-112346.png" class="" title="创建项目">
<p>接着选择左侧的Spring Initializr，右侧选择default，然后点击next，如图</p>
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-112715.png" class="" title="选择项目">
<p>修改相关的项目设置</p>
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-113908.png" class="" title="项目设置">
<p>完成后，直接next、next、next</p>
<h2 id="编写相关代码"><a href="#编写相关代码" class="headerlink" title="编写相关代码"></a>编写相关代码</h2><p>我是从spring-boot官方抄袭过来的一段代码，输出是hello world<br>在src/main下面的java文件import处增加</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.*;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span></pre></td></tr></table></figure>
<p>在public class下增加</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="meta">@ResponseBody</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function">String <span class="title">home</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World!"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">保存，最终代码应该像这样：</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.*;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="meta">@ResponseBody</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function">String <span class="title">home</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World! "</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        SpringApplication.run(DemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<h2 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h2><p>这次可是到了运行项目的部分啦，刚开始我在run里面找了半天都没有发现该如何运行项目，原来我们使用了maven搭建的项目，可以直接使用maven进行运行，就像前端的npm一个鬼样。因此我们需要打开终端，进入到项目目录，输入如下命令进行运行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mvn spring-boot:run</span></pre></td></tr></table></figure>
<p>第一次运行，可能会需要一点时间，因为要下载某些依赖jar包，mvn看上去真的和npm一样，听说mvn出来的比npm早。<br>到这里可能搭建就完成了吗？并没有，我们还需要像前端一样，能实时热更新的效果啊，不然我们每次修改代码都要运行一次上面的代码多麻烦啊！</p>
<h2 id="spring-boot热加载"><a href="#spring-boot热加载" class="headerlink" title="spring-boot热加载"></a>spring-boot热加载</h2><p>Intellij中，需要设置两个地方，首先点击preferences，找到Build project automatically并勾选，如图</p>
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-115112.png" class="" title="preferences">
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-115424.png" class="" title="设置自动编译热加载">
<p>使用快捷键Shift+Ctrl+Alt+/，选择Registry</p>
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-115609.png" class="" title="Registry">
<p>勾选上compiler.automake.allow.when.app.running</p>
<img src="/2019/12/07/JAVA-SPRING-BOOT%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/WX20180425-115816.png" class="">
<p>这样就设置完成了自动编译，想要验证一下是否可以使用，你得重启项目两次左右，或者点击项目右键使用run多跑几次之后，就可以真正的实现自动编译了。<br>为了保证此功能不出差错，建议再加入spring-boot-devtools到项目中，在项目中找到pom.xml文件，打开，增加以下代码：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">............</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span></pre></td></tr></table></figure>
<p>这下终于放心了，也可以开心的进行开发啦！</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>spring boot</tag>
        <tag>环境</tag>
      </tags>
  </entry>
  <entry>
    <title>关于混合APP横屏、竖屏、翻转的解决方案</title>
    <url>/2019/12/07/%E5%85%B3%E4%BA%8E%E6%B7%B7%E5%90%88APP%E6%A8%AA%E5%B1%8F%E3%80%81%E7%AB%96%E5%B1%8F%E3%80%81%E7%BF%BB%E8%BD%AC%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    <content><![CDATA[<p>cordova或者phonegap都提供了一系列很牛的插件，为我们做开发省了不小力气，在app开发中，有一些app适合竖屏展示，某些app又适合横屏展示，因此我们得去设置它相关的config.xml</p>
<h2 id="安卓上的横屏与竖屏"><a href="#安卓上的横屏与竖屏" class="headerlink" title="安卓上的横屏与竖屏"></a>安卓上的横屏与竖屏</h2><p>首先我们先来看一下android上的某些原生Activity属性<br>安卓 Activity 在设备上的显示方向。如果 Activity 是在多窗口模式下运行，系统会忽略该属性。Activity有以下几种属性值</p>
<p>“unspecified” 默认值。由系统选择方向。在不同设备上，系统使用的政策以及基于政策在特定上下文所做的选择可能有所差异。<br>“behind” 与 Activity 栈中紧接着它的 Activity 的方向相同。<br>“landscape” 横向方向（显示的宽度大于高度）。<br>“portrait” 纵向方向（显示的高度大于宽度）。<br>“reverseLandscape” 与正常横向方向相反的横向方向。API 级别 9 中的新增配置。</p>
<a id="more"></a>
<p>“reversePortrait” 与正常纵向方向相反的纵向方向。API 级别 9 中的新增配置。<br>“sensorLandscape” 横向方向，但根据设备传感器，可以是正常或反向的横向方向。API 级别 9 中的新增配置。<br>“sensorPortrait” 纵向方向，但根据设备传感器，可以是正常或反向的纵向方向。API 级别 9 中的新增配置。<br>“userLandscape” 横向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的横向方向。 如果用户锁定了基于传感器的旋转，其行为与 landscape 相同，否则，其行为与 sensorLandscape 相同。API 级别 18 中的新增配置。<br>“userPortrait” 纵向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的纵向方向。 如果用户锁定了基于传感器的旋转，其行为与 portrait 相同，否则，其行为与 sensorPortrait 相同。API 级别 18 中的新增配置。<br>“sensor” 方向由设备方向传感器决定。显示方向取决于用户如何手持设备，它会在用户旋转设备时发生变化。 但一些设备默认情况下不会旋转到所有四种可能的方向。要允许全部四种方向，请使用 “fullSensor”。<br>“fullSensor” 方向由 4 种方向中任一方向的设备方向传感器决定。这与 “sensor” 类似，不同的是它允许所有 4 种可能的屏幕方向，无论设备正常情况下采用什么方向（例如，一些设备正常情况下不使用反向纵向或反向横向，但它支持这些方向）。 API 级别 9 中的新增配置。<br>“nosensor” 决定方向时不考虑物理方向传感器。传感器会被忽略，因此显示不会随用户对设备的移动而旋转。 除了这个区别，系统在选择方向时使用的政策与“unspecified”设置相同。<br>“user” 用户当前的首选方向。<br>“fullUser” 如果用户锁定了基于传感器的旋转，其行为与 user 相同，否则，其行为与 fullSensor 相同，允许所有 4 种可能的屏幕方向。 API 级别 18 中的新增配置。<br>“locked” 将方向锁定在其当前的任意旋转方向。API 级别 18 中的新增配置。</p>
<p>丰富吧，因此Android上我们可以使用如此之多的属性，我们可以在config.xml中添加如下代码来控制安卓下我们想要的横屏、竖屏、旋转模式</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">"android"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">preference</span> <span class="attr">name</span>=<span class="string">"Orientation"</span> <span class="attr">value</span>=<span class="string">"sensorLandscape"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span></pre></td></tr></table></figure>
<p>这里的代码表示当前app仅能横屏并翻转，但无法竖屏</p>
<h2 id="iOS上的横屏与竖屏"><a href="#iOS上的横屏与竖屏" class="headerlink" title="iOS上的横屏与竖屏"></a>iOS上的横屏与竖屏</h2><p>iOS上的横屏与竖屏与安卓差不多，目前iOS上Orientation属性的值仅支持3个，分别为default（默认可纵横旋转）、landscape（强制横屏，默认下横屏不能翻转）、portrait（强制竖屏，默认下竖屏无法翻转）</p>
<p>比如如下代码：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">"ios"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">preference</span> <span class="attr">name</span>=<span class="string">"Orientation"</span> <span class="attr">value</span>=<span class="string">"landscape"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span></pre></td></tr></table></figure>
<p>那要如何才能让iOS上能够横屏下页面翻转，而禁止竖屏显示。值得庆幸的是Apple的Xcode为我们提供了这个选项，如下图</p>
<img src="/2019/12/07/%E5%85%B3%E4%BA%8E%E6%B7%B7%E5%90%88APP%E6%A8%AA%E5%B1%8F%E3%80%81%E7%AB%96%E5%B1%8F%E3%80%81%E7%BF%BB%E8%BD%AC%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/QQ20180511-102510.png" class="" title="xcode设置屏幕方向">]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>app</tag>
        <tag>混合</tag>
        <tag>横屏</tag>
      </tags>
  </entry>
  <entry>
    <title>ANGULAR2+数据更新但视图不更新的解决方法</title>
    <url>/2019/12/07/ANGULAR2-%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E4%BD%86%E8%A7%86%E5%9B%BE%E4%B8%8D%E6%9B%B4%E6%96%B0%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>最近项目中总是遇到一些莫名其妙的问题，当然这个项目已经存在已久，之前也有过这样的问题，现在感觉问题总是显得很突出，大部分问题都是由于数据更新后，视图无法及时更新而导致的，由于项目的代码原因，我就不多去深入为什么会发生这个问题了，主要的是说一下解决这个问题的方法。<br>场景<br>如果你在组件中定义了一个变量，当你使用console能将其值打印出来，可是我们能看到的视图中，这个变量并没有任何值或者改动。又或者你在一个点击事件中去改变相关变量的值，让其显示在视图上，但是当你点击事件触发后，变量的值是改变了，但是视图却为更新。这个时候你就可以使用以下几种方法</p>
<p>1、直接使用ngZong.run()<br>我们可以将某个要发生改变的变量或者方法直接放到ngZong.run()中。比如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ngZong.run(()&#x3D;&gt;&#123;this.closeNum()&#125;)</span></pre></td></tr></table></figure>

<p>2、ChangeDetectorRef.detectChanges()<br>此方法本人使用的不多，并没有切确的深入了解这个方法，而且我在进行测试中，这个方法对我来说并未产生任何效果，如果你想要尝试一下，建议看一下官方文档<a href="https://angular.io/api/core/ChangeDetectorRef#!#detectChanges-anchor" target="_blank" rel="noopener">https://angular.io/api/core/ChangeDetectorRef#!#detectChanges-anchor</a></p>
<p>3、直接使用ngDocheck()生命周期<br>我们可以将相关代码直接放到ngDocheck中，即可实现视图强制更新。但是一定要注意ngDocheck特别像setInterval，不论你数据是否发生改变他都会执行，并且任意一个事件都有可能触发它。因此得需要慎用，以防影响到性能</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>视图</tag>
        <tag>更新</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVASCRIPT中的对象拷贝</title>
    <url>/2019/12/07/JAVASCRIPT%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%8B%B7%E8%B4%9D/</url>
    <content><![CDATA[<p>对象拷贝，可能很多人并不是很清楚，而且也使用的不多，简单的说拷贝对象就是直接复制一个数组或者一个对象，听到复制可能大家都蒙了，该如何才能达到复制一个对象或者数组？我们可以将这里的复制理解为是赋值，我们可以将一个数组或者一个对象直接赋值给一个变量，这个过程就可以称为复制（或者对象拷贝），大家一定不要被“复制、拷贝”这样的名词给搞晕了。下面我们来看几个简单的示例</p>
<h2 id="JavaScript拷贝数组（浅拷贝）"><a href="#JavaScript拷贝数组（浅拷贝）" class="headerlink" title="JavaScript拷贝数组（浅拷贝）"></a>JavaScript拷贝数组（浅拷贝）</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arry = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arry1 = arry</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arry) <span class="comment">//输出[1,2,3]，说明拷贝数组成功</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">arry1[<span class="number">1</span>] = <span class="number">6</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arry1) <span class="comment">//改变arry1拷贝过来数组中的值，输出[1,6,3]</span></span></pre></td></tr></table></figure>
<p>这就是一个简单的数组拷贝的过程，其意义在于，当我们需要使用和arry相同数据的时候，并且只需要更改其中的一个值，从而达到另一个效果，那么我们就可以使用这一的方式进行数组拷贝。<br>当然，以上方法主要是属于数组的浅拷贝。</p>
<h2 id="JavaScript数组深拷贝"><a href="#JavaScript数组深拷贝" class="headerlink" title="JavaScript数组深拷贝"></a>JavaScript数组深拷贝</h2><h3 id="for-循环实现数组的深拷贝"><a href="#for-循环实现数组的深拷贝" class="headerlink" title="for 循环实现数组的深拷贝"></a>for 循环实现数组的深拷贝</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyArry</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">let</span> result = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     result.push(arr[i])</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">return</span> result;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = copyArry();</span></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="slice-方法实现数组的深拷贝"><a href="#slice-方法实现数组的深拷贝" class="headerlink" title="slice 方法实现数组的深拷贝"></a>slice 方法实现数组的深拷贝</h3><p>将原数组中抽离部分出来形成一个新数组</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr2 = arr.slice(<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr2) <span class="comment">//[1,2,3,4,5,6]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">3</span>] = <span class="number">9</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr2) <span class="comment">//[1,2,3,4,5,6]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr) <span class="comment">//[1,2,3,9,5,6]</span></span></pre></td></tr></table></figure>
<h2 id="concat-方法实现数组的深拷贝"><a href="#concat-方法实现数组的深拷贝" class="headerlink" title="concat 方法实现数组的深拷贝"></a>concat 方法实现数组的深拷贝</h2><p>这个代码也非常简单，原理更加粗暴。它是用于连接多个数组组成一个新的数组的方法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr2 = arr.concat()</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">2</span>] = <span class="number">5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr)<span class="comment">//[1, 2, 5, 4, 5]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr2)<span class="comment">//[1, 2, 3, 4, 5]</span></span></pre></td></tr></table></figure>
<h2 id="对象的深拷贝"><a href="#对象的深拷贝" class="headerlink" title="对象的深拷贝"></a>对象的深拷贝</h2><h3 id="for循环实现对象拷贝"><a href="#for循环实现对象拷贝" class="headerlink" title="for循环实现对象拷贝"></a>for循环实现对象拷贝</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name:<span class="string">'李四'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  sex:<span class="string">'男'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  addr:<span class="string">'北京'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyObj</span>(<span class="params">obj</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> result = &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    result[key] = obj[key]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> result</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj2 = copyObj(obj)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj2)<span class="comment">//&#123;name: "李四", sex: "男", addr: "北京"&#125;</span></span></pre></td></tr></table></figure>
<h3 id="转换成json再转换成对象实现对象的深拷贝"><a href="#转换成json再转换成对象实现对象的深拷贝" class="headerlink" title="转换成json再转换成对象实现对象的深拷贝"></a>转换成json再转换成对象实现对象的深拷贝</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name:<span class="string">'李四'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  sex:<span class="string">'男'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  addr:<span class="string">'北京'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj2 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj))</span></pre></td></tr></table></figure>
<h2 id="ES6中的对象拷贝（复制）"><a href="#ES6中的对象拷贝（复制）" class="headerlink" title="ES6中的对象拷贝（复制）"></a>ES6中的对象拷贝（复制）</h2><h3 id="使用Object-assign"><a href="#使用Object-assign" class="headerlink" title="使用Object.assign()"></a>使用Object.assign()</h3><p>ES6中使用Object.assign()深度复制对象，包括其prototype</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Point = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"></span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.x = x;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Point.prototype.y = <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Point(<span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> copy = <span class="built_in">Object</span>.assign(&#123; <span class="attr">__proto__</span>: obj.__proto__ &#125;, obj); <span class="comment">// 输出&#123;x:1&#125; ，__proto__为y:2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(copy) <span class="comment">// 输出&#123;x:1&#125;,__proto__为y:2</span></span></pre></td></tr></table></figure>
<h3 id="ES6展开运算符-Spread-Operator"><a href="#ES6展开运算符-Spread-Operator" class="headerlink" title="ES6展开运算符(Spread Operator)"></a>ES6展开运算符(Spread Operator)</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;obj,<span class="attr">d</span>:<span class="number">4</span>,<span class="attr">e</span>:<span class="number">5</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj1) <span class="comment">//&#123;a:1,b:2,c:3,d:4,e:5&#125;</span></span></pre></td></tr></table></figure>
<p>但是这种方法如果出现重复的属性名称，就可以利用下面的方法去重</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">a</span>:<span class="number">4</span>,<span class="attr">b</span>:<span class="number">5</span>,<span class="attr">c</span>:<span class="number">6</span>,obj&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj1) <span class="comment">//&#123;a:1,b:2,c:3&#125;</span></span></pre></td></tr></table></figure>
<p>先展开obj</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;obj,<span class="attr">a</span>:<span class="number">4</span>,<span class="attr">b</span>:<span class="number">5</span>,<span class="attr">c</span>:<span class="number">6</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj1) <span class="comment">//&#123;a:4,b:5,c:6&#125;</span></span></pre></td></tr></table></figure>
<p>看到了吗？他们有一个先后顺序</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>拷贝</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVASCRIPT中数组去重的多种方法</title>
    <url>/2019/12/07/JAVASCRIPT%E4%B8%AD%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>数组去重，简单来说就是一个数组中如果同时存在两个相同的值，但是我们只需要其中一个即可，不需要将两个相同的值都一起展示出来，这个时候就必须得使用到javascript的数组去重方法了，在javascript中并没有专门的方法直接去重的，因此我们得自己来写一个这样的方法。下面我仅介绍其中的容易理解的4种方法，当然还有其他更多的方法，希望大家能够自己去寻找和学习了，因为目前我就仅能理解这3种方法。<br>大概的思路应该是这样的：<br>1）、定义一个变量数组 res 保存结果，遍历需要去重的数组，如果该元素已经存在在 res 中了，则说明是重复的元素，如果没有，则放入 res 中。<br>2）、将原数组中重复元素的最后一个元素放入结果数组中<br>下面我们直接来看代码，代码可以让你一目了然。</p>
<h2 id="万能的for循环"><a href="#万能的for循环" class="headerlink" title="万能的for循环"></a>万能的for循环</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">'1'</span>,<span class="string">'3'</span>,<span class="string">'3'</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueTwo</span>(<span class="params">arr</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> res = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; arr.length; i++)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> item = arr[i]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    res.indexOf(item)===<span class="number">-1</span> &amp;&amp; res.push(item)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> res;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> testTwo = uniqueTwo(arr);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'testTwo'</span>,testTwo); <span class="comment">// 返回[1, 2, 3, "1", "3"]</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<p>以上代码，我们可以分析得到，首先我们遍历整个数组，将得到的值通过indexOf（首次出现的位置）得到字符第一次出现的位置，如果没有出现过则会返回-1，那么说明数组中仅包含一个此类字符，接着将其push到一个新的数组中即可。</p>
<h2 id="使用indexOf与filter（代码更加简洁）"><a href="#使用indexOf与filter（代码更加简洁）" class="headerlink" title="使用indexOf与filter（代码更加简洁）"></a>使用indexOf与filter（代码更加简洁）</h2><p>filter() 方法是创建一个新的数组，新数组中的元素是通过检查指定数组中符合条件的所有元素。<br>filter使用方法 array.filter(function(currentValue,index,arr), thisValue)<br>currentValue 必须。当前元素的值<br>index 可选。当期元素的索引值<br>arr 可选。当期元素属于的数组对象<br>thisValue 可选。对象作为该执行回调时使用，传递给函数，用作 “this” 的值。如果省略了 thisValue ，”this” 的值为 “undefined”</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">'1'</span>,<span class="string">'3'</span>,<span class="string">'3'</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueThree</span>(<span class="params">arr</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">item, index, array</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> array.indexOf(item) === index;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> testThree = uniqueThree(arr);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'testThree'</span>,testThree); <span class="comment">//返回[1, 2, 3, "1", "3"]</span></span></pre></td></tr></table></figure>
<p>使用filter来创建一个新数组，并且此数组中使用indexOf来进行去重即可</p>
<h2 id="先将数组进行排序后，在进行对比"><a href="#先将数组进行排序后，在进行对比" class="headerlink" title="先将数组进行排序后，在进行对比"></a>先将数组进行排序后，在进行对比</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> b = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">32</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">b.sort();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> res = []</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;b.length;i++)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span>(b[i+<span class="number">1</span>] != b[i])&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    res.push(b[i])</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(res)<span class="comment">//[0, 1, 13, 2, 3, 32, 4, 5, 6, 7, 8, 9]</span></span></pre></td></tr></table></figure>
<h2 id="ES6中的强大方法"><a href="#ES6中的强大方法" class="headerlink" title="ES6中的强大方法"></a>ES6中的强大方法</h2><p>在ES6中，我们可以直接通过Array.from()方法创建一个新数组，Array.from()很像slice方法，但是我们还可以使用Set方法。直接看代码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">'1'</span>,<span class="string">'3'</span>,<span class="string">'3'</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr))</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> test = unique(arr);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(test); <span class="comment">//返回[1, 2, 3, "1", "3"]</span></span></pre></td></tr></table></figure>
<p>甚至，外面可以将ES6直接简写成如下代码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">'1'</span>,<span class="string">'3'</span>,<span class="string">'3'</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> unique = <span class="function">(<span class="params">arr</span>)=&gt;</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  [...new <span class="built_in">Set</span>(arr)]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>是不是感觉ES6更加强大？什么，你还不会ES6？赶快加紧学习吧，再不学习新技术，你就落伍了！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>去重</tag>
      </tags>
  </entry>
  <entry>
    <title>老生常谈系列之CSS3画三角及画圆</title>
    <url>/2019/12/07/%E8%80%81%E7%94%9F%E5%B8%B8%E8%B0%88%E7%B3%BB%E5%88%97%E4%B9%8BCSS3%E7%94%BB%E4%B8%89%E8%A7%92%E5%8F%8A%E7%94%BB%E5%9C%86/</url>
    <content><![CDATA[<p>这是一道前端开发中常常被问到的基础问题，该如何画一个三角形？该如何画一个圆？被问到的时候，可能在你脑海里飘过的就是“我好像在哪里看过，但是记不得了”，我们往往觉得很简单的问题，往往却被面试官问到脸红、紧张。下面就来说说利用css画出各种基本图形的代码。<br>1、画圆<br>画圆，我们可以利用CSS3中的border-radius方法具体使用是将一个四方形设置上等宽等高后，再去设置边框的弧度为宽高的一半</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.circle</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-radius</span>: <span class="number">25px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: blue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>2、画三角形：<br>思路是将某两个边框设置为透明，然后设置三角形底边的边框颜色以及高度即可</p>
<a id="more"></a>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//向上</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.triangle-up</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-right</span>: <span class="number">50px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">//向左</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.triangle-left</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>:<span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-top</span>: <span class="number">20px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-right</span>: <span class="number">20px</span> solid blueviolet;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">//等边三角形，底边等于左右边的和</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.triangle</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-right</span>: <span class="number">50px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">100px</span> solid red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">//直角三角形，四边形的相邻两边的边框设为一样的宽度，一边透明，一边有颜色</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.triangle-90</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">50px</span> solid maroon;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>3、平行四边形<br>只需要使用ccs中的扭曲属性skew即可实现，给他角度</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.css_skew</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">80px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: mediumseagreen;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">transform</span>: <span class="built_in">skew</span>(20deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>以下是课外题，感兴趣的可以研究下：<br>4、五角星</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#star-five</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">margin</span>: <span class="number">50px</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">position</span>: relative;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">color</span>: red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">width</span>: <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">height</span>: <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-right</span>:  <span class="number">100px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-bottom</span>: <span class="number">70px</span>  solid red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-left</span>:   <span class="number">100px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-moz-transform</span>:    <span class="built_in">rotate</span>(35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-ms-transform</span>:     <span class="built_in">rotate</span>(35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-o-transform</span>:      <span class="built_in">rotate</span>(35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-id">#star-five</span><span class="selector-pseudo">:before</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-bottom</span>: <span class="number">80px</span> solid red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-left</span>: <span class="number">30px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-right</span>: <span class="number">30px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">top</span>: -<span class="number">45px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">left</span>: -<span class="number">65px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">content</span>: <span class="string">''</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(-35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-moz-transform</span>:    <span class="built_in">rotate</span>(-35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-ms-transform</span>:     <span class="built_in">rotate</span>(-35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-o-transform</span>:      <span class="built_in">rotate</span>(-35deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-id">#star-five</span><span class="selector-pseudo">:after</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">color</span>: red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">top</span>: <span class="number">3px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">left</span>: -<span class="number">105px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">width</span>: <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">height</span>: <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-right</span>: <span class="number">100px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-bottom</span>: <span class="number">70px</span> solid red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">border-left</span>: <span class="number">100px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(-70deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-moz-transform</span>:    <span class="built_in">rotate</span>(-70deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-ms-transform</span>:     <span class="built_in">rotate</span>(-70deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">-o-transform</span>:      <span class="built_in">rotate</span>(-70deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="attribute">content</span>: <span class="string">''</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>5、爱心</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#heart</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">position</span>: relative;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">90px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-id">#heart</span><span class="selector-pseudo">:before</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-id">#heart</span><span class="selector-pseudo">:after</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">left</span>: <span class="number">50px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>: <span class="number">80px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: red;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-moz-border-radius</span>: <span class="number">50px</span> <span class="number">50px</span> <span class="number">0</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50px</span> <span class="number">50px</span> <span class="number">0</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(-45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="attribute">-moz-transform</span>: <span class="built_in">rotate</span>(-45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-ms-transform</span>: <span class="built_in">rotate</span>(-45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="attribute">-o-transform</span>: <span class="built_in">rotate</span>(-45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="attribute">-moz-transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-ms-transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="attribute">-o-transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attribute">transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-id">#heart</span><span class="selector-pseudo">:after</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="attribute">-moz-transform</span>: <span class="built_in">rotate</span>(45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-ms-transform</span>: <span class="built_in">rotate</span>(45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="attribute">-o-transform</span>: <span class="built_in">rotate</span>(45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attribute">transform</span>: <span class="built_in">rotate</span>(45deg);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-transform-origin</span>: <span class="number">100%</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="attribute">-moz-transform-origin</span>: <span class="number">100%</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-ms-transform-origin</span>: <span class="number">100%</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="attribute">-o-transform-origin</span>: <span class="number">100%</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attribute">transform-origin </span>:<span class="number">100%</span> <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>三角</tag>
        <tag>圆</tag>
      </tags>
  </entry>
  <entry>
    <title>老生常谈系列之THIS、CALL、APPLY</title>
    <url>/2019/12/07/%E8%80%81%E7%94%9F%E5%B8%B8%E8%B0%88%E7%B3%BB%E5%88%97%E4%B9%8BTHIS%E3%80%81CALL%E3%80%81APPLY/</url>
    <content><![CDATA[<p>在JavaScript中我们经常要使用到this关键字，但是有时候this的指向总是让我们搞不明白，理不清楚。总之刚开始接触的时候直接是一头雾水，当然this指向都没法搞清楚，那么就很难判断出很多代码输出的结果。比如以下代码中，大家可以猜一猜this指向的是谁？</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUrl</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">getUrl()</span></pre></td></tr></table></figure>
<p>以上代码中很简单的一个例子，其实我们打印出来后this指向的是window对象<br>然而这并没有什么卵用，最多就是我们知道了this的指向。由此JavaScript中就出现了call、apply方法，这两个方法主要是用于动态改变this指向的，他们的使用方法一样，只不过是传递的参数不一样罢了。<br>使用方法：<br>如果call或apply的第一参数是null的话， this指向window</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">obj.myFunc();</span></pre></td></tr><tr><td class="code"><pre><span class="line">myFunc.call(obj,arg);<span class="comment">//以参数的方式进行传递</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">myFunc.apply(obj,[arg1,arg2..]);<span class="comment">//以数组的方式进行传递</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="动态改变this指向"><a href="#动态改变this指向" class="headerlink" title="动态改变this指向"></a>动态改变this指向</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeStyle</span>(<span class="params">attr, value</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.style[attr] = value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> box = <span class="built_in">document</span>.getElementById(<span class="string">'box'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.changeStyle.call(box,<span class="string">"height"</span>,<span class="string">"200px"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.changeStyle.apply(box,[<span class="string">'height'</span>,<span class="string">'200px'</span>])</span></pre></td></tr></table></figure>
<p>以上代码都是直接将this指向了box对象</p>
<h2 id="使用call以及apply实现继承"><a href="#使用call以及apply实现继承" class="headerlink" title="使用call以及apply实现继承"></a>使用call以及apply实现继承</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pepole = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.name = <span class="string">'jack'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.sex = <span class="string">'M'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> man = &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">pepole.call(man)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(man) <span class="comment">//&#123;name: "jack", sex: "M"&#125;</span></span></pre></td></tr></table></figure>
<p>man继承了pepole对象的属性</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>this</tag>
        <tag>call</tag>
        <tag>apply</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVASCRIPT编写属于自己的类型检测函数</title>
    <url>/2019/12/07/JAVASCRIPT%E7%BC%96%E5%86%99%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%B5%8B%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<p>不要跟我说类型检测不是很简单吗？好像直接使用typeof就可以检测了，这个有什么难度？但是大家都知道使用typeof检测出来的并无法检测出Arry、Date、RegExp、Error、Null等特殊类型，如我们遇到是arry的类型，检测出来的是object类型。因此我们想要得到更加精确的类型，就必须得自己动手写一个函数出来判断下类型</p>
<h2 id="了解Object-prototype-toString"><a href="#了解Object-prototype-toString" class="headerlink" title="了解Object.prototype.toString"></a>了解Object.prototype.toString</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> b = <span class="literal">null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.call(b) <span class="comment">//[object Null]</span></span></pre></td></tr></table></figure>
<p>由Object.prototype.toString的方法我们可以知道这个方法可以获得[object Null]，[object Error]等类型。这样我们就可以直接来拼接一个属于我们自己的类型检测函数啦</p>
<h2 id="类型检测函数type"><a href="#类型检测函数type" class="headerlink" title="类型检测函数type"></a>类型检测函数type</h2><p>大致的思想是：假如我们检测到的是object，那么就使用Object.prototype.toString去检测，否则就使用typeof进行检测</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> typeClass = &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"Boolean Number String Function Array Date RegExp Object Error Null Undefined"</span>.split(<span class="string">' '</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">item, index</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  typeClass[<span class="string">'[object '</span>+ item +<span class="string">']'</span>] = item.toLowerCase();</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">type</span>(<span class="params">obj</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> objType = <span class="keyword">typeof</span> obj ===<span class="string">'object'</span> || <span class="keyword">typeof</span> obj ===<span class="string">'function'</span> ? typeClass[<span class="built_in">Object</span>.prototype.toString.call(obj)] || <span class="string">'object'</span> : <span class="keyword">typeof</span> obj;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> objType</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">type(<span class="number">111</span>) <span class="comment">//number</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">type(<span class="string">'111'</span>) <span class="comment">//string</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">type([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]) <span class="comment">//array</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">type(<span class="literal">null</span>) <span class="comment">//null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">type(&#123;<span class="attr">a</span>:<span class="number">1</span>&#125;) <span class="comment">//object</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">type(<span class="keyword">new</span> <span class="built_in">Date</span>()) <span class="comment">//date</span></span></pre></td></tr></table></figure>
<h2 id="JQ中的type函数"><a href="#JQ中的type函数" class="headerlink" title="JQ中的type函数"></a>JQ中的type函数</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">type: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> ( obj == <span class="literal">null</span> ) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="keyword">return</span> obj + <span class="string">""</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> obj === <span class="string">"object"</span> || <span class="keyword">typeof</span> obj === <span class="string">"function"</span> ?</span></pre></td></tr><tr><td class="code"><pre><span class="line">       class2type[ toString.call( obj ) ] || <span class="string">"object"</span> :</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="keyword">typeof</span> obj;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>JQ中对IE浏览器做了兼容！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>类型检测</tag>
      </tags>
  </entry>
  <entry>
    <title>个性化HTML5中的VIDEO，打造属于自己的HTML5视频播放器</title>
    <url>/2019/12/07/%E4%B8%AA%E6%80%A7%E5%8C%96HTML5%E4%B8%AD%E7%9A%84VIDEO%EF%BC%8C%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84HTML5%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8/</url>
    <content><![CDATA[<p>本文使用的都是CSS3以及html5中的video实现的播放器，在PC与手机端都可以完美播放，目前还未实现播放进度条的拖移功能，后续会增加这个功能。<br>demo效果查看地址：<a href="https://king2088.github.io/html5-vPlayer/" target="_blank" rel="noopener">https://king2088.github.io/html5-vPlayer/</a><br>先看效果图：</p>
<img src="/2019/12/07/%E4%B8%AA%E6%80%A7%E5%8C%96HTML5%E4%B8%AD%E7%9A%84VIDEO%EF%BC%8C%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84HTML5%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8/WX20171112-134847@2x.png" class="" title="个性化播放器">
<p>首先我们要了解一下html5中的media事件以及属性</p>
<a id="more"></a>
<h2 id="html5-Media-api"><a href="#html5-Media-api" class="headerlink" title="html5 Media api"></a>html5 Media api</h2><p>*loadstart<br>*progress<br>*suspend<br>*abort<br>*error<br>*emptied<br>*stalled<br>*loadedmetadata<br>*loadeddata<br>*canplay<br>*canplaythrough<br>*playing<br>*waiting<br>*seeking<br>*seeked<br>*ended<br>*durationchange<br>*timeupdate<br>*play<br>*pause<br>*ratechange<br>*resize<br>*volumechange</p>
<h2 id="Media-properties"><a href="#Media-properties" class="headerlink" title="Media properties"></a>Media properties</h2><p>[ “error”, “src”, “srcObject”, “currentSrc”, “crossOrigin”, “networkState”, “preload”, “buffered”, “readyState”, “seeking”, “currentTime”, “duration”, “paused”, “defaultPlaybackRate”, “playbackRate”, “played”, “seekable”, “ended”, “autoplay”, “loop”, “controls”, “volume”, “muted”, “defaultMuted”, “audioTracks”, “videoTracks”, “textTracks”, “width”, “height”, “videoWidth”, “videoHeight”, “poster” ]<br>3、CSS部分代码</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">*,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#vPlayer</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#vPlayer</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#vPlayer</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#vPlayer</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: relative;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">overflow</span>: hidden;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerContent</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerContent</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerContent</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerContent</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">z-index</span>: <span class="number">99999999</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">bottom</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">4px</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span><span class="selector-pseudo">:after</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span><span class="selector-pseudo">:after</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span><span class="selector-pseudo">:after</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span><span class="selector-pseudo">:after</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">clear</span>: both;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">24px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">24px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-radius</span>: <span class="number">14px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> <span class="number">#ccc</span> solid;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin-left</span>: <span class="number">8px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.playButton</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.playButton</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.playButton</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.playButton</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">4px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">8px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-top</span>: <span class="number">8px</span> solid transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-left</span>: <span class="number">10px</span> solid <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.pauseButton</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.pauseButton</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.pauseButton</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.playButtonWrap</span> <span class="selector-class">.pauseButton</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-left</span>: <span class="number">2px</span> <span class="number">#ccc</span> solid;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-right</span>: <span class="number">2px</span> <span class="number">#ccc</span> solid;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-id">#vplayerTimeLine</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-id">#vplayerTimeLine</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-id">#vplayerTimeLine</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-id">#vplayerTimeLine</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin-left</span>: <span class="number">2%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: right;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">10%</span> <span class="number">0</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">25%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#volumeIcon</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#volumeIcon</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#volumeIcon</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#volumeIcon</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">3px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-width</span>: <span class="number">5px</span> <span class="number">10px</span> <span class="number">5px</span> <span class="number">0px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-color</span>: transparent <span class="number">#ccc</span> transparent transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-style</span>: solid;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/*喇叭效果*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">-webkit-box-shadow</span>: inset <span class="number">15px</span> <span class="number">0</span> <span class="number">#666</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">-moz-box-shadow</span>: inset <span class="number">15px</span> <span class="number">0</span> <span class="number">#666</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">15px</span> <span class="number">0</span> <span class="number">#666</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">70%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: relative;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragBar</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragBar</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragBar</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragBar</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">8px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#369</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">top</span>: -<span class="number">3px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">cursor</span>: pointer;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragMask</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragMask</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragMask</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-class">.vPlayVolumeWrap</span> <span class="selector-id">#vPlayVolume</span> <span class="selector-id">#dragMask</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#369</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#playerControler</span> <span class="selector-id">#fullScreen</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#playerControler</span> <span class="selector-id">#fullScreen</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#playerControler</span> <span class="selector-id">#fullScreen</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#playerControler</span> <span class="selector-id">#fullScreen</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">24px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">24px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: right;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">2%</span> <span class="number">0</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAA/UlEQVRIS91V2w3CMAy8qP0HNoAJoOrtQ9mgI8AEiAlgBAZxJEaADWCBGqUqUktbkSAVAfmMH+ezk7PBwMcMnB+fB7DW5kVRLI0xixq7K8lJna2IXAGMandnVT3GcbxJksTZytNg4JKr6rajbTeS4xcAD/OOZN4JICInAHNjzCpN00PIfGrFnUnO+gDUGUi+NRsRacU3EnU5hLD4CoBy+s8D9WVRvaxG/Fu99gVsPdOQQF/fP2NQDUmfZcG3HV3x//cPBpeKUuwA5CR3vr13ftbaTFX3AC4kp6Fy7bMPXst1VYnbCVnF5BHksw8uAI5RFK17F05IS3x9f/8n3wFQDZcZDw/gGQAAAABJRU5ErkJggg=="</span>) no-repeat center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#progressBar</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#progressBar</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#progressBar</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#progressBar</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#333</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: relative;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">z-index</span>: <span class="number">999</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span> <span class="selector-class">.progress</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span> <span class="selector-class">.progress</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span> <span class="selector-class">.progress</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-id">#progressBar</span> <span class="selector-class">.reloadProgress</span> <span class="selector-class">.progress</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#008b8b</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-class">.fadeIn</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-class">.fadeIn</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-class">.fadeIn</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-class">.fadeIn</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">animation-name</span>: fadeIn;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">* <span class="selector-class">.fadeOut</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-class">.fadeOut</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-class">.fadeOut</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span> <span class="selector-class">.fadeOut</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">animation-name</span>: fadeOut;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">moz</span>-<span class="keyword">keyframes</span> fadeIn &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> fadeIn &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">o</span>-<span class="keyword">keyframes</span> fadeIn &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@<span class="keyword">keyframes</span> fadeIn &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">moz</span>-<span class="keyword">keyframes</span> fadeOut &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> fadeOut &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">o</span>-<span class="keyword">keyframes</span> fadeOut &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@<span class="keyword">keyframes</span> fadeOut &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">from</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">to</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span><span class="selector-pseudo">::-webkit-media-controls</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span><span class="selector-pseudo">::-moz-media-controls</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span><span class="selector-pseudo">::-webkit-media-controls-enclosure</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: none <span class="meta">!important</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span><span class="selector-pseudo">::-webkit-media-controls-panel</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span><span class="selector-pseudo">::-webkit-media-controls-panel-container</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">video</span><span class="selector-pseudo">::-webkit-media-controls-start-playback-button</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: none <span class="meta">!important</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">-webkit-appearance</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>4、html部分代码</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1, user-scalable=no"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>vPlayer<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/style.css"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"vPlayer"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">"playerContent"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">&lt;!--&lt;source src="http://media.w3.org/2010/05/sintel/trailer.webm" type='video/webm;codecs="vp8, vorbis"'/&gt;--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"http://media.w3.org/2010/05/bunny/movie.mp4"</span> <span class="attr">type</span>=<span class="string">'video/mp4;codecs="avc1.42E01E, mp4a.40.2"'</span>/&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">video</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"playerControler"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"playButtonWrap"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"play"</span> <span class="attr">class</span>=<span class="string">"playButton"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"pause"</span> <span class="attr">class</span>=<span class="string">"pauseButton"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"vplayerTimeLine"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"fullScreen"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"vPlayVolumeWrap"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"volumeIcon"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"vPlayVolume"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dragBar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dragMask"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"progressBar"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"reloadProgress"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/man.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>
<p>5、javascript部分代码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">"use strict"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> vPlayer = <span class="built_in">document</span>.getElementById(<span class="string">'vPlayer'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> playerContent = <span class="built_in">document</span>.getElementById(<span class="string">'playerContent'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> playerControl = <span class="built_in">document</span>.getElementById(<span class="string">'playerControler'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> play = <span class="built_in">document</span>.getElementById(<span class="string">'play'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> pause = <span class="built_in">document</span>.getElementById(<span class="string">'pause'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> reloadProgressDOM = <span class="built_in">document</span>.getElementById(<span class="string">'progressBar'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> progressTimeShowDOM = <span class="built_in">document</span>.getElementById(<span class="string">'vplayerTimeLine'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> volumeIconDOM = <span class="built_in">document</span>.getElementById(<span class="string">'volumeIcon'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> vPlayVolumeDOM = <span class="built_in">document</span>.getElementById(<span class="string">'vPlayVolume'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> dragBarDOM = <span class="built_in">document</span>.getElementById(<span class="string">'dragBar'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> dragMaskDOM = <span class="built_in">document</span>.getElementById(<span class="string">'dragMask'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> fullscreen = <span class="built_in">document</span>.getElementById(<span class="string">'fullScreen'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> _playerControlHidden,_playTime</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> isSupportTouch = <span class="string">'ontouchend'</span> <span class="keyword">in</span> <span class="built_in">document</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('isSupportTouc',isSupportTouch)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    playerContent.controls = <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    playerContent.preload = <span class="string">'auto'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//3000ms hidden player</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    playerControlHidden()</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//play</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    play.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        vPlayerPlay()</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// play.ontouchstart = function () &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//     vPlayerPlay()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//pause</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    pause.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        vPlayerPause()</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// pause.ontouchstart = function () &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//     vPlayerPause()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//show player control</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(!isSupportTouch)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.addEventListener(<span class="string">'mouseover'</span>,playerControlShow)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.addEventListener(<span class="string">'touchstart'</span>,playerControlShow)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//hidden player control</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(!isSupportTouch)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.addEventListener(<span class="string">'mouseleave'</span>,playerControlHidden)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.addEventListener(<span class="string">'touchend'</span>,playerControlHidden)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">vPlayerPlay</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        progressBar()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.play()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        play.style.display = <span class="string">'none'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pause.style.display = <span class="string">'block'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">vPlayerPause</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(_playTime)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            clearInterval(_playTime)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.pause()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pause.style.display = <span class="string">'none'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        play.style.display = <span class="string">'block'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">playerControlShow</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// console.log('start')</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(_playerControlHidden)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            clearTimeout(_playerControlHidden)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(!playerControl.style.opacity) <span class="keyword">return</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerControl.style.display = <span class="string">'block'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerControl.style.animation = <span class="string">'fadeIn 1s'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerControl.style.opacity = <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">playerControlHidden</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// console.log('hidden')</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        _playerControlHidden = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerControl.style.animation = <span class="string">'fadeOut 1s'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerControl.style.opacity = <span class="number">0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerControl.style.display = <span class="string">'none'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,<span class="number">3000</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">progressBar</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        _playTime = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// console.log(playerContent.buffered.end(0))</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">//reload progress time (加载的时间/总时间)*100 = 加载的百分比</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> reloadProgressTime = (playerContent.buffered.end(<span class="number">0</span>) / playerContent.duration) * <span class="number">100</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            reloadProgressDOM.children[<span class="number">0</span>].style.width = reloadProgressTime + <span class="string">'%'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">//progress time = (playerContent.currentTime/playerContent.duration)*100</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> progressTime = playerContent.currentTime</span></pre></td></tr><tr><td class="code"><pre><span class="line">            reloadProgressDOM.children[<span class="number">0</span>].children[<span class="number">0</span>].style.width = (progressTime / playerContent.duration) * <span class="number">100</span> + <span class="string">'%'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">//progress time show</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            progressTimeShowDOM.innerText = secToTime(progressTime)+<span class="string">' | '</span>+secToTime(playerContent.duration)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// console.log(playerContent.duration,playerContent.currentTime,playerContent.buffered.end(0))</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(playerContent.currentTime === playerContent.duration)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                clearInterval(_playTime)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                vPlayerPause()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                reloadProgressDOM.children[<span class="number">0</span>].children[<span class="number">0</span>].style.width = <span class="number">0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,<span class="number">1</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//volume drag control</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    playerContent.volume = <span class="number">0.5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    dragMaskDOM.style.width = <span class="string">'50%'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    dragBarDOM.style.left = <span class="string">'50%'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(!isSupportTouch) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dragBarDOM.onmousedown = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            drag(event, <span class="keyword">this</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dragBarDOM.ontouchstart = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(event)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            drag(event, <span class="keyword">this</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * drag element</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @param event event</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @param ele element</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">drag</span>(<span class="params">event,ele</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> event = event || <span class="built_in">window</span>.event;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> lengthX</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(!isSupportTouch)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            lengthX = event.clientX - ele.offsetLeft;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            lengthX = event.touches[<span class="number">0</span>].clientX - ele.offsetLeft;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(!isSupportTouch) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                dragMove(event,ele,lengthX)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">document</span>.ontouchmove = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                dragMove(event,ele,lengthX)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * drag move volume: volume+ volume-</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @param event event</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @param ele element</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @param x lengthX:clientX</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dragMove</span>(<span class="params">event,ele,x</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> event = event || <span class="built_in">window</span>.event;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> barleft</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(!isSupportTouch) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            barleft = event.clientX - x;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            barleft = event.touches[<span class="number">0</span>].clientX - x;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(barleft &lt; <span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            barleft = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(barleft &gt; vPlayVolumeDOM.offsetWidth - dragBarDOM.offsetWidth)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            barleft = vPlayVolumeDOM.offsetWidth - dragBarDOM.offsetWidth;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dragMaskDOM.style.width = barleft +<span class="string">'px'</span> ;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ele.style.left = barleft + <span class="string">'px'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> volumeValue = barleft/(vPlayVolumeDOM.offsetWidth-dragBarDOM.offsetWidth)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// console.log(volumeValue)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        playerContent.volume = <span class="built_in">parseFloat</span>(volumeValue)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//防止选择内容--当拖动鼠标过快时候，弹起鼠标，bar也会移动，修复bug</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">window</span>.getSelection ? <span class="built_in">window</span>.getSelection().removeAllRanges() : <span class="built_in">document</span>.selection.empty();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.onmouseup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">document</span>.onmousemove = <span class="literal">null</span>; <span class="comment">//移除事件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.ontouchend = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">document</span>.ontouchstart = <span class="literal">null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">document</span>.ontouchmove = <span class="literal">null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    volumeIconDOM.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(playerContent.volume != <span class="number">0</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerContent.volume = <span class="number">0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            dragMaskDOM.style.width = <span class="string">'0'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            dragBarDOM.style.left = <span class="string">'0'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerContent.volume = <span class="number">0.5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            dragMaskDOM.style.width = <span class="string">'50%'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            dragBarDOM.style.left = <span class="string">'50%'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//video fullscreen</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    fullscreen.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(playerContent.webkitRequestFullScreen)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerContent.webkitRequestFullScreen()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(playerContent.mozRequestFullScreen)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerContent.mozRequestFullScreen()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            playerContent.requestFullscreen()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'networkState'</span>,playerContent.networkState)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * format second to hh:mm:ss</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @param second second</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     * @returns &#123;*&#125; format time to 00:00:00</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">     */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> secToTime = <span class="function"><span class="keyword">function</span> (<span class="params">second</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> t</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(second &gt; <span class="number">-1</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> hour = <span class="built_in">Math</span>.floor(second/<span class="number">3600</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> min = <span class="built_in">Math</span>.floor(second/<span class="number">60</span>) % <span class="number">60</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> sec = second % <span class="number">60</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(hour &lt; <span class="number">10</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                t = <span class="string">'0'</span>+ hour + <span class="string">":"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                t = hour + <span class="string">":"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(min &lt; <span class="number">10</span>)&#123;t += <span class="string">"0"</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            t += min + <span class="string">":"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(sec &lt; <span class="number">10</span>)&#123;t += <span class="string">"0"</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            t += sec.toFixed(<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> t</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>整个项目很简单，希望能够帮助到准备进入video事件以及视频处理的同学，此项目已经上传到github，如果你喜欢，请记得给我加星哦！<br>github：<a href="https://github.com/king2088/html5-vPlayer" target="_blank" rel="noopener">https://github.com/king2088/html5-vPlayer</a></p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>html</tag>
        <tag>video</tag>
        <tag>视频</tag>
      </tags>
  </entry>
  <entry>
    <title>原生JAVASCRIPT模拟事件点击</title>
    <url>/2019/12/07/%E5%8E%9F%E7%94%9FJAVASCRIPT%E6%A8%A1%E6%8B%9F%E4%BA%8B%E4%BB%B6%E7%82%B9%E5%87%BB/</url>
    <content><![CDATA[<p>在某些功能上可能我们会使用到模拟用户点击，当然在jQuery中的模拟事件已经很强大了，但是我们再使用其他库或者使用原生JavaScript的时候，不可能使用jQuery的美元号去实现这个功能了，因此只能通过原生JavaScript去实现，下面我们就来看看代码该如何写。<br>原生js中可以通过dispatch方法来模拟用户行为，如点击（click），触屏（touchStart）操作等，我们都可以进行模拟。</p>
<h2 id="自动触发内置事件"><a href="#自动触发内置事件" class="headerlink" title="自动触发内置事件"></a>自动触发内置事件</h2><p>自动触发事件有两种方法，目前支持IE内核以及Firefox内核浏览器，但是并不支持chrome</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//自动触发内置事件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">commonTrigger</span>(<span class="params">el, type</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> evt = <span class="built_in">document</span>.createEvent(<span class="string">"MouseEvents"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    evt.initEvent(type, <span class="literal">true</span>, <span class="literal">true</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    el.dispatchEvent(evt);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//自动触发内置事件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params">el, type</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> event = <span class="keyword">new</span> MouseEvent(type, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="string">'view'</span>: <span class="built_in">window</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="string">'bubbles'</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="string">'cancelable'</span>: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    el.dispatchEvent(event);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="触发自定义事件"><a href="#触发自定义事件" class="headerlink" title="触发自定义事件"></a>触发自定义事件</h2><p>以上的内置事件，在chrome中无法执行，我们只能通过触发自定义事件的方法进行触发，相关代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">customTrigger</span>(<span class="params">el, type</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> event = <span class="keyword">new</span> Event(type);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    el.addEventListener(type, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        alert(<span class="string">'ok'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;, <span class="literal">false</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    el.dispatchEvent(event);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>一看上面的函数，就知道使用方法很简单了，使用如下</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'element'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> type = <span class="string">'click'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">commonTrigger(el, type);</span></pre></td></tr><tr><td class="code"><pre><span class="line">trigger(el, type);</span></pre></td></tr><tr><td class="code"><pre><span class="line">customTrigger(el, type);</span></pre></td></tr></table></figure>
<p>虽然这个代码能够在浏览器中，特别是chrome中实现点击事件，但是总是无法真实的模拟用户点击，大家慎用，jQuery中的方法，我没有尝试过，不知道是否能够真实模拟用户点击。如果你要模拟真实用户点击事件，得通过其他类库实现！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>模拟点击</tag>
      </tags>
  </entry>
  <entry>
    <title>在ELECTRON中使用IONIC2</title>
    <url>/2019/12/07/%E5%9C%A8ELECTRON%E4%B8%AD%E4%BD%BF%E7%94%A8IONIC2/</url>
    <content><![CDATA[<p>electron是atom官方的一个跨平台的桌面应用开发框架，具官方介绍说是“ Build cross platform desktop apps with JavaScript, HTML, and CSS”，也就是说可以直接使用，你最喜欢的html+css+js来开发跨平台的桌面应用程序。如果你之前使用过angular以及react之类的JS框架，那么你就可以使用这些框架来制作一个跨平台的桌面应用。下面我们主要是说一下在ionic2中，我们要如何使用electron与ionic2进行通信！<br>由于electron使用的是chrome的V8引擎，也就是可以理解为一个浏览器，因此我们只需要编写想要的前端代码就可以直接运行在electron中了。建议大家边看electron的doc边做开发。因为我也是刚刚开始接触electron，只不过我只是需要从ionic中传递数据到electron中，让其与其他设备进行交互而已，因此我做的只是一个简单的ionic传递数据到electron，其他的我并不深入。因此大家喜欢研究的朋友可以深入研究下electron。</p>
<h2 id="安装electron"><a href="#安装electron" class="headerlink" title="安装electron"></a>安装electron</h2><p>安装过程可能并不复杂，但是一定要记住要使用淘宝的npm镜像进行安装，因为我翻墙了也无法安装成功，因此建议大家使用cnpm，这个特别快！<br>在nodejs中键入如下命令即可进行安装<br>npm install electron -g</p>
<p>如果是linux或者mac请使用root或者sudo权限进行全局安装</p>
<h2 id="使用electron"><a href="#使用electron" class="headerlink" title="使用electron"></a>使用electron</h2><p>其使用方法很简单，安装完成后直接输入electron就可以看到如下提示：</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">To run your app with Electron, execute the following command in your Console (or Terminal):</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;electron&#x2F;dist&#x2F;Electron.app&#x2F;Contents&#x2F;MacOS&#x2F;Electron path-to-your-app</span></pre></td></tr><tr><td class="code"><pre><span class="line">The path-to-your-app should be the path to your own Electron app.</span></pre></td></tr><tr><td class="code"><pre><span class="line">You can read the quick start guide in Electron&#39;s docs to learn how to write one.</span></pre></td></tr><tr><td class="code"><pre><span class="line">Or you can just drag your app here to run it:</span></pre></td></tr></table></figure>
<p>这句话就已经告诉了我们如何使用electron<br>使用方法如下<br>如果你是全局安装的，可以直接使用下面的命令<br>cd 到你应用根目录，在运行下面命令即可<br>electron . 或者<br>electron ./</p>
<h2 id="在ionic中如何给electron传递数据"><a href="#在ionic中如何给electron传递数据" class="headerlink" title="在ionic中如何给electron传递数据"></a>在ionic中如何给electron传递数据</h2><p>比如你需要将一些数据传递给electron，然后再通过electron连接上打印设备打印出来。首先我们得必须清楚运行在electron里面的js是不能包含electron的，也就是说我们不能使用npm安装electron到ionic项目中去，这样会造成项目无法正常运行。<br>我个人的理解是electron会将你的js对象设置为一个子类，然后将electron的对象都变成如window之类的全局变量。<br>下面就来看看在ionic中我们该如何import或者require相应的electron。</p>
<h2 id="使用ionic"><a href="#使用ionic" class="headerlink" title="使用ionic"></a>使用ionic</h2><p>在ionic2中使用的是angular2,因此我们无法直接使用require函数，因为这个是nodejs的函数，而typescript中是没有的。那在typescript中只有import，但是通过我的努力，import肯定是无法使用的，为什么无法使用？因为我们根本就无需安装electron到ionic中，因此import肯定是无法实现了！<br>还记得我之前写过一篇文章《ionic2中引入自定义js文件或者引入第三方js文件》，对正是这篇文章让我重新满血复活了！在尝试了各种方法没有成功后，我使用了declare的方式来引入相关的方法或者对象。<br>刚开始我直接使用</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">var</span> <span class="built_in">window</span>:<span class="built_in">any</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.require(<span class="string">'electron'</span>)</span></pre></td></tr></table></figure>
<p>但是并没有成功啊，搞得我老泪纵横，始终报错说找不到fs，我又安装了fs，问题依旧，无法解决。<br>功夫不负有心人，最终我使用了下面的方式解决了这个问题</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">var</span> <span class="built_in">require</span>:<span class="built_in">any</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> electron = <span class="built_in">require</span>(<span class="string">'electron'</span>)</span></pre></td></tr></table></figure>
<p>这样就可以解决了无法使用require的方法了。那么下面就更简单了，我们只需要调用electron的相关api就可以进行传递数据等等的操作了！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>ionic</tag>
        <tag>Electron</tag>
      </tags>
  </entry>
  <entry>
    <title>使用CSS设置打印</title>
    <url>/2019/12/07/%E4%BD%BF%E7%94%A8CSS%E8%AE%BE%E7%BD%AE%E6%89%93%E5%8D%B0/</url>
    <content><![CDATA[<p>我们都知道A4的尺寸是210mm * 297mm,在css中，我们可以直接使用毫米的单位来设置页面的宽高，当然你也可以使用相应的像素进行设置，不过只是通过body或者html来设置宽高的话，可能也会出现问题，而在这里我们需要使用@page来对页面进行定义，@page主要是用于打印的时候定义页面的类型，比如A4，A5，A3等等。下面先来看一下@page的使用方法。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">@<span class="keyword">page</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">size</span>: A4;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>另外在设置好@page后，我们可能还会需要设置分页，分页很简单，直接使用page-break-before:always;或者page-break-after:always;就可以设置分页，在网页中是不会显示任何效果的，不过你可以通过浏览器的打印功能进行PDF预览来查看分页是否符合你的要求。<br>不过分页的使用必须的写在@media print中，使用如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">@<span class="keyword">media</span> print&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-class">.page-break</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">page-break-before</span>:always;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>.page-break是需要分页的class的元素。</p>
<a id="more"></a>
<p>必须注意的问题：</p>
<h2 id="table布局"><a href="#table布局" class="headerlink" title="table布局"></a>table布局</h2><p>那么page-break-before:always;不能写在td和tr中，也就是说，table是不能被分页的，这是所有浏览器都不支持的。<br>比如你的代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>6<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>7<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>8<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></pre></td></tr></table></figure>
<p>这样的代码不论你测试多少次，都是无法进行分页的，经过我的测试，在所有的浏览器中都无法实现分页，并且通过打印机打印后，也是无法分页的！<br>对于table，我们只能对整个table进行分页，比如下面的代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>6<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>7<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>8<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>6<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>7<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>8<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></pre></td></tr></table></figure>
<p>以上两个table就可以实现完美的分页，不过网上有人说使用page-break-inside:avoid;可以实现对td或者tr的分页，不过我没有进行尝试，因此不敢断言是否分页成功。</p>
<h2 id="在div中进行分页"><a href="#在div中进行分页" class="headerlink" title="在div中进行分页"></a>在div中进行分页</h2><p>除了table之外，在div中就更加方便使用了，只要你想在任何一个div处进行分页，那就直接使用分页代码即可，比如下面的代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span>11111111111111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span>22222222222222<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span>33333333333333<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>
<p>你可以尝试在浏览器中预览打印的pdf效果，这个div肯定会分成3页进行显示。</p>
<p>最终页面的效果应该如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">body&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">  <span class="selector-tag">width</span><span class="selector-pseudo">:210mm</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">  <span class="selector-tag">height</span><span class="selector-pseudo">:297mm</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">@<span class="keyword">page</span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  size: A4;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  margin: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">@<span class="keyword">media</span> print&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">  <span class="selector-class">.page-break</span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">    <span class="selector-tag">page-break-before</span><span class="selector-pseudo">:always</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span>11111111111111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span>22222222222222<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span>33333333333333<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>6<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>7<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>8<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"page-break"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>9<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>10<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>11<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>12<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>13<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>14<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>15<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>16<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>17<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>打印</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVASCRIPT按照经纬度坐标对比与目的地的距离</title>
    <url>/2019/12/07/JAVASCRIPT%E6%8C%89%E7%85%A7%E7%BB%8F%E7%BA%AC%E5%BA%A6%E5%9D%90%E6%A0%87%E5%AF%B9%E6%AF%94%E4%B8%8E%E7%9B%AE%E7%9A%84%E5%9C%B0%E7%9A%84%E8%B7%9D%E7%A6%BB/</url>
    <content><![CDATA[<p>在开发中可能现在很多都在使用地图定位，而无需在进行复杂的计算距离的方法，因为计算已经被地图给代替了，我们也就不需要再进行坐标到坐标的距离计算了，但是当你只是想使用距离而不想使用地图的时候，你就得进行坐标计算了，这不我在一个项目中就遇到这样的问题，根据手机获取当前地理位置的坐标，然后再与目的地坐标（已知坐标）进行计算，并且得到距离，当然也可以实时更新手机坐标以获得最准确的距离。<br>下面我们直接看代码吧！</p>
<a id="more"></a>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!Doctype html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">UTF-8</span>"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>获取地理信息<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>navigator是window环境下的一个属性，包含了当前浏览器的一些信息数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>geolocation，HTML5的新属性，是navigator对象的一个属性<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>getCurrentPosition(getPositionSuccess, getPositionError, position_option)是geolocation下的一个方法，返回当前位置信息<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">&lt;!--获取用户当前位置信息--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">              navigator.geolocation.watchPosition(getposition);</span></pre></td></tr><tr><td class="code"><pre><span class="line">              移动端使用，位置改变触发getposition</span></pre></td></tr><tr><td class="code"><pre><span class="line">            */</span></pre></td></tr><tr><td class="code"><pre><span class="line">            getposition();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">            <span class="function"><span class="keyword">function</span> <span class="title">getposition</span><span class="params">()</span></span>&#123;        <span class="comment">//获取位置信息</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                if(navigator.geolocation)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                     /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        position_option配置navigator.geolocation.getCurrentPosition方法参数</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    */</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                      <span class="keyword">var</span> position_option = &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                              enableHighAccuracy: <span class="literal">true</span>,            <span class="comment">//是否使用高精度设备获取值，gps&gt;wifi&gt;ip</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                              maximumAge: <span class="number">30000</span>,            <span class="comment">//表示浏览器重新获取位置信息的时间间隔</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                              timeout: <span class="number">5000</span>        <span class="comment">//设定请求超时时间</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                          &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                      /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">                          调用navigator.geolocation.getCurrentPosition方法可获取用户当前位置，该方法有三个参数：</span></pre></td></tr><tr><td class="code"><pre><span class="line">                          获取成功后回调函数，并传入一个position值</span></pre></td></tr><tr><td class="code"><pre><span class="line">                          获取失败后回调函数，并传入error信息</span></pre></td></tr><tr><td class="code"><pre><span class="line">                          配置项：json格式，enableHighAccuracy，maximumAge，timeout三个参数配置</span></pre></td></tr><tr><td class="code"><pre><span class="line">                      */</span></pre></td></tr><tr><td class="code"><pre><span class="line">                      navigator.geolocation.getCurrentPosition(getPositionSuccess, getPositionError, position_option);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                &#125;<span class="keyword">else</span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                    alert(<span class="string">"很抱歉，您的设备不支持地理定位！"</span>)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                     </span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                 </span></pre></td></tr><tr><td class="code"><pre><span class="line">            /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">                成功后回调函数getPositionSuccess( position )，position为成功后返回信息对象</span></pre></td></tr><tr><td class="code"><pre><span class="line">            */</span></pre></td></tr><tr><td class="code"><pre><span class="line">           </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">            <span class="function"><span class="keyword">function</span> <span class="title">getPositionSuccess</span><span class="params">(position)</span></span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">var</span> lat = position.coords.latitude;            <span class="comment">//获取纬度</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">var</span> lng = position.coords.longitude;        <span class="comment">//获取经度</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    positiion对象比较少用到的属性</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    timestamp返回当前位置创建时间的时间戳</span></pre></td></tr><tr><td class="code"><pre><span class="line">                   </span></pre></td></tr><tr><td class="code"><pre><span class="line">                    coords.accuracy    位置精度</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    coords.altitude    海拔，海平面以上以米计</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    coords.altitudeAccuracy    位置的海拔精度</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    coords.heading    方向，从正北开始以度计</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    coords.speed    速度，以米/每秒计</span></pre></td></tr><tr><td class="code"><pre><span class="line">                */</span></pre></td></tr><tr><td class="code"><pre><span class="line">               </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                alert( <span class="string">"您所在的位置： 纬度"</span> + lat + <span class="string">"，经度"</span> + lng );</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">if</span>(<span class="keyword">typeof</span> position.address !== <span class="string">"undefined"</span>)&#123;        <span class="comment">//判断是position对象是否有address属性，有则输出address信息</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">var</span> country = position.address.country;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">var</span> province = position.address.region;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">var</span> city = position.address.city;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        alert(<span class="string">' 您位于 '</span> + country + province + <span class="string">'省'</span> + city +<span class="string">'市'</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">               </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">if</span>(lat != <span class="string">''</span> &amp;&amp; lng != <span class="string">''</span>)&#123;        <span class="comment">//判断，如果经纬度不等于空则计算两个位置间的距离</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                   alert(distance(lat,lng,<span class="number">23.137004</span>,<span class="number">113.301858</span>)+<span class="string">"米"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">           </span></pre></td></tr><tr><td class="code"><pre><span class="line">            /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">                失败后回调函数getPositionError(error)，error为失败后返回信息</span></pre></td></tr><tr><td class="code"><pre><span class="line">            */</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">            <span class="function"><span class="keyword">function</span> <span class="title">getPositionError</span><span class="params">(error)</span></span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                /*</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    error.message为返回错误信息，建议自定义</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    error.code为返回错误提示码</span></pre></td></tr><tr><td class="code"><pre><span class="line">                */</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">switch</span> (error.code) &#123;        </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                    <span class="keyword">case</span> error.TIMEOUT:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        alert(<span class="string">"连接超时，请重试"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">break</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                    <span class="keyword">case</span> error.PERMISSION_DENIED:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        alert(<span class="string">"您拒绝了使用位置共享服务，查询已取消"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">break</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                    <span class="keyword">case</span> error.POSITION_UNAVAILABLE:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        alert(<span class="string">"获取位置信息失败"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">break</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                    <span class="keyword">case</span> error.UNKNOW_ERROR:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        alert(<span class="string">"其它错误"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                        <span class="keyword">break</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">           </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">            <span class="function"><span class="keyword">function</span> <span class="title">distance</span><span class="params">(lat,lng,goalLat,goalLng)</span></span>&#123;            <span class="comment">//传入位置纬度，经度和目标纬度，经度，返回距离值，单位米，对地理感兴趣的童鞋可以去研究下计算公式</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">var</span> EARTH_RADIUS = <span class="number">6378.137</span>;<span class="comment">//地球赤道半径</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="keyword">if</span>(lat != <span class="string">''</span> &amp;&amp; lng != <span class="string">''</span> &amp;&amp; goalLat != <span class="string">''</span> &amp;&amp; goalLng != <span class="string">''</span>)&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                      <span class="keyword">var</span> radLat1 = rad(goalLat);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                       <span class="keyword">var</span> radLat2 = rad(lat);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                      <span class="keyword">var</span> a = radLat1 - radLat2;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                      <span class="keyword">var</span> b = rad(goalLng) - rad(lng);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">                      <span class="keyword">var</span> s = <span class="number">2</span> * <span class="built_in">Math</span>.asin(<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(a/<span class="number">2</span>),<span class="number">2</span>) +<span class="built_in">Math</span>.cos(radLat1)*<span class="built_in">Math</span>.cos(radLat2)*<span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(b/<span class="number">2</span>),<span class="number">2</span>)));</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                      s = s * EARTH_RADIUS;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">                       s = <span class="built_in">Math</span>.round(s * <span class="number">10000</span>) / <span class="number">10000</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                       <span class="keyword">return</span> s*<span class="number">1000</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                &#125;<span class="keyword">else</span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                    <span class="keyword">return</span> <span class="number">0</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span> <span class="title">rad</span><span class="params">(d)</span></span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">                   <span class="keyword">return</span> d * <span class="built_in">Math</span>.PI / <span class="number">180.0</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">&lt;!--</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">               获取经纬度查询计算距离存在误差，现测试范围在100米以内，获取目标经纬度建议直接前往目标地点获取目标经纬度</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">               使用地图获取经纬度可使用谷歌全球，经测试与本人机子GPS获取的经纬度误差最小</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">               中国经度范围:73°33′E至135°05′E</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">               中国纬度范围:3°51′N至53°33′N</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">               计算公式，纬度在前经度在后</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">               百度地图经纬度获取坑，经度放前面，纬度放后面</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">        --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="comment">&lt;!--</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">                经测试发现PC端浏览器无法获取经纬度，原因不明，正努力翻资料中，求解惑</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">         --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>经纬度</tag>
        <tag>距离</tag>
      </tags>
  </entry>
  <entry>
    <title>使用WEBPACK配置ES6开发环境</title>
    <url>/2019/12/07/%E4%BD%BF%E7%94%A8WEBPACK%E9%85%8D%E7%BD%AEES6%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<h2 id="ES6简介"><a href="#ES6简介" class="headerlink" title="ES6简介"></a>ES6简介</h2><p>由于ES6无法直接运行在浏览器中，只能通过babel来进行解析转换（编译）成ES5才可以运行在浏览器中，因此我们就需要给ES6搭建相关的环境，才可以开心的写ES6。<br>目前很多框架都使用了ES6，比如react、vuejs、angular等这些主流前端框架。ES6简洁了很多ES5的代码，让我们可以少写很多代码，当然如果你还了解typescript以及coffeescrpt，那么就更加方便你进行各种开发了。但是问题来了，这些基于ES6的所有框架以及语法糖都需要搭建相关的环境才能够正常运行ES6</p>
<h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><p>webpack是一个前端打包工具，简单说webpack是将所有JavaScript组件以及依赖的库整合为一个js文件，将所有CSS整合为一个css文件。使用webpack可以很方便的打包各种JavaScript组件。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>1)、安装nodeJS（安装方法请到官方查看）<br>2)、使用npm初始化项目</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm init ES6</span></pre></td></tr></table></figure>
<p>ES6是我们开发的项目文件夹<br>运行上面的命令后会让你填写一些有关项目描述等信息，并且在ES6文件夹下会生成一个package.json的文件<br>3)、全局安装webpack</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g webpack</span></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><p>配置ES6环境，我们需要安装以下几个必须的依赖包</p>
<p>babel-core、babel-loader、babel-preset-es2015、html-webpack-plugin、webpack、webpack-dev-server<br>其中babel-core、babel-loader、babel-preset-es2015这几个依赖包主要是用于解析ES6并且转换成ES5的，html-webpack-plugin主要是用于webpack运行html，webpack、webpack-dev-server主要是用于搭建本地服务环境，其中webpack-dev-server是用于热更新的（所谓热更新就是当你修改了代码，不用再去刷新浏览器即可实时运行修改后的代码）<br>运行下面的命令一次性安装所有依赖包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install babel-core babel-loader babel-preset-es2015 html-webpack-plugin webpack webpack-dev-server --save-dev</span></pre></td></tr></table></figure>
<h2 id="创建-babelrc文件"><a href="#创建-babelrc文件" class="headerlink" title="创建.babelrc文件"></a>创建.babelrc文件</h2><p>在根目录创建一个.babelrc文件，输入如下内容</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"presets"</span>: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"es2015"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    ],</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"plugins"</span>: []</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<h2 id="创建webpack配置文件webpack-config-js文件"><a href="#创建webpack配置文件webpack-config-js文件" class="headerlink" title="创建webpack配置文件webpack.config.js文件"></a>创建webpack配置文件webpack.config.js文件</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    entry: path.join(__dirname,<span class="string">'src'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line">    output: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      filename: <span class="string">"public/main.js"</span> <span class="comment">//输出目录及文件名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      loaders: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,<span class="attr">loader</span>: <span class="string">"babel-loader"</span> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    resolve: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        template: <span class="string">'./src/index.html'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;),</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ],</span></pre></td></tr><tr><td class="code"><pre><span class="line">    devtool:<span class="string">'eval-source-map'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    devServer: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      contentBase: <span class="string">"./public"</span>,<span class="comment">//本地服务器所加载的页面所在的目录</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      historyApiFallback: <span class="literal">true</span>,<span class="comment">//不跳转</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      inline: <span class="literal">true</span>,<span class="comment">//实时刷新</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      port: <span class="number">8011</span><span class="comment">//http端口</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr></table></figure>
<p>这样我们就搭建好了webpack的环境了，下面我们需要配置下运行的scripts命令就大功告成了！<br>在此我们需要在根目录下创建两个文件夹，一个是src，另一个是public，在src文件夹中新建两个文件，一个是index.js一个是index.html。</p>
<h2 id="修改package-json"><a href="#修改package-json" class="headerlink" title="修改package.json"></a>修改package.json</h2><p>在package.json中找到scripts:{}，在其中添加如下代码：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"start": "webpack",</span></pre></td></tr><tr><td class="code"><pre><span class="line">"server": "webpack-dev-server --open",</span></pre></td></tr><tr><td class="code"><pre><span class="line">"build": "webpack-dev-server --devtool eval --progress --colors --hot --content-base build"</span></pre></td></tr></table></figure>
<p>如果需要直接build出一个main.js直接运行npm run build<br>如果想要直接在浏览器中查看效果直接运行npm run server</p>
<h2 id="编写一段ES6的代码看看效果"><a href="#编写一段ES6的代码看看效果" class="headerlink" title="编写一段ES6的代码看看效果"></a>编写一段ES6的代码看看效果</h2><p>打开src目录下的index.js文件输入以下代码：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> data = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    id: <span class="number">1</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">'张三'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    sex: <span class="string">'女'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    addr: <span class="string">'深圳南山'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; id, sex, addr&#125; = data</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'people'</span>).innerText = <span class="string">`<span class="subst">$&#123;id&#125;</span>, <span class="subst">$&#123;sex&#125;</span>, <span class="subst">$&#123;addr&#125;</span>`</span>;</span></pre></td></tr></table></figure>
<p>在index.html中增加一个div</p>
<p>直接运行npm run server如果没有任何错误的话，即可看到浏览器中显示了 1, 女, 深圳南山</p>
]]></content>
  </entry>
  <entry>
    <title>利用NODEJS发送邮件</title>
    <url>/2019/12/07/%E5%88%A9%E7%94%A8NODEJS%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/</url>
    <content><![CDATA[<p>做过后端的童鞋都知道发送邮件这样的功能并不复杂，使用目前已有的后端技术比如java、.net、php等编写一个发送邮件的功能是很简单的，但是要编写很多代码，比如java中利用jmail发送邮件并不是一件简单的事情。随着nodeJS的发展，如今利用前端技术实现发送邮件，简直是小菜一碟，不仅仅是代码量减少了，也提高了开发效率。<br>今天主要说的是使用nodeJS的Nodemailer发送邮件<br>首先我们得准备一个QQ邮箱或者GMAIL邮箱（只要支持smtp服务的就可以），主要用于发送邮件。比如QQ邮箱我们可以做如下设置即可开启POP3/SMTP服务，并且可以发送邮件。<br>进入QQ邮箱后点击左上角的设置，再选择账户，如图</p>
<img src="/2019/12/07/%E5%88%A9%E7%94%A8NODEJS%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/WX20171014-144504@2x.png" class="" title="QQ邮箱设置">
<p>将其全部设置为开启即可，这样就可以利用QQ邮箱发送邮件了。<br>使用Nodemailer和QQ邮箱发送邮件</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> nodemailer  = <span class="built_in">require</span>(<span class="string">'nodemailer'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> () =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> transporter = nodemailer.createTransport(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        host: <span class="string">'smtp.qq.email'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        port: <span class="number">465</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        secure: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        auth: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            user: <span class="string">'xxxxx@qq.com'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            pass: <span class="string">'**********'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> mailOptions = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">from</span>: <span class="string">'"小小前端" &lt;admin@admin.com&gt;'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        to: <span class="string">'*******@qq.com'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        subject: <span class="string">'你好'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        text: <span class="string">'你好'</span>, <span class="comment">//文本</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        html: <span class="string">'&lt;h2&gt;你好&lt;/h2&gt;'</span> <span class="comment">//HTML文本</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    transporter.sendMail(mailOptions, (error, info) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span> (error) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            logger.info(<span class="string">`send email to *******@qq.com failed.`</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">'send email failed:\n'</span>+error);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        logger.info(<span class="string">`send email to *******@qq.com success\n"Message sent: %s", <span class="subst">$&#123;info.messageId&#125;</span>`</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="string">'send email success\nMessage sent: %s'</span>, info.messageId);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>node</tag>
        <tag>邮件</tag>
      </tags>
  </entry>
  <entry>
    <title>简简单单理解JAVASCRIPT闭包</title>
    <url>/2019/12/07/%E7%AE%80%E7%AE%80%E5%8D%95%E5%8D%95%E7%90%86%E8%A7%A3JAVASCRIPT%E9%97%AD%E5%8C%85/</url>
    <content><![CDATA[<p>也许你在很多前端面试中都被问及闭包是什么？闭包有什么作用？闭包有什么弊端？但是你真的理解闭包吗？闭包确实对于初学者来说要理解他有些困难，它主要是属于作用域链的问题，下面就由我带领你学习一下或者理解一下JavaScript的闭包。</p>
<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>我们可以将闭包简单的理解为函数内的函数，首先我们来看一个作用域的示例</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 此处是报错了，因为我们在函数外部是无法获取函数内部的变量的</span></span></pre></td></tr></table></figure>
<p>那么我们可以将上面的函数修改为如下的函数即可得到a的值</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> a;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">consolog.log(a); <span class="comment">//返回5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Fn(); <span class="comment">//返回 3</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="闭包（函数作为返回值）"><a href="#闭包（函数作为返回值）" class="headerlink" title="闭包（函数作为返回值）"></a>闭包（函数作为返回值）</h2><p>假如我们想要进行一个相应的计算后，直接输出相应的结果，那么我们就可以直接使用闭包的方式，代码如下</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">FnAdd</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> a + <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> FnAdd;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Fn(); <span class="comment">//返回 4</span></span></pre></td></tr></table></figure>
<p>上面的这个例子就是一个实际常用的闭包，我们在函数内部将内部函数return出去，就可以获得函数内部计算的结果。</p>
<h2 id="闭包（函数作为参数传递）"><a href="#闭包（函数作为参数传递）" class="headerlink" title="闭包（函数作为参数传递）"></a>闭包（函数作为参数传递）</h2><p>除了上面这种函数作为返回值的方法，闭包还可以将函数作为参数传递，示例如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Fn = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span>(num &gt; a)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(x);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">f</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  f(<span class="number">60</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)(Fn)</span></pre></td></tr></table></figure>
<p>以上示例中，我们可以看到虽然我们再匿名函数中再次指定了a的值，但是我们使用的f(60)传递到Fn中的60与a进行比较，f(60)所比较的a的值应该是10，而并不是匿名函数中的a = 20，我们可以简单的将上面的示例重写成如下，以帮助你更好的理解。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span>(num &gt; a)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(x);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> f = Fn();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">f(<span class="number">60</span>)</span></pre></td></tr></table></figure>
<h2 id="闭包的用途（优点）"><a href="#闭包的用途（优点）" class="headerlink" title="闭包的用途（优点）"></a>闭包的用途（优点）</h2><p>1）、可以读取函数内部的变量，另一个就是让这些变量的值始终保持在内存中。<br>2）、逻辑连续，当闭包作为另一个函数调用的参数时，避免你脱离当前逻辑而单独编写额外逻辑。</p>
<h2 id="闭包的缺点"><a href="#闭包的缺点" class="headerlink" title="闭包的缺点"></a>闭包的缺点</h2><p>1）、由于闭包会将返回值或者变量值保存在内存中，使用不当会引起内存泄漏的问题，从而导致浏览器奔溃。所以不能滥用闭包。解决方法是，在退出函数之前，将不使用的局部变量全部删除<br>比如上面第三点提到的示例：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Fn = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span>(num &gt; a)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(x);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">f</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  f(<span class="number">60</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)(Fn)</span></pre></td></tr></table></figure>
<p>为了防止内存泄漏，我们在获得结果后，我们要讲相应的变量从内存中释放出来，那么久用到了null，我们可以将上面的代码改为如下即可</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Fn = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span>(num &gt; a)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(x);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">f</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> a = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  f(<span class="number">60</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)(Fn)</span></pre></td></tr><tr><td class="code"><pre><span class="line">Fn = <span class="literal">null</span></span></pre></td></tr></table></figure>
<p>2）、闭包会在父函数外部，改变父函数内部变量的值。如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
        <tag>闭包</tag>
      </tags>
  </entry>
  <entry>
    <title>MAC上打包CORDOVA混合APP出现PLATFORM ERROR</title>
    <url>/2019/12/07/MAC%E4%B8%8A%E6%89%93%E5%8C%85CORDOVA%E6%B7%B7%E5%90%88APP%E5%87%BA%E7%8E%B0PLATFORMERROR/</url>
    <content><![CDATA[<p>今天在mac上开发的app，要打包成apk文件，打包过程中就出现了问题，错误显示如下：<br>Error: Could not find gradle wrapper within Android SDK. Might need to update your Android SDK.<br>Looked here: /Users/tony/Library/Android/sdk/tools/templates/gradle/wrapper<br>看到这个错误大概的意思是让我升级我的android SDK，但是我看了下我的已经是目前最新版本的androidSDK了，为什么还要我再进行升级？越想越不对劲，最终删除了androidSDK，然后又再次到官网下载安装，但是问题依然存在，始终无法解决问题，最终在google上找到了解决办法，google确实很强大，要什么都能搜索到，因此，希望大家作为一个程序员，最基本的搜索引擎工具使用google，不会翻墙的童鞋，请自行到网上查看各种翻墙工具以及各种翻墙环境的搭建以及hosts文件的修改，可以助你一臂之力。</p>
<p>最终找到原因所在，主要原因是因为目前的androidSDK版本过高，cordova不支持这么高的版本，因此解决的办法并不是将androidSDK进行降级。而是需要在添加platform的时候制定相应的android版本。<br>我当前使用的androidSDK是官方最新的版本26.0.0，然而在cordova的platform中，目前最高仅支持到android6.2.2，因此下面有两种解决办法，看你方便如何选择哪一个进行解决<br>1、添加platform的时候指定相应版本</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cordova platform rm android &#x2F;&#x2F;删除已有的platform</span></pre></td></tr><tr><td class="code"><pre><span class="line">cordova platform add android@6.2.2 &#x2F;&#x2F;添加6.2.2版本的android</span></pre></td></tr></table></figure>
<p>现在你再进行一次build，应该不会再有任何问题了吧！当然我也比较推荐这种方法！<br>2、androidSDK降级<br>删除原有的最新androidSDK工具，然后再下载25.3.1版本及以下版本进行搭建环境</p>
<p>当然可能25.3.1并不兼容某些版本的android系统，不过大部分官方应该已经进行了修复，你可以直接使用以下命令进行安装兼容性最好的android版本</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cordova platform add https:&#x2F;&#x2F;github.com&#x2F;apache&#x2F;cordova-android</span></pre></td></tr></table></figure>
<p>当然以上错误如果你在windows中也遇到过，那么应该也可以尝试这样的解决办法！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Cordova</tag>
        <tag>app</tag>
        <tag>Mac</tag>
      </tags>
  </entry>
  <entry>
    <title>使用SETTIMEOUT出现内存溢出的解决办法</title>
    <url>/2019/12/07/%E4%BD%BF%E7%94%A8SETTIMEOUT%E5%87%BA%E7%8E%B0%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
    <content><![CDATA[<p>setTimeout就是一个定时器，它可以很容易地实现在规定时间内所要执行的函数或方法。但是我再setTimeout的使用过程中就出现了内存溢出的各种问题。下面我将使用一个当前时间与过去的某个时间差的计算方式来进行讲解setTimeout，首先来看逻辑思想部分。<br>对于任何编程语言，我们刚开始都需要进行需求分析，需求分析就是一个实现功能的想法或者步骤。<br>比如我在这个例子中将会使用本地当前时间减去我所获得的时间，得到它们之间的时间差。</p>
<h2 id="获得当前时间"><a href="#获得当前时间" class="headerlink" title="获得当前时间"></a>获得当前时间</h2><p>获得当前时间可以直接使用new Date()，即可获得当前本地或者说本机时间。<br>目前已知时间为：2017-05-20 00:29:10</p>
<h2 id="如何对时间进行相减"><a href="#如何对时间进行相减" class="headerlink" title="如何对时间进行相减"></a>如何对时间进行相减</h2><p>其实在JavaScript中，时间是可以直接进行减法运算的，不过必须是JavaScript的Date日期格式，如果是其他的则不支持，比如我们直接使用2017-05-20 00:29:10 - 2017-05-20 00:28:10，这样的相减是会报错的。而且也是无法相减的，因为他们两个是字符串，无法进行相减。那该怎么办？<br>很简单，我们将2017-05-20 00:29:10转换为Date对象即可。而JavaScript的Date对象得到的日期格式应该是这样的“Sat May 20 2017 00:33:26 GMT+0800”，我们可以通过new Date()对我们上面的字符串“2017-05-20 00:29:10”进行转换，但是转换之前必须将此字符串，转换为如下格式“2017/05/20 00:29:10”，这样的格式才能被JavaScript的Date()识别。<br>如此一来，他们就可以进行相减了。</p>
<a id="more"></a>
<h2 id="相减后获得的秒数该如何计算？"><a href="#相减后获得的秒数该如何计算？" class="headerlink" title="相减后获得的秒数该如何计算？"></a>相减后获得的秒数该如何计算？</h2><p>两个日期相减得到的是毫秒数，根据1000毫秒=1秒的计算方式，我们可以得到要将毫秒转换为秒，我们需要将当前的毫秒数除以(1000<em>60)再乘以60，由此可以得到公式（毫秒/(1000</em>60)*60就可以得到秒数）。</p>
<h2 id="在页面上实时显示秒数"><a href="#在页面上实时显示秒数" class="headerlink" title="在页面上实时显示秒数"></a>在页面上实时显示秒数</h2><p>这里就进入了我们今天的正题了，使用setTimeout定时器即可实现，其用法setTimeout(code,time)，其中code是即将执行的代码，time为执行的毫秒数。</p>
<h2 id="使内存溢出的setTimeout"><a href="#使内存溢出的setTimeout" class="headerlink" title="使内存溢出的setTimeout"></a>使内存溢出的setTimeout</h2><p>从上面的分析我们很容易就可以得出相关代码，代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myDate</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> localDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(localDate);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> include_date=(<span class="string">'2017-05-19 21:23:01'</span>).replace(<span class="regexp">/-/g</span>,<span class="string">"/"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> crawler_date = <span class="keyword">new</span> <span class="built_in">Date</span>(include_date);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> time_difference = <span class="built_in">Math</span>.ceil((localDate-crawler_date)/(<span class="number">1000</span>*<span class="number">60</span>)*<span class="number">60</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(time_difference);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"m"</span>).innerHTML = time_difference+<span class="string">'秒'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">setTimeout(myDate(),<span class="number">1000</span>);</span></pre></td></tr></table></figure>
<p>经过我的经验告诉我，执行了以上代码后，这些代码并不会定时的去执行myDate()，那么是上面原因导致了这个错误？是不是代码写错了，还是分析的不对？<br>最终我确定了，setTimeout(“myDate()”,1000);必须要放在函数内，才会生效，否则他将仅执行一次，而放在函数内就会根据我们设定的时间去执行相关方法。因此正确的代码应该是这样的</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myDate</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> localDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(localDate);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> include_date=(<span class="string">'2017-05-19 21:23:01'</span>).replace(<span class="regexp">/-/g</span>,<span class="string">"/"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> crawler_date = <span class="keyword">new</span> <span class="built_in">Date</span>(include_date);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> time_difference = <span class="built_in">Math</span>.ceil((localDate-crawler_date)/(<span class="number">1000</span>*<span class="number">60</span>)*<span class="number">60</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//return time_difference;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(time_difference);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"m"</span>).innerHTML = time_difference+<span class="string">'秒'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    setTimeout(myDate(),<span class="number">1000</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">myDate()</span></pre></td></tr></table></figure>
<p>但是我的天啊，这段代码竟然让我的内存溢出了，而且超级占内存，浏览器都会卡死！你可以通过console.log()来查看执行的效果，你应该会看到如下执行效果，你会发现我靠，每一秒都执行超级多的次数！</p>
<img src="/2019/12/07/%E4%BD%BF%E7%94%A8SETTIMEOUT%E5%87%BA%E7%8E%B0%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/20170520004850.jpg" class="" title="内存溢出">
<p>这是不是传说中浏览器傻逼了，还是JavaScript傻逼了？<br>我使用了clearTimeout也无法解决这个问题，在网上也没有查到相关解决方法。不过我看到一个实例，他的代码中是这样使用setTimeout的setTimeout(“code”,time);，看到了吧，在执行的代码外增加了双引号，这是什么鸟？为什么要这样使用？这个原因我也不得而知，但是这确实让我解决了内存溢出的问题。最终代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myDate</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> localDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//console.log(localDate);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> include_date=(<span class="string">'2017-05-19 21:23:01'</span>).replace(<span class="regexp">/-/g</span>,<span class="string">"/"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> crawler_date = <span class="keyword">new</span> <span class="built_in">Date</span>(include_date);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> time_difference = <span class="built_in">Math</span>.ceil((localDate-crawler_date)/(<span class="number">1000</span>*<span class="number">60</span>)*<span class="number">60</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//return time_difference;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(time_difference);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"m"</span>).innerHTML = time_difference+<span class="string">'秒'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    setTimeout(<span class="string">"myDate()"</span>,<span class="number">1000</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>执行后出现如下正常的浏览器反馈了：</p>
<img src="/2019/12/07/%E4%BD%BF%E7%94%A8SETTIMEOUT%E5%87%BA%E7%8E%B0%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/20170520005510.jpg" class="" title="内存溢出">
<p>到此我们确实可以说在原生JavaScript中，我们解决了这个内存溢出的问题，但是问题又来了，我再VUE中这样去使用setTimeout又出问题了。</p>
<h2 id="VUE中使用setTimeout"><a href="#VUE中使用setTimeout" class="headerlink" title="VUE中使用setTimeout"></a>VUE中使用setTimeout</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods:&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    myDate()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> localDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> include_date=(<span class="keyword">this</span>.data).replace(<span class="regexp">/-/g</span>,<span class="string">"/"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> crawler_date = <span class="keyword">new</span> <span class="built_in">Date</span>(include_date);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> time_difference = <span class="built_in">Math</span>.ceil((localDate-crawler_date)/(<span class="number">1000</span>*<span class="number">60</span>)*<span class="number">60</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//return time_difference;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.time = time_difference</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//console.log(time_difference);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(time_difference&gt;<span class="number">60</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">this</span>.style=<span class="string">'background-color:red;color:#FFF'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(time_difference&gt;<span class="number">0</span> &amp;&amp; time_difference&lt;<span class="number">60</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">this</span>.style=<span class="string">'background-color:blue;color:#FFF'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">this</span>.style=<span class="string">'color:#000'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      setTimeout(<span class="keyword">this</span>.myDate(),<span class="number">1000</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>如果你直接使用以上代码去执行那么我们又回到了之前的内存溢出的问题上了，如果你将setTimeout(this.myDate(),1000);修改为setTimeout(“this.myDate()”,1000);那么VUE肯定报错说找不到myDate()，或者myDate()并不是函数。我靠，这样一来该如何解决这个问题？<br>在折腾了一番之后，我得到了相关解决方法。<br>原来在VUE中，调用方法，如果方法中没有传递任何参数的话，我们直接使用函数的名称即可，无需增加“()”，由此就可以得到最终的代码了：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods:&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    myDate()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> localDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> include_date=(<span class="keyword">this</span>.data).replace(<span class="regexp">/-/g</span>,<span class="string">"/"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> crawler_date = <span class="keyword">new</span> <span class="built_in">Date</span>(include_date);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> time_difference = <span class="built_in">Math</span>.ceil((localDate-crawler_date)/(<span class="number">1000</span>*<span class="number">60</span>)*<span class="number">60</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//return time_difference;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.time = time_difference</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//console.log(time_difference);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span>(time_difference&gt;<span class="number">60</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.style=<span class="string">'background-color:red;color:#FFF'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(time_difference&gt;<span class="number">0</span> &amp;&amp; time_difference&lt;<span class="number">60</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.style=<span class="string">'background-color:blue;color:#FFF'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.style=<span class="string">'color:#000'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        setTimeout(<span class="keyword">this</span>.myDate,<span class="number">1000</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>看到setTimeout中内容的变化了吧！这样就能够真正实现定时器了！<br>setTimeout真是变化多端，我们得根据不同的环境进行不同的使用，才能实现我们想要的定时器效果。</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>settimeout</tag>
        <tag>vue</tag>
        <tag>内存溢出</tag>
      </tags>
  </entry>
  <entry>
    <title>使用EXPRESS+MYSQL实现分页效果</title>
    <url>/2019/12/07/%E4%BD%BF%E7%94%A8EXPRESS-MYSQL%E5%AE%9E%E7%8E%B0%E5%88%86%E9%A1%B5%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<p>在mysql中SQL语句有一个为limit的条件筛选，limit中如果只传递一个值，则表示获取的条数，如果传递两个值则表示从第几条记录到第几条，如下：<br>limit 10 //这里是需要从数据库读出10条数据<br>limit 2,10 //这里这是从数据库中第3条数据开始取10条数据</p>
<p>1、使用limit实现分页（此方法不推荐，因为看上去不那么高大上）<br>不推荐就是因为不高大上，无法显示你是程序猿，因此你可以了解下就可以了！</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> init_page=<span class="number">1</span>;<span class="comment">//默认页码为1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">10</span>;<span class="comment">//每页要显示的数据量</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//假如有传递进来的页码，比如2，那么当前的init_page的值则更改为传递进来的值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(req.query.page)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> init_page = <span class="built_in">parseInt</span>(req.query.page);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> start=<span class="number">0</span>;<span class="comment">//设置起始数据为第一条</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(init_page&gt;<span class="number">1</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> start = (init_page<span class="number">-1</span>)*num; <span class="comment">//页码减去1，乘以条数就得到分页的起始数了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sql=<span class="string">'select * from user limit'</span>+start+<span class="string">','</span>+num; <span class="comment">//这里就获得了第一页的10条数据</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<p>这样我们就可以准确的获取到相关的数据了，但是这种方法并不想我吗自己想象的那样高大上，因为这种方法大多是数据库管理人员使用的，如果你是一个队代码质量要求很高的程序猿，那么我推荐使用下面的代码，这种代码不仅能体现出你的逻辑思维，并且使用下面的方法，可以做出很完美的resetfull api。</p>
<p>2、使用limit结合offset<br>这两个参数结合使用，将会是非常完美的结合啊。所以你以后妈妈再也不用担心你的分页代码了。<br>完美先来看一个sql</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">limit</span> <span class="number">10</span> <span class="keyword">offset</span> <span class="number">0</span>;</span></pre></td></tr></table></figure>
<p>这段代码中limit是查询10条数据，offset 0这是设置从第1条开始，如果我们要从第十条开始，则是offset 9<br>有了offset，我们就能够更好的对数据进行分页啦，如此一来想要利用express+mysql制作一个可以分页，并且可以设置每页数据量的api，那就超级容易了。<br>下面完美就来实现一个resetfull api，地址如下user?page=1&amp;num=10（其中page就是分页的页码，num则是显示的条数）</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//搜索所有job并分页</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    select: <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        pool.getConnection(<span class="function"><span class="keyword">function</span>(<span class="params">err, connection</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">var</span> param = req.query || req.params;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//分页实现</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">var</span> current_page = <span class="number">1</span>; <span class="comment">//默认为1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">var</span> num = <span class="number">10</span>; <span class="comment">//每页条数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">if</span> (param.page) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            current_page = <span class="built_in">parseInt</span>(param.page);</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">if</span> (param.num) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            num = <span class="built_in">parseInt</span>(param.num);</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//设置最后一页页码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">var</span> last_page = current_page - <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//假如目前仅有一页，则最后一页则为1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">if</span> (current_page &lt;= <span class="number">1</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            last_page = <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//如果需要下一页，则开启</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//var next_page = current_page + 1;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">var</span> sql = <span class="string">'select * FROM users limit '</span>+num+<span class="string">' offset '</span>+ (current_page<span class="number">-1</span>)*num</span></pre></td></tr><tr><td class="code"><pre><span class="line">            connection.query(sql, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">              <span class="built_in">console</span>.log(result);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                jsonWrite(res, result);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 释放连接</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                connection.release();</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>node</tag>
        <tag>mysql</tag>
        <tag>express</tag>
        <tag>分页</tag>
      </tags>
  </entry>
  <entry>
    <title>IONIC2签名打包</title>
    <url>/2019/12/07/IONIC2%E7%AD%BE%E5%90%8D%E6%89%93%E5%8C%85/</url>
    <content><![CDATA[<p>利用ionic2制作好的app，我们得通过打包后才能发布出去，不然的话app是无法通过验证的。在打包过程中，我们就得需要java的keytool进行生成证书，然后通过生成的证书，我们再将其导入到我们得app里面来实现一个签名。</p>
<h2 id="进入ionic项目根目录"><a href="#进入ionic项目根目录" class="headerlink" title="进入ionic项目根目录"></a>进入ionic项目根目录</h2><p>比如我的是h:/Ionic/flashlight<br>cd h:/Ionic/flashlight<br>使用keytool生成证书</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">keytool -genkey -v -keystore key.keystore -alias you_name -keyalg RSA -keysize 2048 -validity 10000</span></pre></td></tr></table></figure>
<p>首先会让你输入密码，如果你使用过linux或者mac的话，你就会知道，这里输入密码是不可见的（菜鸟们不要以为这是bug）。<br>其中key.keystore是证书的名称和后缀名，key则可以修改成你需要的名称，而后缀名不能随意更改，否则会出错。<br>you_name则为证书拥有者的名称，你可以自己起一个。</p>
<p>如果可以出现什么问题的话，你可以看到如下的设置：</p>
<img src="/2019/12/07/IONIC2%E7%AD%BE%E5%90%8D%E6%89%93%E5%8C%85/20170528172650.jpg" class="" title="java签名">
<a id="more"></a>
<p>这些设置，自己随便乱填下吧！感觉没有什么用处<br>现在你就可以在根目录下看见一个key.keystore的证书了。有了这个证书，那么我们现在可以开始打包app了。</p>
<h2 id="打包app"><a href="#打包app" class="headerlink" title="打包app"></a>打包app</h2><p>使用以下命令生成apk文件到platforms/android/build/outputs/apk<br>这里我们生成的apk的名称是android-release-unsigned.apk（自动默认的名称）</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ionic build android --release --prod --device</span></pre></td></tr></table></figure>
<h2 id="为apk签名"><a href="#为apk签名" class="headerlink" title="为apk签名"></a>为apk签名</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore H:/Ionic/flashlight/platforms/android/build/outputs/apk/android-release-unsigned.apk you_name</span></pre></td></tr></table></figure>
<p>命令执行后会让你输入你之前设置的密码<br>注意：apk路径请使用绝对路径，这样就不会发生任何错误了，看到you_name了吗？请修改成你证书的用户名。<br>如果不出什么状况的话，你会看到如下图：</p>
<img src="/2019/12/07/IONIC2%E7%AD%BE%E5%90%8D%E6%89%93%E5%8C%85/20170528173754.jpg" class="" title="签名成功">
<p>到此，apk签名完成了。</p>
<h2 id="apk优化"><a href="#apk优化" class="headerlink" title="apk优化"></a>apk优化</h2><p>不过根据android官方所说，我们还得对此apk进行优化，优化则是使用Android SDK中zipalign进行优化。这个应用可以在Android SDK目录下找到，比如我的目录如下（在build-tools目录下，随便打开一个文件夹即可看到zipalign）：</p>
<img src="/2019/12/07/IONIC2%E7%AD%BE%E5%90%8D%E6%89%93%E5%8C%85/20170528174125.jpg" class="" title="zipalign压缩">
<p>因此，我们需要cd到当前的zipalign目录，来执行相关命令。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd E:\Android\sdk\build-tools\22.0.1</span></pre></td></tr></table></figure>
<p>再次输入如下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">zipalign -v 4 H:/Ionic/flashlight/platforms/android/build/outputs/apk/android-release-unsigned.apk flashlight.apk</span></pre></td></tr></table></figure>
<p>你会看到有两个apk名称的文件，第一个apk文件是你要优化的apk目录（必须绝对路径），第二个则是优化后生成的apk文件，这里我直接放到当前目录，因此没有填写路径，你可以尝试自己添加其他路径。<br>到此APK打包和优化，终于完工了！</p>
]]></content>
  </entry>
  <entry>
    <title>Angular2或4获取CHECKBOX的值</title>
    <url>/2019/12/07/Angular2%E6%88%964%E8%8E%B7%E5%8F%96CHECKBOX%E7%9A%84%E5%80%BC/</url>
    <content><![CDATA[<p>在一个项目中需要使用到这个功能，看了下官方的文档，说得不是很清楚，使用了formArray，但是没有实现成功。然后谷歌、百度了好久，也没有找到可以真正运行的代码，差点就放弃了。功夫不负有心人，在segmentfault上提问后，得到了相关回答，但是回答中得到了一个外国人博客上的文章，对照着改写了一番，感觉真的就这么实现了，真好，实现得和自己想要的最终结果一模一样。下面就来说说如何进行实现吧！<br>首先说下实现的逻辑思路，通过FormBuilder, FormGroup, FormArray来获取checkbox的选中状态，然后通过这些选中状态再去获得checkbox的值，再将想要的值展示出来即可。<br>1、导入相关功能模块</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormBuilder, FormGroup, FormArray &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'rxjs/add/operator/map'</span>;</span></pre></td></tr></table></figure>
<p>2、创建checkbox数据源</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> select = [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"leo"</span>,<span class="string">"selected"</span>:<span class="literal">true</span>,<span class="string">"sex"</span>:<span class="string">"男"</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"Lily"</span>,<span class="string">"selected"</span>:<span class="literal">false</span>,<span class="string">"sex"</span>:<span class="string">"女"</span>&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"Tony"</span>,<span class="string">"selected"</span>:<span class="literal">false</span>,<span class="string">"sex"</span>:<span class="string">"男"</span>&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">]</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>3、命名一个formgrounp，并在constructor中初始化其相关数据</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> form:FormGroup;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> fb: FormBuilder</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.form = <span class="keyword">this</span>.fb.group(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        _selected: <span class="keyword">this</span>.bulidSelected()</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>4、创建获取选中的状态数据</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">bulidSelected() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = <span class="keyword">this</span>.select.map(<span class="function"><span class="params">s</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.fb.control(s.selected);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.fb.array(arr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>5、提交表单后获得重组的数据</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">onSubmit(v) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> val = <span class="built_in">Object</span>.assign(&#123;&#125;, v, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    value: v._selected.map(<span class="function">(<span class="params">status, i</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//console.log([status]);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        name: <span class="keyword">this</span>.select[i].name,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        sex: <span class="keyword">this</span>.select[i].sex,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        selected:status</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(val);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>6、模板文件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"form"</span> (<span class="attr">ngSubmit</span>)=<span class="string">"onSubmit(form.value)"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let s of _selected.controls;let i = index"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> [<span class="attr">formControl</span>]=<span class="string">"s"</span>&gt;</span>&#123;&#123;select[i].name&#125;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交看console"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;&#123;form.value|json&#125;&#125;</span></pre></td></tr></table></figure>
<img src="/2019/12/07/Angular2%E6%88%964%E8%8E%B7%E5%8F%96CHECKBOX%E7%9A%84%E5%80%BC/GIF.gif" class="" title="angular 获取 checkbox">]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>checkbox</tag>
      </tags>
  </entry>
  <entry>
    <title>Angular2中如何制作如同input的清空功能</title>
    <url>/2019/12/07/Angular2%E4%B8%AD%E5%A6%82%E4%BD%95%E5%88%B6%E4%BD%9C%E5%A6%82%E5%90%8Cinput%E7%9A%84%E6%B8%85%E7%A9%BA%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<p>使用过jQuery的童鞋，想要制作一个清空input内容的图标按钮是非常简单的事情，但是今天我要来说下angular2+版本中制作如此一个功能，远远比jQuery简单得多。而且是超级简单，根本不用写typescript代码，仅在html模板中就可以直接实现，当然我们也可以通过typescript的代码来进行实现，大同小异啊！<br>先来看实现后的大致功能效果，如下图：</p>
<img src="/2019/12/07/Angular2%E4%B8%AD%E5%A6%82%E4%BD%95%E5%88%B6%E4%BD%9C%E5%A6%82%E5%90%8Cinput%E7%9A%84%E6%B8%85%E7%A9%BA%E5%8A%9F%E8%83%BD/20170622215827.jpg" class="" title="input清空">
<p>要制作这么一个功能，使用angular制作其实并不困难，不过要在css中下功夫，而js逻辑是很简单的事情，并且angular中实现并无需写js逻辑。<br>关于css部分，请自行进行编写，这里我只实现功能，css部分实现的思想也很简单，利用position定位来对按钮或者图标进行定位到input的右边即可实现。</p>
<h2 id="angular直接在模板中实现清空input的方法。"><a href="#angular直接在模板中实现清空input的方法。" class="headerlink" title="angular直接在模板中实现清空input的方法。"></a>angular直接在模板中实现清空input的方法。</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>清空input<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   </span></pre></td></tr><tr><td class="code"><pre><span class="line">    用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> #<span class="attr">name</span> <span class="attr">placeholder</span>=<span class="string">"输入用户名"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> (<span class="attr">click</span>)=<span class="string">"name.value=''"</span>&gt;</span>X<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    密&amp;nbsp;&amp;nbsp;&amp;nbsp;码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span> #<span class="attr">pwd</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> (<span class="attr">click</span>)=<span class="string">"pwd.value=''"</span>&gt;</span>X<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<p>以上代码中就已经完全实现了这个清空的方法，大家可以在angular中运行试试，并且无需写js代码。很简单的就实现了，这就是angular强大的事件驱动。</p>
<h2 id="使用angular的typescript来进行实现"><a href="#使用angular的typescript来进行实现" class="headerlink" title="使用angular的typescript来进行实现"></a>使用angular的typescript来进行实现</h2><p>其中我们要使用到ViewChild和ElementRef来进行操作，ViewChild使用很方便，就像Java中的注解一样方便。</p>
<h3 id="首先导入相关功能模块"><a href="#首先导入相关功能模块" class="headerlink" title="首先导入相关功能模块"></a>首先导入相关功能模块</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, ViewChild, ElementRef &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span></pre></td></tr></table></figure>
<h3 id="模板文件"><a href="#模板文件" class="headerlink" title="模板文件"></a>模板文件</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>清空input<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> #<span class="attr">name</span> <span class="attr">placeholder</span>=<span class="string">"输入用户名"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> (<span class="attr">click</span>)=<span class="string">"clear_name()"</span>&gt;</span>X<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    密&amp;nbsp;&amp;nbsp;&amp;nbsp;码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span> #<span class="attr">pwd</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> (<span class="attr">click</span>)=<span class="string">"clear_pwd()"</span>&gt;</span>X<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>
<h3 id="获取相关以-绑定的input"><a href="#获取相关以-绑定的input" class="headerlink" title="获取相关以#绑定的input"></a>获取相关以#绑定的input</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ViewChild</span>(<span class="string">'name'</span>) name:ElementRef</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@ViewChild</span>(<span class="string">'pwd'</span>) pwd:ElementRef</span></pre></td></tr></table></figure>
<h3 id="编写相关click事件的清空方法"><a href="#编写相关click事件的清空方法" class="headerlink" title="编写相关click事件的清空方法"></a>编写相关click事件的清空方法</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">clear_name()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.name.nativeElement.value = <span class="string">''</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">clear_pwd()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.pwd.nativeElement.value = <span class="string">''</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>怎么样？这两个方法中一眼就可以看出来，第一种方法是最简单的，不过第二种方法可以为我们提供更多的使用场景。总体来说，angularJS是非常不错的事件驱动JS库。下面是我实现后的效果，大家可以看一看！</p>
<img src="/2019/12/07/Angular2%E4%B8%AD%E5%A6%82%E4%BD%95%E5%88%B6%E4%BD%9C%E5%A6%82%E5%90%8Cinput%E7%9A%84%E6%B8%85%E7%A9%BA%E5%8A%9F%E8%83%BD/GIF-input.gif" class="" title="angular input清空按钮">]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>input</tag>
        <tag>清空</tag>
      </tags>
  </entry>
  <entry>
    <title>ANGULAR2+使用IFRAME展示外链提示UNSAFE VALUE USED IN A RESOURCE URL CONTEXT解决方法</title>
    <url>/2019/12/07/ANGULAR2-%E4%BD%BF%E7%94%A8IFRAME%E5%B1%95%E7%A4%BA%E5%A4%96%E9%93%BE%E6%8F%90%E7%A4%BA%E9%94%99%E8%AF%AF/</url>
    <content><![CDATA[<p>iframe在web项目中确实很少使用，但是在手机app中，很多人可能会使用到今天我在使用的过程中就出现了错误unsafe value used in a resource URL context，这个错误后面还跟了一个短网址，打开后就跳转到了angular.io的官方网站去了，大概是到了这里：<br><a href="https://angular.io/guide/security#xss" target="_blank" rel="noopener">https://angular.io/guide/security#xss</a><br>如果你英文水平不错，应该看看这个页面就会解决了吧！如果你懒得去官方研究那些难懂的英文，那么久跟着我一起来处理吧！</p>
<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>比如说注册页面，需要用户同意相关法律法规以及注册条款等，因此就需要将相关的条款展示出来，一般的做法就是后端给出json数据或者其他类型的数据，让前端去调用。但是如果是一个简单的页面，那就没有必要进行数据库存储的话，那就直接在iframe中嵌入这个外部的url即可。</p>
<h2 id="使用过程"><a href="#使用过程" class="headerlink" title="使用过程"></a>使用过程</h2><p>如果不在ts中写url，直接在iframe的src中写url，我完全没有问题的，并且不会提示任何错误。但是由于之前我写了一个config.ts将所有的配置都放到了里面，包括url，因此我只能通过下面的方法进行实现！=<br>一般人会这样去使用url</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ......</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> thisUrl = <span class="string">"http://www.yousite.com"</span>;</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>html模板中这样使用</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;thisUrl&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> [<span class="attr">src</span>]=<span class="string">"thisUrl"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></pre></td></tr></table></figure>
<p>不过如此的逻辑并没有什么问题，但是angular依然提示了错误，最主要的原因是因为angular的安全机制阻止了这个外部的url，因此需要使用官方提供的一个安全方法Sanitization（我觉得应该是消毒或者杀毒之类的意思吧）。</p>
<h2 id="使用DomSanitizer"><a href="#使用DomSanitizer" class="headerlink" title="使用DomSanitizer"></a>使用DomSanitizer</h2><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//先导入功能模块DomSanitizer</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; DomSanitizer &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//在constructor中定义一个DomSanitizer</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> sanitizer:DomSanitizer</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//在这里对url进行处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.url = <span class="keyword">this</span>.sanitizer.bypassSecurityTrustResourceUrl(<span class="string">'http://www.yousite.com'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>iframe</tag>
      </tags>
  </entry>
  <entry>
    <title>ANGULAR2如何获得多个相同子组件传递的集合</title>
    <url>/2019/12/07/ANGULAR2%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97%E5%A4%9A%E4%B8%AA%E7%9B%B8%E5%90%8C%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E7%9A%84%E9%9B%86%E5%90%88/</url>
    <content><![CDATA[<p>比如我有一个父组件，而在父组件中有多个相同的组件，比如父组件使用了ngFor循环，而在ngFor下面有一个子组件，这样当循环出来后就有很多个子组件了。那么我们要如何才能获得这几个子组件中的相应数据集合呢？之前我到segmentfault进行了提问，但是并没有人为我回答，终于在对官方文档阅读以及google了很多后，终于找到答案了。下面就让我们去解开angular2的面纱吧。<br>在angular中，我们需要从相同子组件中获取相关字段，我们可以直接使用@ViewChildren，如果你E文较好，那么我们把这个单词拆开来理解@ViewChildren，View Children，view是视图或者显示，children则是孩子或者子类，简单的说就是获取子组件的相关集合。<br>在实例中显示如下图：</p>
<img src="/2019/12/07/ANGULAR2%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97%E5%A4%9A%E4%B8%AA%E7%9B%B8%E5%90%8C%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E7%9A%84%E9%9B%86%E5%90%88/20170416180950.jpg" class="" title="angular父子组件">
<p>首先我们直接点击“点此获得点“赞”的数据集合”即可显示相关数据。<br>另外我们可以通过点击每一个电影下面的+号来查看所获得的数据。<br>相关源码：<br>子组件ViewChildrenCom.ts</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, Input &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">selector: <span class="string">'vc'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">templateUrl: <span class="string">'./ViewChildrenCom.html'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">styleUrls: [<span class="string">'./ViewChildrenCom.css'</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> iViewChildren &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">count=<span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"></span>)&#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">addCount()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.count++</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>ViewChildrenCom.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"r"</span>&gt;</span>赞 &#123;&#123;count&#125;&#125; 次<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"i"</span> (<span class="attr">click</span>)=<span class="string">"addCount()"</span>&gt;</span>+<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr></table></figure>
<p>ViewChildrenCom.css</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.l</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.r</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: right;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#4169e1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">4px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-bottom-right-radius</span>: <span class="number">4px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.i</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: right;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#a52a2a</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">4px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-bottom-left-radius</span>: <span class="number">4px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>下面我们来看父组件的相关代码<br>ViewChildren.ts</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, QueryList, ViewChildren &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Http&#125; <span class="keyword">from</span> <span class="string">'@angular/http'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;iViewChildren&#125; <span class="keyword">from</span> <span class="string">'../ViewChildrenCom/ViewChildrenCom'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  selector: <span class="string">'ViewChildren'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  templateUrl: <span class="string">'./ViewChildren.html'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  styleUrls: [<span class="string">'./ViewChildren.css'</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> MyViewChildren &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  title = <span class="string">'@ViewChildren获取子组件传递的数据集合'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  url = <span class="string">'assets/data.json'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  data = <span class="string">''</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  count:<span class="built_in">any</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> http:Http</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    http.get(<span class="keyword">this</span>.url).subscribe(<span class="function"><span class="params">res</span>=&gt;</span> <span class="keyword">this</span>.data = res.json());</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//获得count组件的数字集合</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="meta">@ViewChildren</span>(iViewChildren) listCount: QueryList&lt;iViewChildren&gt;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  getCount()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.count = <span class="keyword">this</span>.listCount.toArray();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.count);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// alert('目前获得的内容：'+this.count+' 可以直接查看浏览器调试中获得的这几条数据');</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.count</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>ViewChildren.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#123;&#123;title&#125;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"myTest"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> (<span class="attr">click</span>)=<span class="string">"getCount()"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"bt"</span>&gt;</span>点此获得点“赞”的数据集合<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ct"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngFor</span>=<span class="string">"let c of count"</span>&gt;</span> &#123;&#123;c.count&#125;&#125; ,<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"movie-list clearfix"</span> *<span class="attr">ngFor</span>=<span class="string">"let m of data"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"image"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> [<span class="attr">src</span>]=<span class="string">"m.image"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>&#123;&#123;m.name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"start"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"l"</span>&gt;</span>&#123;&#123;m.start&#125;&#125;分<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">vc</span>&gt;</span><span class="tag">&lt;/<span class="name">vc</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>
<p>ViewChildren.css</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">clear</span>: both;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">overflow</span>: hidden;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">80%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.inner</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding-top</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.inner</span> <span class="selector-class">.bt</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#00008b</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">3px</span> <span class="number">6px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.inner</span> <span class="selector-class">.ct</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#a52a2a</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">120px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#eee</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span><span class="selector-pseudo">:hover</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">10px</span> <span class="number">#333</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> <span class="selector-class">.image</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> <span class="selector-class">.image</span>&gt;<span class="selector-tag">img</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">120px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">height</span>: <span class="number">160px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> <span class="selector-class">.name</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> <span class="selector-class">.start</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">display</span>: block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">text-align</span>: center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> <span class="selector-class">.name</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> <span class="number">#ddd</span> solid;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myTest</span> <span class="selector-class">.movie-list</span> <span class="selector-class">.start</span> <span class="selector-class">.l</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>angular</tag>
        <tag>组件</tag>
      </tags>
  </entry>
  <entry>
    <title>NODE+EXPRESS+MONGODB注册登录实例</title>
    <url>/2019/12/07/NODE-EXPRESS-MONGODB%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/</url>
    <content><![CDATA[<p>如果你之前对mysql以及Oracle等关系数据库有过了解的话，那么你mongodb对于你来说上手应该是很快的。但是mongodb并不是使用诸如mysql与Oracle中的select、delete、update等关键字进行SQL查询的，因为具mongodb官方介绍说，mongodb是一个nosql的数据库，也就是说，他不需要你对sql语句有一定的了解，但是如果你已经了解了sql语句，那么我相信你学习起来是很快的。<br>网上已经很多这方面的教程了，为什么我还要在写一次？<br>主要是因为我在参照网上的相关例子的时候遇到了不少问题，有些例子要么是express版本低，要么就是代码不完整，因此我才打算写这一篇文章来与大家分享下学习心得。本文仅作为express+mongodb入门教程。使用的express版本为~4.15.2，</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>看到标题就知道应该需要安装些什么软件了吧，我们需要在电脑上安装nodejs和mongodb，而express是nodejs的一个插件，因此需要通过nodejs来进行安装。<br>nodejs与mongodb的安装非常的简单，只要你会安装QQ，会安装游戏，那么你就会安装nodejs和mongodb了。不过我们需要注意的是，mongodb安装后，我们需要对其进行相应的设置，以提高我们的开发效率。关于mongodb的使用方法，请大家查看官方的文档。<br>安装好了mongodb后，我们给mongodb的bin目录添加到环境变量里面，这样我们就可以直接在命令提示符中直接使用mongodb的命令了，省的还要跑到mongodb目录下输命令。下面是设置mongodb的环境变量的方法。</p>
<h3 id="mongodb添加环境变量"><a href="#mongodb添加环境变量" class="headerlink" title="mongodb添加环境变量"></a>mongodb添加环境变量</h3><p>在桌面上，我的电脑（计算机或者此电脑）右键，点击属性，选择左边的“高级系统设置”，在弹出窗口中，选择“高级”，看到右下角有个“环境变量”，点击它。<br>之后我们在“系统变量”（不是Administrator的用户变量）中Path中将mongodb的bin目录填写进去，比如我的bin目录是C:\Program Files\MongoDB\Server\3.4\bin。<br>然后，打开你的命令提示符窗口，输入mongo,如果看到下面的信息，说明你的设置已经成功了。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">C:\Users\Administrator&gt;mongo</span></pre></td></tr><tr><td class="code"><pre><span class="line">MongoDB shell version v3.4.3</span></pre></td></tr><tr><td class="code"><pre><span class="line">connecting to: mongodb://127.0.0.1:27017</span></pre></td></tr><tr><td class="code"><pre><span class="line">MongoDB server version: 3.4.3</span></pre></td></tr><tr><td class="code"><pre><span class="line">Server has startup warnings:</span></pre></td></tr><tr><td class="code"><pre><span class="line">2017-04-19T13:51:47.704+0800 I CONTROL  [initandlisten]</span></pre></td></tr><tr><td class="code"><pre><span class="line">2017-04-19T13:51:47.704+0800 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.</span></pre></td></tr><tr><td class="code"><pre><span class="line">2017-04-19T13:51:47.705+0800 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.</span></pre></td></tr><tr><td class="code"><pre><span class="line">2017-04-19T13:51:47.705+0800 I CONTROL  [initandlisten]</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>2、在nodejs中安装express<br>打开nodejs的命令窗口，输入以下命令进行express全局安装<br>npm install -g express<br>OK，安装会有些慢，如果觉得很慢，请使用taobao的node镜像。完成后，我们就来创建一个express项目吧<br>直接使用命令<br>express test –view=ejs<br>//test就是项目的名称及目录，–ejs则是使用ejs模板引擎，如果不使用–ejs，默认就是jade模板引擎。<br>在这里我使用ejs模板引擎，因为它跟html一样，易看易懂，如果你之前使用过asp、jsp的话，那么你一看就懂了，根本不需要再进行多余的学习，如果没有用过，那还是学习下的好，不过这个模板引擎也是非常简单易学的，大部分懂js的或懂一点后端的应该看一下就会了吧。<br>项目创建完成，我们需要安装相关的依赖包了<br>cd test &amp; npm install<br>现在我们已经创建好了test项目了，我们看看项目的目录<br>–bin //这个是express服务端的配置文件<br>–node_modules //一些依赖的库<br>–public //静态文件目录（css、js、images等）<br>–views //ejs模板文件（视图）<br>–app.js //express配置文件<br>–package.json //项目信息及依赖库的json信息<br>到此，项目创建完成了。下面我们需要与mongodb进行相关的链接，那就必须得安装一个mongoose的依赖库，直接使用命令<br>npm install mongoose –save<br>这样就安装成功了。下面我们正式进入express+mongoose+mongodb的数据库操作吧。</p>
<p>重要部分来了：由于express与nodejs一起使用，无法实现热加载（所谓热加载就是无需重启node来刷新页面），因此我们需要另一个插件hotnode，使用hotnode可以让我们更好的调试代码与测试代码。hotnode可以全局安装，也可以依赖安装，我这里使用全局安装，使用</p>
<figure class="highlight plain"><figcaption><span>install -g hotnode```</span></figcaption><table><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">## express+mongodb+mongoose链接数据库</span></pre></td></tr><tr><td class="code"><pre><span class="line">### 使用mongodb创建一个数据库</span></pre></td></tr><tr><td class="code"><pre><span class="line">首先在命令提示符中输入如下命令来指定数据库存储的文件夹</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#96;&#96;&#96;mongod --dbpath H:\DB</span></pre></td></tr></table></figure>
<p>这个H:\DB，你自己设置成你想要的目录即可<br>设置好了以后，我们需要再开启一个命令提示符窗口，直接使用mongo命令就可以看到已经链接上了本地上的db目录了。<br>下面我们就来创建一个数据库，使用use命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use test &#x2F;&#x2F;如果数据库不存在则会自动创建一个名为test的数据库</span></pre></td></tr></table></figure>
<p>我们再创建一个数据库表为user,并且添加一个admin用户</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">查看数据库信息，请使用find</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#96;&#96;&#96;db.user.find()</span></pre></td></tr></table></figure>
<p>是不是很简单啊。<br>至此，我们需要将以上mogodb的两个窗口都保留，这样才能保证我们后面的步骤。关闭后则数据库连接就断了。当然你也可以将其注册成为windows的一个服务，相关命令请自行google.</p>
<h3 id="连接到test数据库"><a href="#连接到test数据库" class="headerlink" title="连接到test数据库"></a>连接到test数据库</h3><p>打开app.js<br>添加如下代码测试数据库链接是否成功：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*引入mongoose链接数据库*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">mongoose.connect(<span class="string">'mongodb://localhost/one'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> db = mongoose.connection;</span></pre></td></tr><tr><td class="code"><pre><span class="line">db.on(<span class="string">'error'</span>, <span class="built_in">console</span>.error.bind(<span class="built_in">console</span>, <span class="string">'connection error:'</span>));</span></pre></td></tr><tr><td class="code"><pre><span class="line">db.once(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'链接成功了'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>
<p>现在我们就可以测试下数据库连接是否成功了。使用hotnode的命令启动服务</p>
<figure class="highlight plain"><figcaption><span>./bin/www```</span></figcaption><table><tr><td class="code"><pre><span class="line">当在命令提示符中看到“连接成功了”，那么就说明了我们已经链接了数据库了。</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">## 使用bootstrap与express的router创建登录与注册</span></pre></td></tr><tr><td class="code"><pre><span class="line">首先下载bootstrap3与jQuery，将css文件放到public&#x2F;stylesheets目录下，将js文件及jQuery文件放到javascripts目录下，另外bootstrap是需要自提支持的，因此直接将bootstrap的fonts目录直接拷贝到public目录下即可。</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">### 修改views目录下index.ejs文件</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#96;&#96;&#96;html</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;% include header.ejs %&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;div class&#x3D;&quot;index&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;div class&#x3D;&quot;container&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;h1&gt;&lt;%&#x3D; title %&gt;&lt;&#x2F;h1&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;form name&#x3D;&quot;form&quot; action&#x3D;&quot;&#x2F;home&quot; method&#x3D;&quot;post&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;div class&#x3D;&quot;input-group&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &lt;span class&#x3D;&quot;input-group-addon&quot; id&#x3D;&quot;sizing-addon1&quot;&gt;USERNAME&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;name&quot; class&#x3D;&quot;form-control&quot; placeholder&#x3D;&quot;用户名&quot; aria-describedby&#x3D;&quot;sizing-addon1&quot; id&#x3D;&quot;name&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;div class&#x3D;&quot;input-group&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &lt;span class&#x3D;&quot;input-group-addon&quot; id&#x3D;&quot;sizing-addon2&quot;&gt;PASSWORD&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &lt;input type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot; class&#x3D;&quot;form-control&quot; placeholder&#x3D;&quot;密码&quot; aria-describedby&#x3D;&quot;sizing-addon2&quot; id&#x3D;&quot;password&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &lt;a href&#x3D;&quot;&#x2F;register&quot; class&#x3D;&quot;btn btn-warning reg&quot;&gt;注册&lt;&#x2F;a&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &lt;input name&#x3D;&quot;submit&quot; type&#x3D;&quot;submit&quot; class&#x3D;&quot;btn btn-primary login&quot; value&#x3D;&quot;登录&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;&#x2F;form&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;% include footer.ejs %&gt;</span></pre></td></tr></table></figure>
<p>看到了吧，如果你懂jsp，那么你就能看懂上面的代码了，很简单的，当然懂JavaScript也能很容易看懂以上代码，只不过代码中的include可能就不太了解了，include是引入一个文件，然后我们来建立header.ejs和footer.ejs，让他们两个文件可以进行重用</p>
<h3 id="header-ejs文件内容"><a href="#header-ejs文件内容" class="headerlink" title="header.ejs文件内容"></a>header.ejs文件内容</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">title</span> %&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">'stylesheet'</span> <span class="attr">href</span>=<span class="string">'/stylesheets/bootstrap.min.css'</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">'stylesheet'</span> <span class="attr">href</span>=<span class="string">'/stylesheets/style.css'</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure>
<h3 id="footer-ejs"><a href="#footer-ejs" class="headerlink" title="footer.ejs"></a>footer.ejs</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/javascripts/jquery-3.2.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/javascripts/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>
<h3 id="修改routers-index-js"><a href="#修改routers-index-js" class="headerlink" title="修改routers/index.js"></a>修改routers/index.js</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> router = express.Router();</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* GET home page. */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    res.render(<span class="string">'index'</span>, &#123; <span class="attr">title</span>: <span class="string">'后台登录'</span> &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = router;</span></pre></td></tr></table></figure>
<p>路由为我们创建了第一个页面，并传递一个title参数。</p>
<h3 id="修改public-stylesheets-style-css"><a href="#修改public-stylesheets-style-css" class="headerlink" title="修改public/stylesheets/style.css"></a>修改public/stylesheets/style.css</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.index</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">80%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">position</span>: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%, -50%);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.index</span> <span class="selector-tag">h1</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">text-align</span>: center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> <span class="number">#eee</span> solid;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.index</span> <span class="selector-class">.container</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">#ccc</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.index</span> <span class="selector-class">.container</span> <span class="selector-class">.input-group</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.index</span> <span class="selector-class">.container</span> <span class="selector-class">.login</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: right;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.index</span> <span class="selector-class">.container</span> <span class="selector-class">.reg</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">float</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>OK，现在我们可以看看浏览器中所显示的状况了，如果你没有操作错误的话，你应该看到如下图一样的效果：</p>
<img src="/2019/12/07/NODE-EXPRESS-MONGODB%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/20170419224806.png" class="" title="登录页面">
<p>6、新建user.js<br>在test目录下创建一个model文件夹，并新建一个user.js的文件，内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * Created by tony on 2017/4/18.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="built_in">String</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    password: <span class="built_in">String</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">'user'</span>, UserSchema,<span class="string">'user'</span>);</span></pre></td></tr></table></figure>
<p>以上代码主要是创建一个数据模型对应于数据库内容，这个数据库模型就相当于java中的javabeans。我们需要注意的是最后一行，mongoose.model(‘user’, UserSchema,’user’)，这里面的最后一个参数’user’就是我们创建的test数据库下面的user表的名称。如果不填写这个参数，后面我们可能将无法获取到user中的数据，当然后面你也可以直接使用for循环来循环，但是如果数据量太大，我相信for肯定不会那么好使了。<br>下面是非常重要的两个步骤，我都对代码进行了注释，大家一定要好好看。</p>
<p>7、编写注册页面（注册的密码通过MD5加密）<br>在views下新建register.ejs</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">include</span> <span class="attr">header.ejs</span> %&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"index"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">title</span> %&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form"</span> <span class="attr">action</span>=<span class="string">"/register_suc"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span> <span class="attr">id</span>=<span class="string">"sizing-addon1"</span>&gt;</span>USERNAME<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"用户名"</span> <span class="attr">aria-describedby</span>=<span class="string">"sizing-addon1"</span> <span class="attr">id</span>=<span class="string">"name"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span> <span class="attr">id</span>=<span class="string">"sizing-addon2"</span>&gt;</span>PASSWORD<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"密码"</span> <span class="attr">aria-describedby</span>=<span class="string">"sizing-addon2"</span> <span class="attr">id</span>=<span class="string">"password"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary login"</span> <span class="attr">value</span>=<span class="string">"注册"</span> &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">include</span> <span class="attr">footer.ejs</span> %&gt;</span></span></pre></td></tr></table></figure>
<p>然后在routers下建立register.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> router = express.Router();</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* GET home page. */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    res.render(<span class="string">'register'</span>, &#123; <span class="attr">title</span>: <span class="string">'用户注册'</span> &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = router;</span></pre></td></tr></table></figure>
<p>我们已经完成了注册页面了，下面就是与数据库对接了。<br>在routers目录下新建register_suc.js<br>register_suc.ejs</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> router = express.Router();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> user = <span class="built_in">require</span>(<span class="string">'../model/user'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/*导入node的加密库*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* GET home page. */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> md5 = crypto.createHash(<span class="string">'md5'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> name = req.body.name;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> password = req.body.password;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(name===<span class="string">''</span> &amp;&amp; name.length&lt;=<span class="number">0</span> &amp;&amp; password===<span class="string">''</span> &amp;&amp; password.length&lt;=<span class="number">0</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.render(<span class="string">'register_suc.ejs'</span>, &#123;<span class="attr">title</span>: <span class="string">'用户名或密码不能为空'</span>, <span class="attr">name</span>: <span class="string">''</span>, <span class="attr">password</span>: <span class="string">''</span>&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">/*MD5加密密码*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        md5.update(password + name);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> pwd = md5.digest(<span class="string">'base64'</span>);<span class="comment">//将加密后的md5密码使用base64加密</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//使用findOne查询数据库中是否存在相同的用户名，如果存在则提示更换用户名，否则将内容写入数据库</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        user.findOne(&#123;<span class="attr">name</span>: name&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, doc</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">//查询数据库是否有相同的用户名，假如存在则提示注册失败</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span> (doc) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                res.render(<span class="string">'register_suc.ejs'</span>, &#123;<span class="attr">title</span>: <span class="string">'用户名已经存在，请更换'</span>, <span class="attr">name</span>: <span class="string">''</span>, <span class="attr">password</span>: <span class="string">''</span>&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">/*var usernow =new user(&#123;name:name,password:pwd&#125;);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">                 //如果用户名不存在，则将当前用户名和密码保存到数据库</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">                 usernow.save();</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">                 res.render('register_suc.ejs', &#123; title: '注册成功',name:name,password:pwd &#125;);*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                user.create(&#123; <span class="comment">// 创建一组user对象置入model</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    name: name,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    password: pwd</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, doc</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="keyword">if</span> (err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        res.send(<span class="number">500</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        <span class="built_in">console</span>.log(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        res.render(<span class="string">'register_suc.ejs'</span>, &#123;<span class="attr">title</span>: <span class="string">'注册成功'</span>, <span class="attr">name</span>: name, <span class="attr">password</span>: pwd&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">                        <span class="comment">//res.send(200);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = router;</span></pre></td></tr></table></figure>
<p>在views目录下新建一个register_suc.ejs</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">include</span> <span class="attr">header.ejs</span> %&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"index"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">title</span> %&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">%if(name!=''</span> &amp;&amp; <span class="attr">password</span> != <span class="string">''</span>)&#123;%&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        用户名：<span class="tag">&lt;<span class="name">%=name%</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">%=password%</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">%&#125;%</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">include</span> <span class="attr">footer.ejs</span> %&gt;</span></span></pre></td></tr></table></figure>
<p>到这里还没有完哦，我们建立了router后，必须要在app.js中加入router，否则将无法实现router功能，打开app.js，增加以下内容<br>var register = require(‘./routes/register’);<br>var register_suc = require(‘./routes/register_suc’);<br>app.use(‘/register’, register);<br>app.use(‘/register_suc’, register_suc);<br>OK，现在我们就可以看看效果了，<a href="http://localhost:3000/register，可以看到如下画面" target="_blank" rel="noopener">http://localhost:3000/register，可以看到如下画面</a></p>
<img src="/2019/12/07/NODE-EXPRESS-MONGODB%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/20170419232550.png" class="" title="注册页面">
<p>你试着输入用户名和密码，然后点击注册看看，是否会出现如下画面,如果出现了那恭喜你，你离成功越来越近了：</p>
<img src="/2019/12/07/NODE-EXPRESS-MONGODB%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/20170419232753.png" class="" title="注册成功">
<p>注册功能实现了，下面我们就实现下登录功能吧<br>8、编写登录页面<br>首先我们的在views下新建一个home.ejs来显示登录成功后的用户名<br>home.ejs</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">include</span> <span class="attr">header.ejs</span> %&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"index"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">title</span> %&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">%if(name</span> !=<span class="string">''</span> &amp;&amp; <span class="attr">name.length</span>&gt;</span>0)&#123;%&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">%=name%</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">%&#125;%</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">include</span> <span class="attr">footer.ejs</span> %&gt;</span></span></pre></td></tr></table></figure>
<p>然后我们需要配置home的路由，因此我们还需要在routers目录下新建一个home.js的文件<br>home.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> router = express.Router();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> user = <span class="built_in">require</span>(<span class="string">'../model/user'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/*导入node的加密库*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* 创建路由，并使用post接受index传递过来的name和password */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> md5 = crypto.createHash(<span class="string">'md5'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> password = req.body.password;<span class="comment">//获得传递过来的password</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> name = req.body.name;<span class="comment">//获得传递过来的name</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    md5.update(password+name);<span class="comment">//MD5混淆加密内容为password+name</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> pwd = md5.digest(<span class="string">'base64'</span>);<span class="comment">//将加密好的MD5以base64的形式展现出来</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(pwd===<span class="string">''</span> &amp;&amp; name ===<span class="string">''</span>)&#123;<span class="comment">//假如传递过来的name和password为空</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.render(<span class="string">'home'</span>, &#123; <span class="attr">title</span>: <span class="string">'发生错误'</span>,<span class="attr">name</span>:<span class="string">'请输入用户名和密码'</span> &#125;);<span class="comment">//路由则传递相关错误信息</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//console.log(pwd+' '+name);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/* 查询数据库中的name与password是否与用户输入的一致，使用findOne(&#123;&#125;,callback)方法 */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    user.findOne(&#123; <span class="attr">name</span>:name,<span class="attr">password</span>:pwd &#125;,<span class="function"><span class="keyword">function</span> (<span class="params">err, doc</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span>(doc)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                res.render(<span class="string">'home'</span>, &#123; <span class="attr">title</span>: <span class="string">'登录成功'</span>,<span class="attr">name</span>:name &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                res.render(<span class="string">'home'</span>,&#123;<span class="attr">title</span>:<span class="string">'发生错误'</span>,<span class="attr">name</span>:<span class="string">'请检查您的用户名及密码'</span>&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = router;</span></pre></td></tr></table></figure>
<p>终于完成了，下面我们就直接打开<a href="http://localhost:3000进行登录吧，记得之前我们创建的admin的密码是未进行加密的，因此在这里直接使用admin登录是不可行的，因为其密码与加密后的密码不一致，因此你不必为此劳心费神，追求完美。" target="_blank" rel="noopener">http://localhost:3000进行登录吧，记得之前我们创建的admin的密码是未进行加密的，因此在这里直接使用admin登录是不可行的，因为其密码与加密后的密码不一致，因此你不必为此劳心费神，追求完美。</a><br>我们输入之前我们注册的egtch.com的用户名，再输入密码来进行登录，即可登录成功。如图：</p>
<img src="/2019/12/07/NODE-EXPRESS-MONGODB%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/20170419233608.png" class="" title="登录成功">]]></content>
      <categories>
        <category>nodeJS</category>
      </categories>
      <tags>
        <tag>node</tag>
        <tag>mongodb</tag>
        <tag>express</tag>
      </tags>
  </entry>
  <entry>
    <title>NODE+EXPRESS图片上传实例</title>
    <url>/2019/12/07/NODE-EXPRESS%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E5%AE%9E%E4%BE%8B/</url>
    <content><![CDATA[<p>如果使用node+express作为后端的话，肯定是避免不了上传的，因此我们需要使用node+express来对图片或者其他文件进行上传。如果你不使用express也是可以的。这里我们需要使用到一个node插件formidable，这个插件主要提供的就是上传功能。下面开始我们的项目吧。<br>首先你得搭建node+express环境，如果不知道怎么搭建的，请自行百度，文章前半部分有关于环境搭建的说明。搭建完成后，我们需要安装formidable插件，在node中插件安装的方法就是直接使用命令，在项目当前目录下，直接执行npm install xxxx –save（xxxx是插件名称，–save则是将插件写入packge.json文件中）即可安装插件，如此安装formidable就使用以下命令即可：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install formidable --sava</span></pre></td></tr></table></figure>
<p>也可以使用简写的命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i -S formidable //(i即install,-S,这里的s是大写的，即sava)</span></pre></td></tr></table></figure>
<p>安装完成之后，我们首先直接在index.ejs或者index.jade中添加一个表单form，内容如下：</p>
<a id="more"></a>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/upload"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">'multipart/form-data'</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"avatar"</span> <span class="attr">type</span>=<span class="string">"file"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>上 传<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr></table></figure>
<p>下面该是写上传功能的router了，通过express的router的post来实现上传，我们打开routers目录下的index.js添加下面的代码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在顶部代码中加入如下代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> formidable = <span class="built_in">require</span>(<span class="string">'formidable'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//在module.exports = router;之前添加下面的代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//上传图片</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">router.post(<span class="string">'/upload'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span>   AVATAR_UPLOAD_FOLDER = <span class="string">'/avatar/'</span>   <span class="comment">//首先必须在public目录下创建一个名字为avatar的文件夹，否则上传会报错，因为此程序无法自动创建目录</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> form = <span class="keyword">new</span> formidable.IncomingForm();   <span class="comment">//创建上传表单</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  form.encoding = <span class="string">'utf-8'</span>;      <span class="comment">//设置编辑</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  form.uploadDir = <span class="string">'public'</span> + AVATAR_UPLOAD_FOLDER;  <span class="comment">//设置上传目录</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  form.keepExtensions = <span class="literal">true</span>;    <span class="comment">//保留后缀</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  form.maxFieldsSize = <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span>;   <span class="comment">//文件大小</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  form.parse(req, <span class="function"><span class="keyword">function</span>(<span class="params">err, fields, files</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">//res.locals.error = err;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      res.json(&#123;<span class="string">'avatar'</span>:<span class="string">'error'</span>&#125;); <span class="comment">//发生错误后输出json内容为avatar:error</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">return</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//设置允许上传的文件，这里我设置的是图片，你也可以直接设置成rar、zip、doc等</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> extName = <span class="string">''</span>;  <span class="comment">//后缀名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">switch</span> (files.avatar.type) &#123; <span class="comment">//这里的avatar就是我们之前表单中input[type=file]的name值，别搞错了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">case</span> <span class="string">'image/pjpeg'</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">            extName = <span class="string">'jpg'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">case</span> <span class="string">'image/jpeg'</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">            extName = <span class="string">'jpg'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">case</span> <span class="string">'image/png'</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">            extName = <span class="string">'png'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">case</span> <span class="string">'image/x-png'</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">            extName = <span class="string">'png'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//如果没有查找到.jpg、.png的后缀名，则提示错误信息</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(extName.length == <span class="number">0</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//res.locals.error = '只支持png和jpg格式图片';</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        res.json(&#123;<span class="string">'avatar'</span>:<span class="string">'不支持的类型'</span>&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//重新修改文件名字，使用随机数作为图片名字</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> avatarName = <span class="built_in">Math</span>.random() + <span class="string">'.'</span> + extName;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> newPath = form.uploadDir + avatarName;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//得到上传后的图片相对路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(newPath);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    fs.renameSync(files.fulAvatar.path, newPath);  <span class="comment">//重命名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//返回json，json内容为图片相对路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//res.locals.success = '上传成功';</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    res.json(&#123;<span class="string">'avatar'</span>:newPath&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>
<p>代码完成了，赶快输入<a href="http://localhost:3000查看效果吧，看看上传是否已经成功了。" target="_blank" rel="noopener">http://localhost:3000查看效果吧，看看上传是否已经成功了。</a><br>另外如果想要了解formidable的api的童鞋，请直接移步到npm：<a href="https://www.npmjs.com/package/formidable" target="_blank" rel="noopener">https://www.npmjs.com/package/formidable</a></p>
]]></content>
  </entry>
  <entry>
    <title>MONGODB中模糊查询</title>
    <url>/2019/12/07/MONGODB%E4%B8%AD%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2/</url>
    <content><![CDATA[<p>mongodb中实现模糊查询可以直接使用正则表达式，官方也给出了reg的查询方式，首先我们直接来实现下基本的模糊查询，代码很简单，也非常实用，如果你已经创建了一个数据库，并且里面包含了数据，那么你可以直接在命令行使用如下命令进行模糊查询：</p>
<p>db.col.find({name:/小强/})<br>我们可以看到“/小强/”，这个就是正则表达式了，我们也可以直接使用/^小强/等等正则表达式，都可以查询到相关数据。<br>但是问题来了，我们在写程序的时候，用户可能查询的是一个变量，这个值并不是固定的，因此使用这样的方法，仅能固定一个关键词。我之前试过以下方法，但是并没有通过</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> query=<span class="string">"/"</span>+key+<span class="string">"/"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">User.find(&#123;<span class="attr">name</span>:query&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">res,req,next</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.....</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>
<p>这种方式，我总是无法获取到我想要的数据，而且返回的都是空，最终我发现了问题，应该是我所定义的query是一个string格式，而并不是正则表达式，因此这种方法是不可行的，大家也不要再使用这样的方式了。下面我将直接使用RegExp方式进行查询。这也是最终能够真正实现模糊查询的方法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> keyword=req.params.keyword;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> key = &#123;<span class="string">'name'</span>: <span class="keyword">new</span> <span class="built_in">RegExp</span>(keyword)&#125;; <span class="comment">//模糊查询参数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Job.find(key,<span class="function"><span class="keyword">function</span> (<span class="params">err, jobs</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> res.send(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    res.json(jobs);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>
<p>到此，我们可以实现真正的模糊查询了！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>mongodb</tag>
        <tag>模糊查询</tag>
      </tags>
  </entry>
  <entry>
    <title>移动端FLEXBOX（弹性盒子）布局</title>
    <url>/2019/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AFFLEXBOX%EF%BC%88%E5%BC%B9%E6%80%A7%E7%9B%92%E5%AD%90%EF%BC%89%E5%B8%83%E5%B1%80/</url>
    <content><![CDATA[<p>flexbox故名思议弹性盒子，一般用于手机设备上的web开发。因为它在手机上有着非常不错的体验度并且还支持目前主流的浏览器，因此它是做移动开发中必学的布局模式。</p>
<p>做前端的都知道div+css布局，也听说过响应式布局、流布局。今天我们要深入css的flex弹性布局，首先我们来看一张关于flex布局的图，此图说明了flex弹性布局的相关属性的使用。</p>
<img src="/2019/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AFFLEXBOX%EF%BC%88%E5%BC%B9%E6%80%A7%E7%9B%92%E5%AD%90%EF%BC%89%E5%B8%83%E5%B1%80/flexbox.png" class="" title="flex布局">
<p>上图中main axis是主轴，你也可以理解成x轴，cross axis是侧轴，你可以理解为y轴。但是他们与数学中xy轴不同的是，我们可以选择其中一个轴作为主要的轴进行相对的布局。</p>
<p>main start和main end是主轴的起点与结尾，cross start和cross end也就是侧轴的起点与结尾了。</p>
<p>项目（item）默认沿主轴排列。单个项目（item）占据的主轴空间叫做main size，占据的交叉轴空间叫做cross size。</p>
<h2 id="使用flex"><a href="#使用flex" class="headerlink" title="使用flex"></a>使用flex</h2><p>flex是使用在父容器中的。使用display来进行设置</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">display</span><span class="selector-pseudo">:flex</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="父容器属性"><a href="#父容器属性" class="headerlink" title="父容器属性"></a>父容器属性</h2><p>flexbox的住容器上包含了以下6个属性</p>
<p>flex-direction（设置主轴）<br>flex-wrap（伸缩容器里是单行还是多行显示）<br>flex-flow（设置主轴，并且设置其是否多行显示）<br>justify-content（主轴线的对齐方式）<br>align-items（定义伸缩项目可以在伸缩容器的当前行的侧轴上对齐方式）<br>align-content（调准伸缩行在伸缩容器里的对齐方式）<br>1、flex-direction使用<br>flex-direction: row | row-reverse | column | column-reverse;</p>
<p>row（默认值）：主轴为水平方向，起点在左端。<br>row-reverse：主轴为水平方向，起点在右端。<br>column：主轴为垂直方向，起点在上沿。<br>column-reverse：主轴为垂直方向，起点在下沿。</p>
<p>主要是设置主轴，可以理解为设置主轴为水平的x轴，或者设置垂直的y轴为主轴。</p>
<p>直接看实例</p>
<img src="/2019/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AFFLEXBOX%EF%BC%88%E5%BC%B9%E6%80%A7%E7%9B%92%E5%AD%90%EF%BC%89%E5%B8%83%E5%B1%80/flex-direction.jpg" class="" title="flex布局">
<p>看到相应的变化了吧。水平方向，垂直方向，还有不同方向的反转。</p>
<p>2、flex-wrap用法<br>flex-wrap: nowrap | wrap | wrap-reverse;<br>nowrap 不换行<br>wrap 换行<br>wrap-reverse 换行后再进行反转，因此会将第一行反到最后一行去</p>
<img src="/2019/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AFFLEXBOX%EF%BC%88%E5%BC%B9%E6%80%A7%E7%9B%92%E5%AD%90%EF%BC%89%E5%B8%83%E5%B1%80/flex-wrap.jpg" class="" title="flex布局">
<p>3、flex-flow用法<br>flex-flow也就是一个简写</p>
<p>flex-flow: <flex-direction> || <flex-wrap>;</p>
<p>4、justify-content使用<br>justify-content: flex-start | flex-end | center | space-between | space-around;</p>
<p>flex-start（默认值）：左对齐<br>flex-end：右对齐<br>center： 居中<br>space-between：两端对齐，项目之间的间隔都相等。<br>space-around：每个项目两侧的间隔相等。所以，项目之间的间隔比项目与边框的间隔大一倍。</p>
<img src="/2019/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AFFLEXBOX%EF%BC%88%E5%BC%B9%E6%80%A7%E7%9B%92%E5%AD%90%EF%BC%89%E5%B8%83%E5%B1%80/justify-content.jpg" class="" title="flex布局">
<p>5、align-items使用<br>align-items: flex-start | flex-end | center | baseline | stretch;</p>
<p>flex-start：交叉轴的起点对齐。<br>flex-end：交叉轴的终点对齐。<br>center：交叉轴的中点对齐。<br>baseline: 项目的第一行文字的基线对齐。<br>stretch（默认值）：如果项目未设置高度或设为auto，将占满整个容器的高度。</p>
<img src="/2019/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AFFLEXBOX%EF%BC%88%E5%BC%B9%E6%80%A7%E7%9B%92%E5%AD%90%EF%BC%89%E5%B8%83%E5%B1%80/align-items.jpg" class="" title="flex布局">
<p>6、align-content<br>align-content: flex-start | flex-end | center | space-between | space-around | stretch;</p>
<p>flex-start：与交叉轴的起点对齐。<br>flex-end：与交叉轴的终点对齐。<br>center：与交叉轴的中点对齐。<br>space-between：与交叉轴两端对齐，轴线之间的间隔平均分布。<br>space-around：每根轴线两侧的间隔都相等。所以，轴线之间的间隔比轴线与边框的间隔大一倍。<br>stretch（默认值）：轴线占满整个交叉轴。</p>
<p>属性定义了多根轴线的对齐方式。如果项目只有一根轴线，该属性不起作用。</p>
<h2 id="子item属性（项目属性）"><a href="#子item属性（项目属性）" class="headerlink" title="子item属性（项目属性）"></a>子item属性（项目属性）</h2><p>order（用于排序）<br>flex-grow（定义项目的放大比例，默认为0，即如果存在剩余空间，也不放大。）<br>flex-shrink（定义了项目的缩小比例，默认为1，即如果空间不足，该项目将缩小）<br>flex-basis（定义了在分配多余空间之前，项目占据的主轴空间（main size））<br>flex（flex-grow, flex-shrink 和 flex-basis的简写）<br>align-self（单个项目有与其他项目不一样的对齐方式，可覆盖align-items属性）<br>这些属性都是对项目进行相应操作的。想要试一试的朋友，自己去尝试着看效果吧。</p>
<p>1、order用法<br>order: <integer>;<br>2、flex-grow<br>flex-grow: <number>; /* default 0 <em>/<br>3、flex-shrink<br>flex-shrink: <number>; /</em> default 1 <em>/<br>4、flex-basis<br>flex-basis: <length> | auto; /</em> default auto */<br>5、flex<br>flex: none | [ &lt;’flex-grow’&gt; &lt;’flex-shrink’&gt;? || &lt;’flex-basis’&gt; ]<br>6、align-self<br>align-self: auto | flex-start | flex-end | center | baseline | stretch;</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>flex布局包含了容器与项目的相关设置，包括了很多不同的布局模式，最主要的是，你的浏览器有多大，它都可以缩放自如。所以手机端必备的布局啊！</p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>flex</tag>
        <tag>布局</tag>
        <tag>弹性盒子</tag>
      </tags>
  </entry>
  <entry>
    <title>IONIC2中页面加载LOADING效果的实现</title>
    <url>/2019/12/07/IONIC2%E4%B8%AD%E9%A1%B5%E9%9D%A2%E5%8A%A0%E8%BD%BDLOADING%E6%95%88%E6%9E%9C%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<p>ionic是一个基于Angular、Cordova的一个开源框架，它提供了相关的UI库，ionic2中对ionic1进行了更多的优化，让ionic的运行速度，执行效率提高了不少。选择ionic开发web app是个不错的想法。下面就来说下ionic2中的loading效果的实现吧！本文使用TypeScript进行对ionic2的开发，如果不了解微软的TypeScript的，请自己google一下哦！</p>
<h2 id="引入LoadingController"><a href="#引入LoadingController" class="headerlink" title="引入LoadingController"></a>引入LoadingController</h2><p>我们要使用LoadingController，就必须先引入它，直接使用下面的代码即可实现<br>import { LoadingController } from ‘ionic-angular’;<br>引入后，我们就需要在constructor中声明了，如下：<br>constructor(public loadingCtrl: LoadingController){<br>//……..在这里执行loading效果或者设置loading的图标、css等<br>}<br>看上去是很简单哦，要使用这个loading，那么我们得先创建它。</p>
<h3 id="创建create"><a href="#创建create" class="headerlink" title="创建create()"></a>创建create()</h3><p>直接可以使用create方法，create方法中又包括了以下几个属性：<br>spinner（设置loading的SVG图片）<br>content（设置loading的提示文字或内容）<br>loadingSpinner（这个我暂时没有理解到底是做什么的）</p>
<h3 id="移除（也可以叫解雇）dismiss"><a href="#移除（也可以叫解雇）dismiss" class="headerlink" title="移除（也可以叫解雇）dismiss()"></a>移除（也可以叫解雇）dismiss()</h3><p>移除是当我们的loading完成后，自动移除当前loading，移除后，就无法再次在当前组件中使用它了。<br>加载指示器可以在特定时间后通过传递毫秒数来自动关闭，以duration在加载选项中显示它。默认情况下，加载指示器即使在页面更改期间也会显示，但可以通过设置dismissOnPageChange来禁用 true。要在创建后关闭加载指示器，请调用dismiss()“加载”实例上的方法。onDidDismiss可以调用该 功能，在加载指示灯关闭后执行动作。</p>
<a id="more"></a>
<h2 id="使用LoadingController"><a href="#使用LoadingController" class="headerlink" title="使用LoadingController"></a>使用LoadingController</h2><h3 id="默认UI的loading"><a href="#默认UI的loading" class="headerlink" title="默认UI的loading"></a>默认UI的loading</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(public loadingCtrl: LoadingController) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">presentLoadingDefault() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> loading = <span class="keyword">this</span>.loadingCtrl.create(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    content: <span class="string">'Please wait...'</span><span class="comment">//设置loading时显示的文字</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  loading.present();</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;<span class="comment">//设置loading的时间</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    loading.dismiss();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;, <span class="number">5000</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>自定义loading</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">presentLoadingCustom() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> loading = <span class="keyword">this</span>.loadingCtrl.create(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    spinner: <span class="string">'hide'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    content: <span class="string">`</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      &lt;div class="custom-spinner-container"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &lt;div class="custom-spinner-box"&gt;&lt;img src=""&gt;&lt;/div&gt; //自定义loading图片(可以是svg或者gif)和div</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      &lt;/div&gt;`</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    duration: <span class="number">5000</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  loading.onDidDismiss(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Dismissed loading'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  loading.present();</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>这样就定义好一个属于自己的loading了，但是问题来了，你在loading的时候，总是有一层白色背景在你的loading图片后面，如下图：</p>
<img src="/2019/12/07/IONIC2%E4%B8%AD%E9%A1%B5%E9%9D%A2%E5%8A%A0%E8%BD%BDLOADING%E6%95%88%E6%9E%9C%E7%9A%84%E5%AE%9E%E7%8E%B0/20170416013149.png" class="" title="ionic loading">
<p>如果是在IOS上，这样的效果很原生的，非常漂亮，但是如果你不想要这个白色的背景，那是可以通过修改scss变量来进行设置的。<br>首先我们打开theme文件夹下的variables.scss，给他设置如下变量，即可去除背景以及背景阴影了</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">$loading-md-background: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-md-border-radius: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-md-box-shadow-color:rgba(158, 158, 158,0);</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-md-box-shadow:rgba(158, 158, 158,0);</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-ios-background: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-ios-border-radius: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-wp-background: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">$loading-wp-border-radius: 0;</span></pre></td></tr></table></figure>
<p>一些你肯定用得到的参数及scss变量<br>create(opts)<br>Create a loading indicator. See below for options.</p>
<p>Param Type Details<br>opts LoadingOptions<br>Loading options<br>Returns: Loading<br>Returns a Loading Instance</p>
<p>Advanced</p>
<p>Loading options</p>
<p>Option Type Description<br>spinner string The name of the SVG spinner for the loading indicator.<br>content string The html content for the loading indicator.<br>cssClass string Additional classes for custom styles, separated by spaces.<br>showBackdrop boolean Whether to show the backdrop. Default true.<br>dismissOnPageChange boolean Whether to dismiss the indicator when navigating to a new page. Default false.<br>duration number How many milliseconds to wait before hiding the indicator. By default, it will show until dismiss() is called.</p>
<p>Sass Variables<br>iOS Material Design Windows Platform<br>Property Default Description<br>$loading-ios-padding 24px 34px<br>Padding of the loading wrapper<br>$loading-ios-max-width 270px<br>Max width of the loading wrapper<br>$loading-ios-max-height 90%<br>Maximum height of the loading wrapper<br>$loading-ios-border-radius 8px<br>Border radius of the loading wrapper<br>$loading-ios-text-color #000<br>Text color of the loading wrapper<br>$loading-ios-background #f8f8f8<br>Background of the loading wrapper<br>$loading-ios-content-font-weight bold<br>Font weight of the loading content<br>$loading-ios-spinner-color #69717d<br>Color of the loading spinner<br>$loading-ios-spinner-ios-color $loading-ios-spinner-color<br>Color of the ios loading spinner<br>$loading-ios-spinner-bubbles-color $loading-ios-spinner-color<br>Color of the bubbles loading spinner<br>$loading-ios-spinner-circles-color $loading-ios-spinner-color<br>Color of the circles loading spinner<br>$loading-ios-spinner-crescent-color $loading-ios-spinner-color<br>Color of the crescent loading spinner<br>$loading-ios-spinner-dots-color $loading-ios-spinner-color<br>Color of the dots loading spinner</p>
<p>更多可以查看官方文档：<a href="http://ionicframework.com/docs/api/components/loading/LoadingController/" target="_blank" rel="noopener">http://ionicframework.com/docs/api/components/loading/LoadingController/</a></p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>ionic</tag>
        <tag>loading</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS3美化表单</title>
    <url>/2019/12/07/CSS3%E7%BE%8E%E5%8C%96%E8%A1%A8%E5%8D%95/</url>
    <content><![CDATA[<p>表单美化在前端开发中经常使用到，CSS3中有很多对我们有利的伪类和属性选择器，今天主要来说说使用属性选择器和label来进行美化，不使用伪类。<br>首先，先来看下美化后的相关效果：</p>
<img src="/2019/12/07/CSS3%E7%BE%8E%E5%8C%96%E8%A1%A8%E5%8D%95/form.gif" class="" title="表单美化">
<p>下面我们来看看实现的思想：<br>1、首先隐藏input<br>2、在label中设置背景即可</p>
<p>首先我们要先了解一下几个关于浏览器的知识点：<br>浏览器中，chrome在input的focus的时候会自动增加一个蓝色的外边框，以及select下拉，在Firefox和chrome下的显示都不一样，如下图chrome中的显示：</p>
<img src="/2019/12/07/CSS3%E7%BE%8E%E5%8C%96%E8%A1%A8%E5%8D%95/20170317212758.jpg" class="" title="普通的表单">
<p>出现以上的问题，我们需要通过以下几个属性来解决：<br>select的小三角样式既然不一样，那么我们就将其删除，使用我们自己设定的图片或者svg，删除小三角的代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">-webkit-appearance</span>: <span class="selector-tag">none</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">-webkit-tap-highlight-color</span>: <span class="selector-id">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">appearance</span><span class="selector-pseudo">:none</span>;</span></pre></td></tr></table></figure>
<p>第二个，在chrome中出现的蓝色边框，可以直接设置outline的值为none来去除：<br>outline: none;<br>第三个问题，chrome中自动填充后，input背景会自动变为黄色的，如果input没有使用背景图片的话，那可以通过下面的css解决这个问题：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-webkit-autofill</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0px</span> <span class="number">1000px</span> white inset;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>如果是使用的背景图片，那么上面这段代码将会覆盖了背景图片。因此我们就需要禁止input的自动填充功能了。直接在input后面增加一个属性autocomplete=”off”即可。而在本列中，我是使用背景图片的方法，因此只能直接牺牲自动完成的功能了。<br>点击复选框和单选框的过程中我使用了相应的css3动画。另外input[text]中我也使用了css3的过渡效果。</p>
<p>解决了以上3个问题，我们就可以开始美化input了<br>看代码:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"radio_all"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Radio美化<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"male"</span> <span class="attr">name</span>=<span class="string">"sex"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"male"</span>&gt;</span>男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"female"</span> <span class="attr">name</span>=<span class="string">"sex"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"female"</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"other"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">checked</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"other"</span>&gt;</span>保密<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>CheckBox美化<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"Java"</span> <span class="attr">name</span>=<span class="string">"lang"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"Java"</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"JavaScript"</span> <span class="attr">name</span>=<span class="string">"lang"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"JavaScript"</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"Vuejs"</span> <span class="attr">name</span>=<span class="string">"lang"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"Vuejs"</span>&gt;</span>Vuejs<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"React"</span> <span class="attr">name</span>=<span class="string">"lang"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"React"</span>&gt;</span>React<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"i-select"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"百度"</span>&gt;</span>baidu<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"谷歌"</span>&gt;</span>Google<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"谷歌1"</span>&gt;</span>this is google web site<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-text"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>input text<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">placeholder</span>=<span class="string">"用户名"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>
<p>CSS3代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">h1</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">font-size</span>: <span class="number">28px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.radio_all</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">80%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-moz-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-ms-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.radio_all</span> <span class="selector-tag">input</span><span class="selector-attr">[type='radio']</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">display</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.radio_all</span> <span class="selector-tag">input</span><span class="selector-attr">[type='radio']</span> + <span class="selector-tag">label</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"svg/nocheck_16.svg"</span>) left center no-repeat;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">cursor</span>: pointer;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">0</span> <span class="number">18px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.radio_all</span> <span class="selector-tag">input</span><span class="selector-attr">[type='radio']</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"svg/check_16.svg"</span>) left center no-repeat;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-animation</span>: bounce <span class="number">0.3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-moz-animation</span>: bounce <span class="number">0.3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">animation</span>: bounce <span class="number">0.3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.checkbox</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">80%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-moz-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-ms-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.checkbox</span> <span class="selector-tag">input</span><span class="selector-attr">[type='checkbox']</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">display</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.checkbox</span> <span class="selector-tag">input</span><span class="selector-attr">[type='checkbox']</span> + <span class="selector-tag">label</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"svg/checkbox_16.svg"</span>) left center no-repeat;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">cursor</span>: pointer;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">0</span> <span class="number">18px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.checkbox</span> <span class="selector-tag">input</span><span class="selector-attr">[type='checkbox']</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"svg/icheckbox_16.svg"</span>) left center no-repeat;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-animation</span>: bounce <span class="number">0.3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-moz-animation</span>: bounce <span class="number">0.3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">animation</span>: bounce <span class="number">0.3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.select</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">80%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.i-select</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">vertical-align</span>: middle;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">position</span>: relative;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">text-align</span>: left;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*删除小右侧三角*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-appearance</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-tap-highlight-color</span>: <span class="number">#fff</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">appearance</span>:none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">outline</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*删除小右侧三角 end*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-touch-callout</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-webkit-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-khtml-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-moz-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">-ms-user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">user-select</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#DDD</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"svg/select.svg"</span>) <span class="number">#EEE</span> <span class="number">98%</span> center no-repeat;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span> <span class="number">10px</span> <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">overflow</span>:hidden;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.i-select</span> <span class="selector-tag">option</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.i-select</span> <span class="selector-tag">option</span><span class="selector-attr">[selected]</span>&#123; <span class="attribute">font-weight</span>:bold; <span class="attribute">background</span>: darkcyan&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.i-select</span> <span class="selector-tag">option</span><span class="selector-pseudo">:nth-child(even)</span> &#123; <span class="attribute">background-color</span>:<span class="number">#F2F2F2</span>; &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.input-text</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">80%</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.input-text</span> <span class="selector-tag">label</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">text-align</span>: justify;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">word-spacing</span>:<span class="number">8px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">letter-spacing</span>: <span class="number">1px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">60px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">display</span>: inline-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.input-text</span> <span class="selector-tag">input</span><span class="selector-attr">[type='text']</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid navajowhite;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">10px</span> <span class="number">10px</span> <span class="number">25px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"svg/account.svg"</span>) <span class="number">6px</span> center no-repeat;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.input-text</span> <span class="selector-tag">input</span><span class="selector-attr">[type='text']</span><span class="selector-pseudo">:focus</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid salmon;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">outline</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">transition</span>: all .<span class="number">3s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">@-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> bounce &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    0%, 100% &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    50% &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    @-<span class="keyword">moz</span>-<span class="keyword">keyframes</span> bounce &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    0%, 100% &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-moz-transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    50% &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-moz-transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    @<span class="keyword">keyframes</span> bounce &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    0%, 100% &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-moz-transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-ms-transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-o-transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    50% &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-moz-transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-ms-transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">-o-transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(0.8);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>代码演示：<a href="https://jsfiddle.net/king2088/414dgz9g/1/" target="_blank" rel="noopener">https://jsfiddle.net/king2088/414dgz9g/1/</a></p>
]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>css3</tag>
        <tag>表单</tag>
        <tag>美化</tag>
      </tags>
  </entry>
  <entry>
    <title>使用VUE2制作音乐播放器</title>
    <url>/2019/12/07/%E4%BD%BF%E7%94%A8VUE2%E5%88%B6%E4%BD%9C%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8/</url>
    <content><![CDATA[<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>GIF动图有3M多，如果没有显示出来，请再等等</p>
<img src="/2019/12/07/%E4%BD%BF%E7%94%A8VUE2%E5%88%B6%E4%BD%9C%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8/vue-player.gif" class="" title="Vue音乐播放器">
<p>看到了吧，自己的一点小创意，搞了个猪头上去。</p>
<h2 id="相关代码"><a href="#相关代码" class="headerlink" title="相关代码"></a>相关代码</h2><p>本程序中仅使用了vue的ajax框架vue-resource，未使用到vue-router，因此再安装vue-cli的时候，可以略过vue-router，本程序仅有一个组件，即只有一个vue文件，使用了css预处理语言stylus。使用的json数据为本站相关php代码生成的（仅为了演示），如果你是在本地搭建环境，json也可以写在本地。</p>
<p>本demo已经使用cordova制作成了安卓的apk文件，如需体验，请点击此处下载<br>源码已经提交到github（记得给我加星哦）：<a href="https://github.com/king2088/vue-tplayer" target="_blank" rel="noopener">https://github.com/king2088/vue-tplayer</a><br>演示地址：<a href="http://www.egtch.com/t_works/tplayer/" target="_blank" rel="noopener">http://www.egtch.com/t_works/tplayer/</a></p>
<h3 id="生成json的php如下"><a href="#生成json的php如下" class="headerlink" title="生成json的php如下"></a>生成json的php如下</h3><p>代码非常简单，就是定义一串json数据，然后在展现出来：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    header(<span class="string">"Access-Control-Allow-Origin: *"</span>);<span class="comment">//设置跨域允许</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    header(<span class="string">'Content-Type: text/html; charset=utf-8'</span>); <span class="comment">//设置页面编码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    header(<span class="string">'Content-type: application/json'</span>);<span class="comment">//设置页面为json格式的文档</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    $data =<span class="string">' &#123;"music":[</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "id":"1",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "name": "Apologize",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "singer":"Timbaland Remix",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "img":"http://www.egtch.com/t_works/Vuedata/apologize.jpg",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "url": "http://www.egtch.com/t_works/Vuedata/Apologize (Timbaland Remix).mp3"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "id":"2",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "name": "Hero",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "singer":"Enrique Iglesias",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "img":"http://www.egtch.com/t_works/Vuedata/hero.jpg",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "url": "http://www.egtch.com/t_works/Vuedata/Hero.mp3"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "id":"3",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "name": "I AM YOU",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "singer":"Kim Taylor",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "img":"http://www.egtch.com/t_works/Vuedata/iamyou.jpg",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          "url": "http://www.egtch.com/t_works/Vuedata/I Am You.mp3"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      ]&#125;'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">echo</span> $data</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">?&gt;</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="app-vue代码"><a href="#app-vue代码" class="headerlink" title="app.vue代码"></a>app.vue代码</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;div id=<span class="string">"app"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"list"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;music.name&#125;&#125;-&#123;&#123;music.singer&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">"isShow(),isBg()"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./assets/player/list.png"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"music"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"text"</span>&gt;&#123;&#123;music.name&#125;&#125;&lt;span&gt;&#123;&#123;music.singer&#125;&#125;&lt;<span class="regexp">/span&gt;&lt;/</span>div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"img"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"pic"</span> <span class="attr">:src</span>=<span class="string">"music.img"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;<span class="regexp">/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="regexp">    &lt;div class="player"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="regexp">      &lt;div class="ico"&gt;&lt;img src="./</span>assets/player/backward.png<span class="string">" id="</span>pre<span class="string">" @click="</span>isPre<span class="string">"&gt;&lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      &lt;div class="</span>ico<span class="string">"&gt;&lt;img src="</span>./assets/player/play.png<span class="string">" id="</span>play<span class="string">" @click="</span>isPlay<span class="string">"&gt;&lt;img src="</span>./assets/player/pause.png<span class="string">" id="</span>stop<span class="string">" @click="</span>isStop<span class="string">"&gt;&lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      &lt;div class="</span>ico<span class="string">"&gt;&lt;img src="</span>./assets/player/forward.png<span class="string">" id="</span>next<span class="string">" @click="</span>isNext<span class="string">"&gt;&lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &lt;audio id="</span>audio<span class="string">" :src="</span>music.url<span class="string">" preload autoplay @ended="</span>isNext<span class="string">"&gt;&lt;/audio&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &lt;transition name="</span>fade<span class="string">"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      &lt;div class="</span>songList<span class="string">" v-show="</span>showList<span class="string">"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         &lt;div class="</span>items<span class="string">"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           &lt;div class="</span>title<span class="string">"&gt;歌曲列表 &lt;span id="</span>close<span class="string">" @click="</span>isClose<span class="string">"&gt;&lt;img src="</span>./assets/player/close.png<span class="string">"&gt;&lt;/span&gt;&lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           &lt;div class="</span>item<span class="string">" v-for="</span>(item, index) <span class="keyword">in</span> MList<span class="string">"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             &lt;a :id="</span><span class="string">'item-'</span>+index<span class="string">" @click="</span>clickSong(index)<span class="string">"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">               &lt;span class="</span>l<span class="string">"&gt;&#123;&#123;MList[index].name&#125;&#125;&lt;/span&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">               &lt;span class="</span>r<span class="string">"&gt;&#123;&#123;MList[index].singer&#125;&#125;&lt;/span&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">               &lt;div class="</span>clear<span class="string">"&gt;&lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             &lt;/a&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           &lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         &lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &lt;/transition&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  &lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&lt;/template&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&lt;script&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">export default &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    name: 'app',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    data()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        return&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         apiUrl: 'http://www.egtch.com/t_works/Vuedata/data.php',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             id: 0,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             bg:'',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          music: '',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          MList:'',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       showList: false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    created()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        this.getMusic(this.id)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        this.isBg()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    watch:&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        'id':'getMusic',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        'bg':'isBg'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    methods:&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        getMusic(p)&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">            this.$http.get(this.apiUrl).then(response =&gt; &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                // get body data</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                response = response.body</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                this.MList = response.music</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                /*alert(this.MList)*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                if(p &lt; response.music.length) &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                   this.music = response.music[p]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">               &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">               if(p &gt; response.music.length)&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                    this.id = 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                    this.music = response.music[this.id]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                if(p &lt; 0)&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                   this.id = response.music.length</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">                   this.music = response.music[this.id]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">               &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           &#125;)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       /*查看当前audio是否正在播放，如果停止，那么播放下一曲*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isPlay()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         document.getElementById("</span>audio<span class="string">").play();</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         document.getElementById("</span>play<span class="string">").style.display="</span>none<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         document.getElementById("</span>stop<span class="string">").style.display="</span>inline<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         document.getElementById("</span>pic<span class="string">").style.animationPlayState="</span>running<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         return false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isStop()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          document.getElementById("</span>audio<span class="string">").pause();</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          document.getElementById("</span>stop<span class="string">").style.display="</span>none<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          document.getElementById("</span>play<span class="string">").style.display="</span>inline<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          document.getElementById("</span>pic<span class="string">").style.animationPlayState="</span>paused<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          return false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isNext()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.id++;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           /*为了防止停止状态下，点击下一曲的时候，停止图标不出现，并且专辑图片不转动*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>play<span class="string">").style.display="</span>none<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>stop<span class="string">").style.display="</span>inline<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>item-<span class="string">"+this.bg).style.background='none';</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>pic<span class="string">").style.animationPlayState="</span>running<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isPre()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.id--;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>play<span class="string">").style.display="</span>none<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>stop<span class="string">").style.display="</span>inline<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>pic<span class="string">").style.animationPlayState="</span>running<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isShow()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.showList = true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isClose()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.showList = false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       isBg()&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.bg = this.id</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>item-<span class="string">"+this.bg).style.background='#F2F2F2';</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       /*点击列表中的歌曲，并播放*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       clickSong(i)&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.id = i;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>item-<span class="string">"+this.bg).style.background='none';</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>play<span class="string">").style.display="</span>none<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           document.getElementById("</span>pic<span class="string">").style.animationPlayState="</span>running<span class="string">";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           this.isBg()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&lt;/script&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&lt;style lang="</span>stylus<span class="string">" rel="</span>stylesheet/stylus<span class="string">"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">html,body</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  height 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  max-width 600px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  margin 0 auto</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  .clear</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    clear both</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  #app</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    font-family 'Microsoft YaHei','\5FAE\8F6F\96C5\9ED1'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    font-weight lighter</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    -webkit-font-smoothing antialiased</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    -moz-osx-font-smoothing grayscale</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    color #2c3e50</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    height 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    overflow hidden</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    .list</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      height 60px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      line-height 60px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      background #F2F2F2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      border-bottom 1px #333 solid</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      span</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        padding-left 20px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        display inline-block</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        color darkblue</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      &amp; &gt; a</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       display block</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       float right</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &amp; &gt; img</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         margin-top 8px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         width 40px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   .player</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     max-width 600px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     height 30%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     opacity .8</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     position fixed</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     background #F2F2F2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     border-top 3px #000 solid</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     border-bottom 10px brown solid</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     bottom 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     font-size 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     border-top-left-radius 50%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     border-top-right-radius 50%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     text-align center</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     display flex</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     .ico</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       flex 1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       padding-top 50px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       text-align center</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       #play</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         width 60%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         max-width 64px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         margin-top 35px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         display none</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       #stop</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         margin-top 35px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         width 60%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         max-width 64px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &amp; &gt; img</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         border 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         width 32px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         vertical-align middle</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   .music</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     height 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     background url("</span>./assets/player/bg.jpg<span class="string">")</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     position relative</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     top 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     left 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     .text</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       text-align center</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       padding-top 5%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       font-size 30px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       span</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         font-size 14px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         display block</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         line-height 2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     .img</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       width 200px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       height 200px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       border-radius 50%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       background #333</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       margin 0 auto</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       position absolute</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       outline none</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       bottom 46%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       left 50%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       transform translateX(-100px)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       &amp; &gt; img</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         width 90%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         height 90%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         padding 5%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         border-radius 50%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         animation: rotation 10s linear infinite;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          -moz-animation: rotation 10s linear infinite;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          -webkit-animation: rotation 10s linear infinite;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          -o-animation: rotation 10s linear infinite;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    .songList</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      position: fixed;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      top: 0;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      z-index: 100;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      width: 100%;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      max-width 600px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      margin 0 auto</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      height: 100%;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      overflow: auto;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      transition: all .5s;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      background: rgba(7, 17, 27, .4);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      backdrop-filter: blur(10px); /*ios 模糊背景*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      .items</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        background #ffffff</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        height 55%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        margin 0 auto</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        padding 60px 0 0 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        overflow auto</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        border-bottom 2px #000 solid</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        .title</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          max-width 600px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          height 50px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          line-height 50px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          background #FFF</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          border-bottom 1px #DDD solid</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          text-align center</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          padding-top 10px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          font-size 18px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          position fixed</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          top 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">          #close</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">            float right</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">            width 40px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">            &amp; &gt; img</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             width 40px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">       .item</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         width 100%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         margin 0 auto</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         border-top 1px #EEE solid</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         line-height 2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">         &amp; &gt; a</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           color black</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           padding 8px 5%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           display block</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           width 90%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           &amp; &gt; span</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             display inline-block</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             width 50%</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           .l</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             float left</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             font-size 16px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">           .r</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             float right</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             text-align right</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             font-size 12px</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">             color #CCC</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"> @-webkit-keyframes rotation</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   from</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     transform rotate(0deg)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   to</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">     -webkit-transform rotate(360deg)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"> .fade-enter-active</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   transition all .3s ease</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"> .fade-leave-active</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   transition all .3s cubic-bezier(1.0, 0.5, 0.8, 1.0)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"> .fade-enter, .fade-leave-active</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   transform translateY(-20px)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">   opacity 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&lt;/style&gt;</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>音乐</tag>
        <tag>播放器</tag>
      </tags>
  </entry>
  <entry>
    <title>如何让MD5加密更加安全？</title>
    <url>/2019/12/07/%E5%A6%82%E4%BD%95%E8%AE%A9MD5%E5%8A%A0%E5%AF%86%E6%9B%B4%E5%8A%A0%E5%AE%89%E5%85%A8%EF%BC%9F/</url>
    <content><![CDATA[<h2 id="什么是MD5"><a href="#什么是MD5" class="headerlink" title="什么是MD5"></a>什么是MD5</h2><p>MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。将数据（如汉字）运算为另一固定长度值，是杂凑算法的基础原理，MD5的前身有MD2、MD3和MD4。<br>MD5算法具有以下特点：<br>1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。<br>2、容易计算：从原数据计算出MD5值很容易。<br>3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。<br>4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。</p>
<h2 id="MD5如此完美"><a href="#MD5如此完美" class="headerlink" title="MD5如此完美"></a>MD5如此完美</h2><p>虽然上面把MD5说得这么完美，而且MD5加密是不可逆加密、单向加密（就是说MD5加密后，是无法再通过相关的破解方法破解出明文密码的），但是如果真要破解MD5那也是一件很容易的事情，目前很多网站都提供相关的碰撞解密MD5的功能，因此，简单的字符串MD5加密，很容易就会被破解。那么MD5还能使用吗？肯定是可以使用的，但是必须使用混淆的方法来对加密的数据进行混淆加密。在java开发中经常都会使用混淆加密来加密字符串。如果混淆的字符串被别人发现了，那样也照样是不安全的。</p>
<h2 id="如何让MD5加密更为安全"><a href="#如何让MD5加密更为安全" class="headerlink" title="如何让MD5加密更为安全"></a>如何让MD5加密更为安全</h2><p>比如说网站用户密码加密，一般的肯定会想到，直接使用MD5(用户名+密码+”字符串”)的方式进行加密，以增加破解难度。当然这种方法很不错，确实能够保证数据的安全，但是也说不准，假如别人破解了你2个MD5密码的话，那么就会知道，你的加密模式。<br>因此，我个人建议是使用SHA1+MD5混合加密模式，或者MD5+base64的方式，使用这样的方式后，我们再对最终加密结果进行相应的替换即可得到一个很难破解的密码了。<br>下面我以java中MD5+base64的方式，编写了一个实例，大家可以学习下这种思路。</p>
<a id="more"></a>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.md5.salt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;  </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;  </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Md5Salt</span> </span>&#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*MD5加密*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getMD5</span><span class="params">(<span class="keyword">byte</span>[] source)</span> </span>&#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        String s = <span class="keyword">null</span>;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">char</span> hexDigits[] = &#123; <span class="string">'0'</span>,<span class="string">'a'</span>,<span class="string">'9'</span>,<span class="string">'J'</span>,<span class="string">'4'</span>,<span class="string">'c'</span>,<span class="string">'7'</span>,<span class="string">'W'</span>,<span class="string">'2'</span>,<span class="string">'v'</span>, <span class="string">'R'</span>,<span class="string">'3'</span>,<span class="string">'h'</span>,<span class="string">'7'</span>,<span class="string">'I'</span>,<span class="string">'5'</span> &#125;;<span class="comment">// 用来将字节转换成16进制表示的字符  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">try</span> &#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">            java.security.MessageDigest md = java.security.MessageDigest.getInstance(<span class="string">"MD5"</span>);  </span></pre></td></tr><tr><td class="code"><pre><span class="line">            md.update(source);  </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">byte</span> tmp[] = md.digest();<span class="comment">// MD5 的计算结果是一个 128 位的长整数，  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 用字节表示就是 16 个字节  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">char</span> str[] = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">16</span> * <span class="number">2</span>];<span class="comment">// 每个字节用 16 进制表示的话，使用两个字符， 所以表示成 16  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 进制需要 32 个字符  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">int</span> k = <span class="number">0</span>;<span class="comment">// 表示转换结果中对应的字符位置  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;<span class="comment">// 从第一个字节开始，对 MD5 的每一个字节// 转换成 16  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 进制字符的转换  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="keyword">byte</span> byte0 = tmp[i];<span class="comment">// 取第 i 个字节  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                str[k++] = hexDigits[byte0 &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>];<span class="comment">// 取字节中高 4 位的数字转换,// &gt;&gt;&gt;  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 为逻辑右移，将符号位一起右移  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                str[k++] = hexDigits[byte0 &amp; <span class="number">0xf</span>];<span class="comment">// 取字节中低 4 位的数字转换  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">            s = <span class="keyword">new</span> String(str);<span class="comment">// 换后的结果转换为字符串  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// TODO Auto-generated catch block  </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">//e.printStackTrace();</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            System.out.println(e);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> s;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*Base64编码*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encodeBase64</span><span class="params">(<span class="keyword">byte</span>[]input)</span> <span class="keyword">throws</span> Exception</span>&#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        Class clazz=Class.forName(<span class="string">"com.sun.org.apache.xerces.internal.impl.dv.util.Base64"</span>);  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        Method mainMethod= clazz.getMethod(<span class="string">"encode"</span>, <span class="keyword">byte</span>[]<span class="class">.<span class="keyword">class</span>)</span>;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        mainMethod.setAccessible(<span class="keyword">true</span>);  </span></pre></td></tr><tr><td class="code"><pre><span class="line">         Object retObj=mainMethod.invoke(<span class="keyword">null</span>, <span class="keyword">new</span> Object[]&#123;input&#125;);  </span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="keyword">return</span> (String)retObj;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*Test*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">/*混淆MD5加密 前字符串+用户名+密码+后字符串*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        String name = <span class="string">"abc"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        String keya=<span class="string">"@#$&amp;*1029we"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        String keyb=<span class="string">"&#125;)*vbks!1214"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        String password = <span class="string">"a123456"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        String str =keya+name+password+keyb;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">/*为了更加安全，在混洗后的MD5加密前后再添加相应的混淆字符串将32位字符变成52位*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        String test=<span class="string">"$a&amp;m|:p"</span>+Md5Salt.getMD5(str.getBytes())+<span class="string">"4r0gf~!*^@j86"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(str);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(<span class="string">"混淆后："</span>+test);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(<span class="string">"未混淆的password MD5:"</span>+Md5Salt.getMD5(password.getBytes()));</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">/*混淆加密后，再进行base64加密得到最终加密结果*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(<span class="string">"base64编码后:"</span>+Md5Salt.encodeBase64(test.getBytes()));</span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(<span class="string">"base64编码后，再对其相关字母数字进行替换后的结果："</span>+Md5Salt.encodeBase64(test.getBytes()).replaceAll(<span class="string">"X"</span>,<span class="string">"8"</span>).replaceAll(<span class="string">"="</span>,<span class="string">"k"</span>).replaceAll(<span class="string">"R"</span>,<span class="string">"i"</span>).replaceAll(<span class="string">"2"</span>,<span class="string">"e"</span>).replaceAll(<span class="string">"m"</span>,<span class="string">"c"</span>).replaceAll(<span class="string">"J"</span>,<span class="string">"Es"</span>));</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>运行以上代码得到如下结果：<br>@#$&amp;<em>1029weabca123456})*vbks!1214<br>混淆后：$a&amp;m|:p2a47a377IJcc4W4IWah3a3W94c7J34cJ4r0gf~!</em>^@j86<br>未混淆的password MD5:7h42JI20RWR037vI5Wa72h5vWJ7WJv94<br>base64编码后:<br>JGEmbXw6cDJhNDdhMzc3SUpjYzRXNElXYWgzYTNXOTRjN0ozNGNKNHIwZ2Z+ISpeQGo4Ng==<br>base64编码后，再对其相关字母数字进行替换后的结果：<br>EsGEcb8w6cDEshNDdhMzc3SUpjYzi8NEl8YWgzYTN8OTijN0ozNGNKNHIwZeZ+ISpeQGo4Ngkk<br>如图：</p>
<img src="/2019/12/07/%E5%A6%82%E4%BD%95%E8%AE%A9MD5%E5%8A%A0%E5%AF%86%E6%9B%B4%E5%8A%A0%E5%AE%89%E5%85%A8%EF%BC%9F/20161128210129.png" class="" title="MD5加密输出">

<p>首先我们将，base64编码后的代码<br>“JGEmbXw6cDJhNDdhMzc3SUpjYzRXNElXYWgzYTNXOTRjN0ozNGNKNHIwZ2Z+ISpeQGo4Ng==”<br>，放到网上的base64解密，进行解密，就可以得到混淆后的字符串<br>“$a&amp;m|:p2a47a377IJcc4W4IWah3a3W94c7J34cJ4r0gf~!*^@j86”<br>了。怎么样，看来base64编码，可有可无啊。<br>但是，如果我们队base64的编码结果进行了多次字符替换后，那么解密的的时候会得到什么结果呢？<br>我们将上面的替换后的base64编码<br>“EsGEcb8w6cDEshNDdhMzc3SUpjYzi8NEl8YWgzYTN8OTijN0ozNGNKNHIwZeZ+ISpeQGo4Ngkk”<br>拿去网上进行解密，发现解密出来的要么是乱码，要么就是提示字符串不是base64编码。如下图：</p>
<img src="/2019/12/07/%E5%A6%82%E4%BD%95%E8%AE%A9MD5%E5%8A%A0%E5%AF%86%E6%9B%B4%E5%8A%A0%E5%AE%89%E5%85%A8%EF%BC%9F/20161128210959.png" class="" title="base64加密">
<img src="/2019/12/07/%E5%A6%82%E4%BD%95%E8%AE%A9MD5%E5%8A%A0%E5%AF%86%E6%9B%B4%E5%8A%A0%E5%AE%89%E5%85%A8%EF%BC%9F/20161128211030.png" class="" title="base64解码">
<p>这样一来，我想应该暂时密码是很难被破解的了吧，如果你还害怕不安全，那么再对base64编码后的的内容进行长度截取、或在替换后再进行进行MD5加密一次。</p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>一般网站对密码要求不是很高，且有些网站还是明文存储密码，这样对用户的隐私安全造成了不利的因素，但是对于大型网站来说，保证用户数据安全才是硬道理。但所有的加密都只是相对安全的，没有绝对的安全。</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>base64</tag>
        <tag>Md5</tag>
      </tags>
  </entry>
  <entry>
    <title>JQUERY插件之SCROLLTOANYWHERE</title>
    <url>/2019/12/07/JQUERY%E6%8F%92%E4%BB%B6%E4%B9%8BSCROLLTOANYWHERE/</url>
    <content><![CDATA[<p>闲着无聊，自己写了一款jQuery插件，名字就叫ScrollToAnyWhere，下面来介绍下。<br>github项目地址：<a href="https://github.com/king2088/jquery.ScrollToAnyWhere" target="_blank" rel="noopener">https://github.com/king2088/jquery.ScrollToAnyWhere</a><br>jquery.ScrollToAnyWhere.js是一个jQuery滚动插件，基本上，只要给出元素id或class，即可实现滚动。其中包含了，滚动到顶部(Scroll to Top)、滚动到底部(Scroll to Bottom)、滚动到任意位置(Scroll to AnyWhere)。</p>
<h2 id="兼容性-Browser-Compatibility"><a href="#兼容性-Browser-Compatibility" class="headerlink" title="兼容性 Browser Compatibility"></a>兼容性 Browser Compatibility</h2><p>什么，你还在用IE6？一个插件，大家都很在乎兼容性，本人鄙视IE，因此仅支持jQuery 2.0版本以上的jQuery版本，2.0版本以下未进行过测试，IE10以下浏览器未进行测试。不支持IE9及以下版本浏览器。<br>IE9- NO WAY.<br>jquery library 2.0+</p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>1、导入jQuery文件 Import jQuery library</p>
<p>在html代码head或者body标签中引入jQuery库和jquery.ScrollToAnyWhere.js<br>Include jquery library and jquery.ScrollToAnyWhere.js in html tag for head or body</p>
<a id="more"></a>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>jquery.ScrollToAnyWhere.js demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"../css/ScrollToAnyWhere.css"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.ScrollToAnyWhere.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--or--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--html代码内容......--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.ScrollToAnyWhere.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure>
<p>2、使用方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">'selector'</span>).ScrollToAnyWhere(op,elements,options);</span></pre></td></tr></table></figure>
<p>op有3个值，分别是‘top’，‘down’，‘anywhere’，分别代表‘上’，‘下’，‘任意位置’<br>elements为需要滚动到的位置元素id或class名称，必须带有‘.’与‘#’<br>options有3个固定名称，值可以任意改变。分别是’offset’，’offset_opacity’，’times’，分别代表‘距离顶部距离（当距离顶部为多少时，淡出相应的图标、文字）’，‘滚动条滚动到的位置（到达此位置时，图标或文字自动透明）’，‘滚动速度’</p>
<p>3、滚动到顶部(Scroll to Top)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--html代码内容......--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.ScrollToAnyWhere.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">$(<span class="string">'.goTop'</span>).ScrollToAnyWhere(<span class="string">'top'</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure>
<p>4、滚动到底部(Scroll to Bottom)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--html代码内容......--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.ScrollToAnyWhere.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    $(<span class="string">'.goDown'</span>).ScrollToAnyWhere(<span class="string">'down'</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure>
<p>滚动到任意位置(Scroll to AnyWhere)<br>使用方法为$(selector).ScrollToAnyWhere(‘anywhere’,selector),第一个selector为当前产生事件的元素，第二个selector则为将要滚动到的元素。两个selector都需要填写正确的class与id名称，如$(‘#div’).ScrollToAnyWhere(‘anywhere’,’.class’)或$(‘#div’).ScrollToAnyWhere(‘anywhere’,’#class’)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">//html代码内容......</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.ScrollToAnyWhere.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    $(<span class="string">'.goComments'</span>).ScrollToAnyWhere(<span class="string">'anywhere'</span>,<span class="string">'.comments'</span>); </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure>
<p>自定义可选参数(options)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--html代码内容......--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.ScrollToAnyWhere.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    $(<span class="string">'.custom'</span>).ScrollToAnyWhere(<span class="string">'anywhere'</span>,<span class="string">'.test'</span>,&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">        <span class="string">'offset'</span>:<span class="number">500</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">        <span class="string">'offset_opacity'</span>:<span class="number">1500</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">        <span class="string">'times'</span>:<span class="number">50</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>Jquery</tag>
        <tag>插件</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVA使用GSON生成JSON数据</title>
    <url>/2019/12/07/JAVA%E4%BD%BF%E7%94%A8GSON%E7%94%9F%E6%88%90JSON%E6%95%B0%E6%8D%AE/</url>
    <content><![CDATA[<p>JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式。它基于ECMAScript的一个子集。 JSON采用完全独立于语言的文本格式。看到ECMAScript了吧，说明是基于JavaScript大库哦。所以在开发中一般Json主要用于传递数据，我们可以通过最基本的JavaScript获得json数据，当然也可以使用Java、C++等语言获取这个json的数据。<br>如果在做手机应用开发的话，你又不懂Java，你只知道html、JavaScript、css，那么开发手机应用最实用的就是json了吧。大概思路如下：<br>建立一个Web服务器，建立一个Web程序。使用JavaScript+css建立一个手机app，通过JavaScript获得Web程序生成的Json数据，即可在手机应用上展现出Web上的相关数据咯。具体做法，可以查看我另一篇文章，《利用Cordova，jqurey与wp-rest-api制作一个属于自己博客的移动APP》，今天我要说的是Java中利用google开发的Gson jar包直接获得json数据，相关方法如下：</p>
<h3 id="下载Gson-jar包"><a href="#下载Gson-jar包" class="headerlink" title="下载Gson jar包"></a>下载Gson jar包</h3><p>打开<a href="https://github.com/google/gson，找到如下图所示，点击Clone" target="_blank" rel="noopener">https://github.com/google/gson，找到如下图所示，点击Clone</a> or Download，再点击Download ZIP即可下载</p>
<img src="/2019/12/07/JAVA%E4%BD%BF%E7%94%A8GSON%E7%94%9F%E6%88%90JSON%E6%95%B0%E6%8D%AE/20160906124507.jpg" class="" title="github GSON">

<p>解压后，看到的都是源码，自己使用elipse或者netbeans等java开发工具，自动编译java文件，并打包成jar即可</p>
<a id="more"></a>
<p>将Gson jar包放到WEB-INF目录</p>
<h3 id="建立一个Java-sevelet，关键代码如下："><a href="#建立一个Java-sevelet，关键代码如下：" class="headerlink" title="建立一个Java sevelet，关键代码如下："></a>建立一个Java sevelet，关键代码如下：</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html;charset=GB2312"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>(PrintWriter out = response.getWriter())&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ExecuteDB DB = <span class="keyword">new</span> ExecuteDB();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    String sql = <span class="string">"select * from articles"</span>;<span class="comment">//SQL语句，查询获得数据库内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    ResultSet rs = DB.exeQuery(sql);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    JsonObject object = <span class="keyword">new</span> JsonObject();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    JsonArray array = <span class="keyword">new</span> JsonArray();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">while</span> (rs.next()) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        JsonObject ob = <span class="keyword">new</span> JsonObject();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ob.addProperty(<span class="string">"articleid"</span>, rs.getInt(<span class="string">"articleid"</span>));<span class="comment">//获得数据库字段为articleid的内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        ob.addProperty(<span class="string">"title"</span>, rs.getString(<span class="string">"title"</span>));<span class="comment">//获得数据库字段为title的内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        ob.addProperty(<span class="string">"content"</span>, rs.getString(<span class="string">"content"</span>).replace(<span class="string">"&amp;lt;"</span>, <span class="string">"&amp;lt;"</span>).replace(<span class="string">"&amp;gt;"</span>, <span class="string">"&amp;gt;"</span>));</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ob.addProperty(<span class="string">"createtime"</span>, rs.getString(<span class="string">"createtime"</span>));&lt;br&gt;array.add(ob);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    object.add(<span class="string">"Article"</span>, array);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    out.print(object.toString());<span class="comment">//使用jsonp进行访问json数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;<span class="keyword">catch</span>(Exception ex)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    System.out.println(ex.toString());</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<img src="/2019/12/07/JAVA%E4%BD%BF%E7%94%A8GSON%E7%94%9F%E6%88%90JSON%E6%95%B0%E6%8D%AE/20160906130319.jpg" class="" title="java生成json">]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Json</tag>
        <tag>Gson</tag>
      </tags>
  </entry>
  <entry>
    <title>JQ使用AJAX传递参数乱码解决方法</title>
    <url>/2019/12/07/JQ%E4%BD%BF%E7%94%A8AJAX%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>JQ与JAVA（Java使用GBK编码）使用GET传递参数总是出现乱码，网上找了很多解决办法，比如修改tomcat的sever.xml等都试了但是没有成功，最终使用encodeURI与decode就可以解决乱码问题。下面请看代码：</p>
<h2 id="JQ代码："><a href="#JQ代码：" class="headerlink" title="JQ代码："></a>JQ代码：</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注册表单ajax查询用户名是否可用</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$(<span class="string">'input[name=uname]'</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   $.ajax(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       type:<span class="string">'GET'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">       url:<span class="string">'&lt;%=basePath%&gt;NameChek.Tao'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">       dataType:<span class="string">'html'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">       data:<span class="string">'uname='</span>+<span class="built_in">encodeURI</span>(<span class="built_in">encodeURI</span>($(<span class="keyword">this</span>).val())),</span></pre></td></tr><tr><td class="code"><pre><span class="line">       beforeSend:<span class="function"><span class="keyword">function</span>(<span class="params">XMLHttpRequest</span>)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function">       </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">           $(<span class="string">'#AjaxUname'</span>).text(<span class="string">'正在查询'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">           <span class="comment">//Pause(this,100000);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">       &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">       success:<span class="function"><span class="keyword">function</span> (<span class="params">response,status,xhr</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       $(<span class="string">'#AjaxUname'</span>).html(response);</span></pre></td></tr><tr><td class="code"><pre><span class="line">       &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>
<h2 id="Java-sevelet中的代码"><a href="#Java-sevelet中的代码" class="headerlink" title="Java sevelet中的代码"></a>Java sevelet中的代码</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span></pre></td></tr><tr><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html;charset=GB2312"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">"GB2312"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">String xuname = request.getParameter(<span class="string">"username"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">String uname =URLDecoder.decode(xuname,<span class="string">"utf-8"</span>);</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Jquery</tag>
        <tag>乱码</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVA获得CLASSES、WEB-INF目录</title>
    <url>/2019/12/07/JAVA%E8%8E%B7%E5%BE%97CLASSES%E3%80%81WEB-INF%E7%9B%AE%E5%BD%95/</url>
    <content><![CDATA[<p>众所周知，servlet、JSP获得当前目录，我们可以使用System.getProperty(“user.dir”)或者request.getRealPath(“/“)还有request.getContextPath()等方法，但是今天要说的是在JavaBean里面如何获得classes及WEB-INF目录</p>
<h2 id="获取classes目录可以使用以下几个方法："><a href="#获取classes目录可以使用以下几个方法：" class="headerlink" title="获取classes目录可以使用以下几个方法："></a>获取classes目录可以使用以下几个方法：</h2><h3 id="使用this-getClass"><a href="#使用this-getClass" class="headerlink" title="使用this.getClass()"></a>使用this.getClass()</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.getClass().getClassLoader().getResource(<span class="string">""</span>).getPath();</span></pre></td></tr></table></figure>
<p>可以直接获得classes目录，比如C:/xampp/tomcat/webapp/root/WEB-INF/classes<br>如果要获得当前文件所在目录或者说是当前classes所在目录可以使用下面的方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.getClass().getResource(<span class="string">""</span>).getPath().toString();</span></pre></td></tr></table></figure>
<p>可以获得file:/C:/xampp/tomcat/webapp/root/WEB-INF/classes/com/db</p>
<h3 id="使用Thread"><a href="#使用Thread" class="headerlink" title="使用Thread"></a>使用Thread</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Thread.currentThread().getContextClassLoader().getResource(<span class="string">""</span>).toString();</span></pre></td></tr></table></figure>
<p>也可以直接获得classes目录，如file:/C:/xampp/tomcat/webapp/root/WEB-INF/classes</p>
<h2 id="我们要如何才能获得WEB-INF目录呢？"><a href="#我们要如何才能获得WEB-INF目录呢？" class="headerlink" title="我们要如何才能获得WEB-INF目录呢？"></a>我们要如何才能获得WEB-INF目录呢？</h2><p>因为没有一个专门获取WEB-INF目录的，因此我们就得使用替换replace的方法将上面获得的classes目录中的相关信息替换掉，就可以得出WEB-INF目录了。<br>代码如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDir</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        String path1 = Thread.currentThread().getContextClassLoader().getResource(<span class="string">""</span>).toString();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//上面的path1获得file:/C:/xxxx/xxx/xxx/classes/结构的目录，我们需要将file:/去掉,并且去掉classes/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        path1=path1.replace(<span class="string">"/"</span>, <span class="string">"\");</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        // 将/换成\(windows下，linux下请将此处注释)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        path1=path1.replace("</span>file:<span class="string">", "</span><span class="string">");</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        //去掉file:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        path1=path1.replace("</span>classes\<span class="string">", "</span><span class="string">"); </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        //去掉class\(linux下由于不需要将“/”转换为"</span>\<span class="string">"因此linux下应该修改为“classes/”而不是classes\\)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        path1=path1.substring(1); </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        //去掉第一个\,如file:/中的“/”去掉</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        System.out.println("</span>Thread:<span class="string">"+path1);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">    &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Classes</tag>
        <tag>WEB-INF</tag>
      </tags>
  </entry>
  <entry>
    <title>利用Cordova，JQ与WP-REST-API制作一个属于自己博客的移动APP</title>
    <url>/2019/12/07/%E5%88%A9%E7%94%A8Cordova%EF%BC%8CJQ%E4%B8%8EWP-REST-API%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%A7%BB%E5%8A%A8APP/</url>
    <content><![CDATA[<p>你有一个自己的WordPress博客？想要制作一个个人博客的APP吗？这样一个APP要怎么才能实现？其实可以直接通过HTML+css的方法直接实现，大家应该听说过PhoneGap这个东东了吧，PhoneGap简单的说就是让一些专门做前端开发的开发者通过简单的HTML与CSS及javascript代码来实现一个手机端的APP，目前PhoneGap已将相应的核心技术贡献给了Apache，Apache利用PhoneGap的核心技术，又重新塑造了一个名为cordova的APP开发工具，下面重点介绍下Cordova。</p>
<h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><h3 id="Cordova"><a href="#Cordova" class="headerlink" title="Cordova"></a>Cordova</h3><p>首先Cordova为Apache一个开源项目，主要应用于手机端APP，主要通过HTML、CSS以及javascript这类基本的前端开发语言来进行开发和功能的实现。<br>Cordova提供了一组设备相关的API，通过这组API，移动应用能够以JavaScript访问原生的设备功能，如摄像头、麦克风等。<br>Cordova还提供了一组统一的JavaScript类库，以及为这些类库所用的设备相关的原生后台代码。<br>Cordova支持如下移动操作系统：iOS, Android,ubuntu phone os, Blackberry, Windows Phone, Palm WebOS, Bada 和 Symbian。</p>
<a id="more"></a>
<h3 id="jqurey"><a href="#jqurey" class="headerlink" title="jqurey"></a>jqurey</h3><p>jqurey这里就不用介绍了，做前端的应该都知道这个javascript开源库。</p>
<h3 id="wp-reset-api"><a href="#wp-reset-api" class="headerlink" title="wp-reset-api"></a>wp-reset-api</h3><p>首先需要在WordPress后台安装wp-reset-api插件，此插件有相应的说明文件和使用方法，相关文档也可以到WordPress官方查看。</p>
<h3 id="NetBeans、elipse、Visual-Studio"><a href="#NetBeans、elipse、Visual-Studio" class="headerlink" title="NetBeans、elipse、Visual Studio"></a>NetBeans、elipse、Visual Studio</h3><p>目前这几个开发工具最新版都集成了Cordova开发环境，因此你不用再去搭建另一个开发环境。</p>
<h3 id="开发思路"><a href="#开发思路" class="headerlink" title="开发思路"></a>开发思路</h3><p>首先wp-reset-api插件是一个WordPress程序的json插件，我们可以通过此json插件，利用jqurey来将json数据读出，并使用html与CSS将其数据一一显示和布局出来。</p>
<h2 id="相关重要代码"><a href="#相关重要代码" class="headerlink" title="相关重要代码"></a>相关重要代码</h2><h3 id="html页面"><a href="#html页面" class="headerlink" title="html页面"></a>html页面</h3><p>正如咋们进行手机端web前端开发一样，必须让其页面设计为响应式，一定要记得html页面中加入如下代码</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"</span>&gt;</span></span></pre></td></tr></table></figure>
<h3 id="jqurey获取json相关代码"><a href="#jqurey获取json相关代码" class="headerlink" title="jqurey获取json相关代码"></a>jqurey获取json相关代码</h3><p>获取所有文章的jqurey代码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//以下javascript代码主要为获取WordPress文章wp-reset-api获取文章使用的是http://www.xxx.com/wp-json/posts的方式进行获取文章列表json</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">getPosts: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'app.getPosts'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> rootURL = <span class="string">'http://www.egtch.com/wp-json'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    $.ajax(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        type: <span class="string">'GET'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        url: rootURL + <span class="string">'/posts'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dataType: <span class="string">'json'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            $.each(data, <span class="function"><span class="keyword">function</span>(<span class="params">index, value</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                $(<span class="string">'ul.topcoat-list'</span>).append(<span class="string">'&lt;li class="topcoat-list__item"&gt;'</span> +</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="string">'&lt;h3&gt;&lt;a class="view-link" href="#'</span>+value.ID+<span class="string">'"&gt;'</span>+value.title+<span class="string">'&lt;/a&gt;&lt;/h3&gt;'</span> +</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="string">'&lt;p&gt;'</span>+value.excerpt+<span class="string">'&lt;/p&gt;&lt;/li&gt;'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        error: <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(error);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//以下代码为显示文章内容的javascript所通过相应的json文章ID获取文章内容wp-reset-api使用的方法为http://www.xxx.com/wp-json/posts/103，103即文章ID</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">getSinglePost: <span class="function"><span class="keyword">function</span>(<span class="params">postID</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'getSinglePost'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> rootURL = <span class="string">'http://www.egtch.com/wp-json'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    $.ajax(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        type: <span class="string">'GET'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        url: rootURL + <span class="string">'/posts/'</span> + postID,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dataType: <span class="string">'json'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(data);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            $(<span class="string">'.single-post .title'</span>).append(data.title);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            $(<span class="string">'.single-post .content'</span>).append(data.content);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        error: <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(error);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr></table></figure>

<h2 id="4、相关效果"><a href="#4、相关效果" class="headerlink" title="4、相关效果"></a>4、相关效果</h2><p><img src="/2019/12/07/%E5%88%A9%E7%94%A8Cordova%EF%BC%8CJQ%E4%B8%8EWP-REST-API%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%A7%BB%E5%8A%A8APP/20150814002131.png" class="" title="利用Cordova，JQ与WP-REST-API制作一个属于自己博客的移动APP}&lt;&#x2F;p&gt;">]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>APP</tag>
        <tag>Cordova</tag>
        <tag>jquery</tag>
        <tag>WP REST API</tag>
      </tags>
  </entry>
  <entry>
    <title>Cordova开发环境配置</title>
    <url>/2019/12/07/CORDOVA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p>Cordova开发环境，Cordova是Apache的一个开源项目，主要用于手机端APP制作，通过简单的html+css+js即可以制作出与原生APP一样的手机APP。下面就来说下如何搭建Cordova开发环境。</p>
<h2 id="1、安装JDK"><a href="#1、安装JDK" class="headerlink" title="1、安装JDK"></a>1、安装JDK</h2><p>请自行百度或者google一下吧。</p>
<h2 id="2、安装node-js"><a href="#2、安装node-js" class="headerlink" title="2、安装node.js"></a>2、安装node.js</h2><p>要是大家不知道node.js是什么东西，可以google一下，到其官方网站下载并且安装即可，官方网址为<a href="https://nodejs.org" target="_blank" rel="noopener">https://nodejs.org</a></p>
<h2 id="3、安装git"><a href="#3、安装git" class="headerlink" title="3、安装git"></a>3、安装git</h2><p>到<a href="https://git-scm.com/官方网址去下载git软件，并且安装。" target="_blank" rel="noopener">https://git-scm.com/官方网址去下载git软件，并且安装。</a></p>
<h2 id="4、打开node-js的命令提示符，或者直接打开widows的命令提示符即可"><a href="#4、打开node-js的命令提示符，或者直接打开widows的命令提示符即可" class="headerlink" title="4、打开node.js的命令提示符，或者直接打开widows的命令提示符即可"></a>4、打开node.js的命令提示符，或者直接打开widows的命令提示符即可</h2><p>然后输入</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g cordova</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>回车即可<br>不过要等待10多分钟左右才能下载完成。<br>完成后即可看到cordova的相关信息和版本。<br>要测试是否安装成功可以在命令提示符里输入下面的代码</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cordova</span></pre></td></tr></table></figure>
<p>如果出现以下字符则说明正确<br><img src="/2019/12/07/CORDOVA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/20150905170121.png" class="" title="cordova 命令展示}&lt;&#x2F;p&gt;">]]></content>
      <categories>
        <category>前端开发</category>
      </categories>
      <tags>
        <tag>APP</tag>
        <tag>Cordova</tag>
        <tag>开发环境</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVA在WINDOWS下对MYSQL备份与恢复</title>
    <url>/2019/12/07/JAVA%E5%9C%A8WINDOWS%E4%B8%8B%E5%AF%B9MYSQL%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/</url>
    <content><![CDATA[<p>Java语言跟我确实很有缘，但是我又觉得很无助，我以刚开始接触编程类语言，首先接触的就是Java，但是令我觉得懊悔的是，当时学习条件并不是很好，各方面并未得到更好的提升，对于Java，我仅仅只属于入门级别的枪手。</p>
<p>平时有时间就随便折腾下而已。今天随便写了个windows下Java对MySQL的备份与恢复，简单实用，不过却并不完善，希望朋友们给予建议。如果你是初学者，请先了解下MySQL备份恢复的相关语句，可以参考我之前的一篇文章《<a href="/2019/12/07/MYSQL数据库备份还原命令/">MySQL数据库备份还原命令</a>》。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.amysql;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mysql</span></span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String str = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*备份MySQL方法*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">backup</span><span class="params">()</span></span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        str = <span class="string">"mysqldump -u root -p123456 --opt wordpress &gt; c:/wordpress.sql"</span>;<span class="comment">/*备份MySQL的SQL语句，并且将其备份于C盘根目录下*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        Runtime rt = Runtime.getRuntime();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        rt.exec(<span class="string">"cmd /c"</span> + str);<span class="comment">/*启动widows下的CMD来执行命令*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(<span class="string">"successly!"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        e.printStackTrace();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        System.out.println(<span class="string">"something wrong!"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/*将SQL文件恢复到数据库*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">()</span></span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        str = <span class="string">"mysql -u root -p123456 wordpress &gt; c:/wordpress.sql"</span>;<span class="comment">/*将SQL文件恢复到数据库的SQL语句*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        Runtime rt = Runtime.getRuntime();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            rt.exec(<span class="string">"cmd /c"</span> + str);<span class="comment">/*启动widows下的CMD来执行命令*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            System.out.println(<span class="string">"restore successly!"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            e.printStackTrace();</span></pre></td></tr><tr><td class="code"><pre><span class="line">            System.out.println(<span class="string">"restore fail!"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>windows</tag>
        <tag>mysql</tag>
        <tag>备份恢复</tag>
      </tags>
  </entry>
  <entry>
    <title>MYSQL数据库备份还原命令</title>
    <url>/2019/12/07/MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<p>每一个数据库，都有着自己独特的一面，而每一个数据库在相应的代码操作上也是不尽相同的，对于web开发人员来说，更多地了解数据库，更多地掌握相关数据库SQL语句的编写方式才是更为重要的。接下来，在MySQL中备份与还原数据库的相关命令，更是应该让你大饱眼福。</p>
<h2 id="备份MySQL数据库的命令"><a href="#备份MySQL数据库的命令" class="headerlink" title="备份MySQL数据库的命令"></a>备份MySQL数据库的命令</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword databasename &gt; backupfile.sql</span></pre></td></tr></table></figure>
<p>备份MySQL数据库为带删除表的格式备份MySQL数据库为带删除表的格式，能够让该备份覆盖已有数据库而不需要手动删除原有数据库。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump <span class="comment">---add-drop-table -uusername -ppassword databasename &gt; backupfile.sql</span></span></pre></td></tr></table></figure>
<p>直接将MySQL数据库压缩备份</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword databasename | gzip &gt; backupfile.sql.gz</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>备份MySQL数据库某个(些)表</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword databasename specific_table1 specific_table2 &gt; backupfile.sql</span></pre></td></tr></table></figure>
<p>同时备份多个MySQL数据库</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword <span class="comment">--databases databasename1 databasename2 databasename3 &gt; multibackupfile.sql</span></span></pre></td></tr></table></figure>
<p>仅仅备份数据库结构</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump <span class="comment">--no-data --databases databasename1 databasename2 databasename3 &gt; structurebackupfile.sql</span></span></pre></td></tr></table></figure>
<p>备份服务器上所有数据库</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump <span class="comment">--all-databases  allbackupfile.sql</span></span></pre></td></tr></table></figure>
<p>还原MySQL数据库的命令</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mysql -hhostname -uusername -ppassword databasename &lt; backupfile.sql</span></pre></td></tr></table></figure>
<p>还原压缩的MySQL数据库</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">gunzip &lt; backupfile.sql.gz | mysql -uusername -ppassword databasename</span></pre></td></tr></table></figure>
<p>将数据库转移到新服务器</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysqldump \-uusername \-ppassword databasename \| mysql \<span class="comment">--host=*.*.*.\* \-C databasename</span></span></pre></td></tr></table></figure>
<h2 id="GZIP压缩备份"><a href="#GZIP压缩备份" class="headerlink" title="GZIP压缩备份"></a>GZIP压缩备份</h2><p>备份并用gzip压缩：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mysqldump &lt; mysqldump options&gt; | gzip &gt; outputfile.sql.gz</span></pre></td></tr></table></figure>
<p>从gzip备份恢复：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">gunzip &lt; outputfile.sql.gz | mysql &lt; mysql options&gt;</span></pre></td></tr></table></figure>
<p>备份并用bzip压缩：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mysqldump &lt; mysqldump options&gt; | bzip2 &gt; outputfile.sql.bz2</span></pre></td></tr></table></figure>
<p>从bzip2备份恢复:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">bunzip2 &lt; outputfile.sql.bz2 | mysql &lt; mysql options&gt;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Mysql</category>
      </categories>
      <tags>
        <tag>MYSQL</tag>
        <tag>命令</tag>
        <tag>备份</tag>
        <tag>数据库</tag>
        <tag>还原</tag>
      </tags>
  </entry>
  <entry>
    <title>JSP+FCK编辑器使用说明及中文问题</title>
    <url>/2019/12/07/JSP-FCK%E7%BC%96%E8%BE%91%E5%99%A8%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E5%8F%8A%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>2008年，我自己配置了一个JSP+FCK编辑器的实例，没有想到突然疯传于网络，很多朋友都通过网络来寻找配置好的编辑器。时隔两年后，任然有人通过网络与我取得联系，一直到现在，我时不时的会接到一些邮件，主要是索要JSP+FCK配置好的编辑器，也有朋友通过QQ加我，向我索要。说实话，jsp+fck配置好的，目前已经被我删除了，当时我花了不少时间去研究JSP+FCK，主要就是由于FCK编辑器是一款免费并可以自己进行插件开发，其使用也方便，功能超级强大。不过这几年过去了，我一直没有再做java开发了，而是直接转为做SEO、PHP开发，由此我也向大家道歉，我没有一一和及时回复大家的相应问题，那么今天我就在此再次为大家提供有关于JSP+FCK编辑器方面的知识。</p>
<p>目前FCK官方一直都有java版本FCK，如今FCK早已更名为了CKEditor了，之前的FCK也已经很多年木有更新了，大家要是下载了FCK JAVA版的，里面都会包含着很多实用实例，只需要下载FCK官方的JAVA版本.war文件放到tomcat目录即可运行相应的实例了。</p>
<p>由于近来FCK官方对FCK JAVA版编辑器的更新感觉是越来越慢了，而目前我所看到最新版的还是2010-01-05的FCK2.6版本。FCK官方也进行了其他编辑器的开发，那就是CKEditor，所以很多朋友去网上搜索FCK编辑器的时候，往往都是只能搜索到CKEditor，所以很难下载到自己想要的FCK官方版，一般的朋友就直接去百度一下随便下载个就完事了。这里我得提醒大家，随意下载的FCK编辑器可能是精简版的，有些东西被删除了，或者你下载到的基本是老版本的，有些java类库也已经使用不是很频繁了。由此我就给大家一个官方下载地址，希望大家都能下载到<a href="http://sourceforge.net/projects/fckeditor/files/FCKeditor.Java/" target="_blank" rel="noopener">http://sourceforge.net/projects/fckeditor/files/FCKeditor.Java/</a> 点击此下载地址后，你可以选择相应的版本进行下载你需要的FCK，如图</p>
<a id="more"></a>
<img src="/2019/12/07/JSP-FCK%E7%BC%96%E8%BE%91%E5%99%A8%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E5%8F%8A%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/20150624233238.png" class="" title="FCK editor">

<p>那么建议大家尽量选择最新的2.6版的进行下载，如果你使用的是tomcat，那么就下载的.war文件，或者下载zip格式的。并将.war文件放到tomcat下webapps目录即可，如果你下载的zip那么直接解压缩到tomcat下webapps目录，然后将目录名字改为fck，然后打开浏览器输入<a href="http://localhost:8080/fck" target="_blank" rel="noopener">http://localhost:8080/fck</a> 即可访问到FCK的实例。</p>
<p>你可以对这些实例进行相应的操作，比如上传图片、上传flash、插入各式各样的媒体等等操作，那么就说明，官方版本中的实例是没有任何问题的，我们可以直接根据官方实例中的相应使用方法来进行对FCK进行使用，而无需再对其进行配置了，完全没有必要再进行配置了。因为2.6版本与2.4版本的区别很大，所以2.4版本中才需要进行相应的配置。</p>
<h2 id="编写实例"><a href="#编写实例" class="headerlink" title="编写实例"></a>编写实例</h2><p>那么下面我给大家写一个例子，就可以直接使用，而不需要再进行修改，大家可以打开FCK根目录下的jsp目录，随便找到一个jsp文件打开，都可以发现，调用的方式都不一样，那么我们该选择什么样的方式进行开发才简便呢？我个人觉得第2个例子比较简单，所以我选择了第2个例子，其中最重要的调用代码如下：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> %&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.fckeditor.net"</span> prefix=<span class="string">"FCK"</span> %&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;head&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;title&gt;FCKeditor - JSP 实例&lt;/title&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/head&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;h1&gt;FCKeditor - JSP 实例&lt;/h1&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"../sampleposteddata.jsp"</span> method=<span class="string">"post"</span> target=<span class="string">"_blank"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;FCK:editor instanceName=<span class="string">"EditorDefault"</span> height=<span class="string">"350px"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;jsp:attribute name="value"&gt;&lt;/jsp:attribute&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/FCK:editor&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;br /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"Submit"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/form&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/html&gt;</span></pre></td></tr></table></figure>
<p>从以上代码中来看，首先整个文档中与FCK至关重要的几段代码如下：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.fckeditor.net"</span> prefix=<span class="string">"FCK"</span> %&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;FCK:editor instanceName=<span class="string">"EditorDefault"</span> height=<span class="string">"350px"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//这段代码中instanceName="EditorDefault"主要是命名此FCK的名字，就像命名一个textarea的名字</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;jsp:attribute name="value"&gt;&lt;/jsp:attribute&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//这段代码之间主要是我们在编辑器中插入的内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/FCK:editor&gt;</span></pre></td></tr></table></figure>
<p>以上代码为最主要代码，其中&lt;FCK:editor instanceName=”EditorDefault”&gt;中还有很多参数，比如heigh、width、path、value等值，你可以直接使用。</p>
<p>以上实例是非常简单的，我们只需要将那两个重要的代码段添加到jsp文档中即可实现调用FCK编辑器的功能，而且我们并不需要再次进行对FCK中的相应的js配置，直接就可以使用。</p>
<h2 id="中文问题"><a href="#中文问题" class="headerlink" title="中文问题"></a>中文问题</h2><p>大家都知道FCK上传中对中文支持的不是很好，有时候会显示乱码，或者会无法显示中文名字的文件，其解决方法其实不是很难，主要就是转码的问题。</p>
<p>1、我们首先到官方下载FCK源码包fckeditor-java-2.6-src.zip。</p>
<p>2、在你的工程目录下新建net.fckeditor.connector包，复制fckeditor-java-2.6-src\java-core\src\main\java\net\fckeditor\connector\Dispatcher.java文件到该包下。</p>
<p>3、编辑该文件 在doGet成员方法下找到：String newFolderNameStr = request.getParameter(“NewFolderName”); 在后面添加以下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String temp= <span class="keyword">new</span> String(newFolderNameStr.getBytes(“iso8859-<span class="number">1</span>″),”utf-<span class="number">8</span>″); newFolderNameStr = temp;</span></pre></td></tr></table></figure>
<p>4、修改上传文件的文件名【使名称变为当前时间（也可以使用UUID构造名称）】避免出现中文：<br>找到doPost方法下的： String fileName = FilenameUtils.getName(uplFile.getName()); 在后面添加以下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String suffix = fileName.substring(fileName.lastIndexOf(“.”)); Calendar cad = Calendar.getInstance(); fileName = String.valueOf(cad.get(Calendar.YEAR))+String.valueOf(cad.get(Calendar.MONTH))+String.valueOf(cad.get(Calendar.DAY_OF_MONTH))+String.valueOf(cad.get(Calendar.HOUR_OF_DAY))+String.valueOf(cad.get(Calendar.MINUTE))+String.valueOf(cad.get(Calendar.SECOND)); fileName = fileName + suffix;</span></pre></td></tr></table></figure>
<p>5、解压java-core-2.6.jar文件，并部署你的项目，在部署后的classes文件夹下找到你编译好的Dispatcher.class文件替换 java-core-2.6.jar解压后的net.fckeditor.connector文件夹下的Dispatcher.class，并且重新打包该文件。</p>
<p>6、重新将新打包生成的java-core-2.6.jar包导入到项目中，重新发布即可</p>
<p>打包步骤：</p>
<p>1、搭建jdk环境：在环境变量的path中将jdk所目录下的bin目录的路径加入到path中（否则在运用jar命令进行打包时会出现不是内部或外部命令的提示）<br>2、在cmd下cd到替换文件后了的fckeditor-java-core-2.6目录下<br>3、在命令行输入：jar cvf java-core-2.6.jar <em>.</em>即可</p>
<h2 id="最后的唠叨"><a href="#最后的唠叨" class="headerlink" title="最后的唠叨"></a>最后的唠叨</h2><p>在FCK中其实我们并不需要去配置任何东西了，我们主要做的就是让其支持中文文件上传即可，根据FCK官方提供的java版本中，其已经有了很多实例了，而我上面给出的仅仅是其中一种是有的方法，也是最常用的一种方法，大家可以根据自己的需求从中获取你需要的方法，然后直接进行使用即可。而没有必要再次进行配置，官方的FCK配置已经很完美了</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>jsp</tag>
        <tag>fck</tag>
        <tag>中文</tag>
      </tags>
  </entry>
  <entry>
    <title>几种NGINX服务器防盗链详细设置</title>
    <url>/2019/12/07/%E5%87%A0%E7%A7%8DNGINX%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%98%B2%E7%9B%97%E9%93%BE%E8%AF%A6%E7%BB%86%E8%AE%BE%E7%BD%AE/</url>
    <content><![CDATA[<p>使用过VPS的站长应该都了解Nginx服务器了，Nginx以其强大的性能著称。今天就来给大家说说Nginx服务器防盗链的设置。<br>根据一些网上提供的资料以及实验成功的防盗链设置，下面我整理了一下，和大家一起分享。</p>
<h2 id="1、Nginx一般常用的防盗链设置"><a href="#1、Nginx一般常用的防盗链设置" class="headerlink" title="1、Nginx一般常用的防盗链设置"></a>1、Nginx一般常用的防盗链设置</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> <span class="regexp">~* \.(gif|jpg|png|swf|flv|zip)$</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">valid_referers</span> <span class="literal">none</span> <span class="literal">blocked</span> www.yousite.com ;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">if</span> (<span class="variable">$invalid_referer</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^/</span> http://www.yousite.com/404.html;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">#return 404;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>gif|jpg|png|swf|flv|zip表示对gif、jpg、png、swf、flv、zip后缀的文件实行防盗链（可根据自己的需要进行修改）<br>对<a href="http://www.yousite.com这个来路进行判断" target="_blank" rel="noopener">www.yousite.com这个来路进行判断</a><br>if{}里面内容的意思是，如果来路不是指定来路就跳转到<a href="http://www.yousite.com/404.html页面。" target="_blank" rel="noopener">http://www.yousite.com/404.html页面。</a><br>假如将#删除，而且再将第4行代码删除，就直接返回404了。</p>
<a id="more"></a>
<h2 id="2、针对图片目录防止盗链"><a href="#2、针对图片目录防止盗链" class="headerlink" title="2、针对图片目录防止盗链"></a>2、针对图片目录防止盗链</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> /images/ &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">alias</span> /data/images/;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">valid_referers</span> <span class="literal">none</span> <span class="literal">blocked</span> server_names <span class="regexp">*.egtch.com</span> egtch.com ;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">if</span> (<span class="variable">$invalid_referer</span>) &#123;<span class="attribute">return</span> <span class="number">403</span>;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>alias：即为要防盗链的图片文件夹<br>valid_referers：即为防盗链文件所在的网站的域名<br>return：直接返回403错误，当然你也可以将其返回其他错误！</p>
<h2 id="3、ngx-http-accesskey-module"><a href="#3、ngx-http-accesskey-module" class="headerlink" title="3、ngx_http_accesskey_module"></a>3、ngx_http_accesskey_module</h2><p>使用第三方模块ngx_http_accesskey_module实现Nginx防盗链<br>实现方法如下：<br>1）下载NginxHttpAccessKeyModule模块文件：Nginx-accesskey-2.0.3.tar.gz；<br>2） 解压此文件后，找到nginx-accesskey-2.0.3下的config文件。编辑此文件：替换其中的”$HTTP_ACCESSKEY_MODULE”为”ngx_http_accesskey_module”；<br>3） 用一下参数重新编译nginx：<br>./configure –add-module=path/to/nginx-accesskey<br>4） 修改nginx的conf文件，添加以下几行：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> /download &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">accesskey</span> <span class="literal">on</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">accesskey_hashmethod</span> md5;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">accesskey_arg</span> <span class="string">"key"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">accesskey_signature</span> <span class="string">"mypass<span class="variable">$remote_addr</span>"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>其中：<br>accesskey为模块开关；<br>accesskey_hashmethod为加密方式MD5或者SHA-1；<br>accesskey_arg为url中的关键字参数；<br>accesskey_signature为加密值，此处为mypass和访问IP构成的字符串。<br>访问测试脚本download.php：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    $ipkey= md5(<span class="string">"mypass"</span>.$_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    $output_add_key=<span class="string">"&lt;a href=http://www.yousite.com/download/G3200507120520LM.rar?key="</span>.$ipkey.<span class="string">"&gt;download_add_key&lt;/a&gt;&lt;br /&gt;"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    $output_org_url=<span class="string">"&lt;a href=http://www.yousite.com/download/G3200507120520LM.rar&gt;download_org_path&lt;/a&gt;&lt;br /&gt;"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">echo</span> $output_add_key;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">echo</span> $output_org_url;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">?&gt;</span></span></pre></td></tr></table></figure>
<p>访问第一个download_add_key链接可以正常下载，第二个链接download_org_path会返回403 Forbidden错误。</p>
<h2 id="4、总结"><a href="#4、总结" class="headerlink" title="4、总结"></a>4、总结</h2><p>从以上3个方法来看，Nginx简单的防盗链技术也是很简单，不过高深一点的就属最后一种方法了，如果大家有兴趣可以研究研究最后一种方法，这种方法比较安全，不易被破解！</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>NGINX</tag>
        <tag>服务器</tag>
        <tag>防盗链</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVA创建MYSQL数据库表</title>
    <url>/2019/12/07/JAVA%E5%88%9B%E5%BB%BAMYSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8/</url>
    <content><![CDATA[<p>使用Java代码编写jsp页面，使之能够对数据库添加数据表，比如现在有一个名为database的数据库，我们想要通过某个页面来添加一张数据库表到database数据库中，该如何进行编写代码？</p>
<h2 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h2><p>1、首先我们需要配置一个可运行Java Web的环境。</p>
<p>2、需要使用Java连接MySQL数据库的驱动jar文件，并且将相应的jar驱动文件放到WEB-INF\lib文件夹下。</p>
<h2 id="二、创建数据库表的Java代码"><a href="#二、创建数据库表的Java代码" class="headerlink" title="二、创建数据库表的Java代码"></a>二、创建数据库表的Java代码</h2><p>1、创建一个jsp页面testmysql.jsp，在其顶部第一行代码处打上以下代码（此代码是调用java相应的类，并且让其页面为UTF-8）</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html; charset=utf-8"</span> language=<span class="string">"java"</span> <span class="keyword">import</span>=<span class="string">"java.io.*,java.sql.*"</span>%&gt;</span></pre></td></tr></table></figure>
<a id="more"></a>
<p>2、创建数据库表，并且连接数据库，执行创建数据库表</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;% String err;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Connection conn = <span class="keyword">null</span>;<span class="comment">//初始化Connection为null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//JDBC驱动加载</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">String driverName = <span class="string">"org.gjt.mm.mysql.Driver"</span>; <span class="comment">// MySQL JDBC数据库驱动</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class.forName(driverName);</span></pre></td></tr><tr><td class="code"><pre><span class="line">String sql = <span class="string">"CREATE TABLE mysql("</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_boolean BOOL, "</span> <span class="comment">// boolean数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_byte TINYINT, "</span> <span class="comment">// byte数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_short SMALLINT, "</span> <span class="comment">// short数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_int INTEGER, "</span> <span class="comment">// int数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_long BIGINT, "</span> <span class="comment">// long数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_float FLOAT, "</span> <span class="comment">// float数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_double DOUBLE PRECISION, "</span> <span class="comment">// double数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_bigdecimal DECIMAL(13,0), "</span> <span class="comment">// BigDecimal数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_string VARCHAR(254), "</span> <span class="comment">// String数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_date DATE, "</span> <span class="comment">// Date数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_time TIME, "</span> <span class="comment">// Time数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_timestamp TIMESTAMP, "</span> <span class="comment">// Timestamp数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_asciistream TEXT, "</span> <span class="comment">// AsciiStream数据类型 (&amp;lt; 2^16 bytes)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_binarystream LONGBLOB, "</span> <span class="comment">// BinaryStream数据类型 (&amp;lt; 2^32 bytes)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="string">"mysql_blob BLOB)"</span>; <span class="comment">// Blob数据类型 (&amp;lt; 2^16 bytes)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 创建数据库连接</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">String servername=request.getParameter(<span class="string">"servername"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">String mydatabase =request.getParameter(<span class="string">"mydatabase"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">String url = <span class="string">"jdbc:mysql://"</span> + servername + <span class="string">"/"</span> + mydatabase; <span class="comment">// 数据库连接地址</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">String serveruser=request.getParameter(<span class="string">"serveruser"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">String serverpassword=request.getParameter(<span class="string">"serverpassword"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">conn = DriverManager.getConnection(url, serveruser, serverpassword);</span></pre></td></tr><tr><td class="code"><pre><span class="line">Statement stmt = conn.createStatement();</span></pre></td></tr><tr><td class="code"><pre><span class="line">stmt.executeUpdate(sql);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">out.print(<span class="string">"找不到数据库驱动"</span>+e);<span class="comment">//错误处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">out.print(<span class="string">"发生错误,错误信息如下&amp;lt;br/&amp;gt;"</span>+e);<span class="comment">//错误处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">catch</span> (Exception ex) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">conn=<span class="keyword">null</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">err=ex.toString();</span></pre></td></tr><tr><td class="code"><pre><span class="line">System.out.println(err);<span class="comment">//错误处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">%&gt;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;% <span class="comment">//测试数据库连接是否正确</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(conn != <span class="keyword">null</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">out.println(<span class="string">"&lt;p align="</span>center<span class="string">"&gt;&lt;font mysqlor=blue&gt;数据库连接成功&lt;/font&gt;&lt;/p&gt;"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">else</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">out.println(<span class="string">"&lt;p align="</span>center<span class="string">"&gt;&lt;font mysqlor=red&gt;数据库连接失败&lt;/font&gt;&lt;/p&gt;"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">%&gt;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;%</span></pre></td></tr><tr><td class="code"><pre><span class="line">conn.close();<span class="comment">//关闭数据库连接</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">%&gt;;</span></pre></td></tr></table></figure>
<h2 id="三、jsp表单提交页面"><a href="#三、jsp表单提交页面" class="headerlink" title="三、jsp表单提交页面"></a>三、jsp表单提交页面</h2><p>创建一个首页index.jsp,代码如下：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html; charset=utf-8"</span> language=<span class="string">"java"</span> <span class="keyword">import</span>=<span class="string">"java.io.*"</span>%&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;head&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;title&gt;创建数据库连接及数据库表&lt;/title&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!--</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE1 &#123;font-size: <span class="number">12</span>px&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE3 &#123;color: #00CC00&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE5 &#123;color: #CCCC33&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE7 &#123;color: #99FF33&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE9 &#123;color: #99FFFF&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE11 &#123;color: #000066&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE12 &#123;font-size: 12px; color: #0033FF; &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.STYLE13 &#123;color: #0033FF&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">--&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/style&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/head&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;center&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"testmysql.jsp"</span> method=<span class="string">"post"</span> name=<span class="string">"form"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;table width=<span class="string">"292"</span> border=<span class="string">"0"</span> cellpadding=<span class="string">"4"</span> cellspacing=<span class="string">"4"</span> bordercolor=<span class="string">"#CCFFFF"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td colspan="2" bgcolor="#CCFFFF"&gt;&lt;div align="center" class="STYLE12"&gt;创建数据库连接及数据库表&lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;/tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td width="91" bgcolor="#CCFFFF"&gt;&lt;div align="right" class="STYLE12"&gt;数据库URL&lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td width=<span class="string">"177"</span> bgcolor=<span class="string">"#CCFFFF"</span>&gt;&lt;div align=<span class="string">"left"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"STYLE12"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;input name=<span class="string">"servername"</span> type=<span class="string">"text"</span> id=<span class="string">"servername"</span> value=<span class="string">"localhost"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;/tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td width="91" bgcolor="#CCFFFF"&gt;&lt;div align="right" class="STYLE12"&gt;数据库名称&lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td width=<span class="string">"177"</span> bgcolor=<span class="string">"#CCFFFF"</span>&gt;&lt;div align=<span class="string">"left"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"STYLE12"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;input name=<span class="string">"mydatabase"</span> type=<span class="string">"text"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;/tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td bgcolor="#CCFFFF"&gt;&lt;div align="right" class="STYLE12"&gt;数据库用户名&lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td bgcolor=<span class="string">"#CCFFFF"</span>&gt;&lt;div align=<span class="string">"left"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"STYLE12"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;input type=<span class="string">"text"</span> name=<span class="string">"serveruser"</span>  /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;/tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td bgcolor="#CCFFFF"&gt;&lt;div align="right" class="STYLE12"&gt;数据库密码&lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td bgcolor=<span class="string">"#CCFFFF"</span>&gt;&lt;div align=<span class="string">"left"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"STYLE12"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;input type=<span class="string">"password"</span> name=<span class="string">"serverpassword"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;/tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td bgcolor="#CCFFFF"&gt;&lt;div align="right"&gt;&lt;span class="STYLE1"&gt;&lt;span class="STYLE3"&gt;&lt;span class="STYLE5"&gt;&lt;span class="STYLE7"&gt;&lt;span class="STYLE9"&gt;&lt;span class="STYLE11"&gt;&lt;span class="STYLE13"&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;td bgcolor=<span class="string">"#CCFFFF"</span>&gt;&lt;div align=<span class="string">"center"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"STYLE12"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"测试并建立"</span> /&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;/div&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;/tr&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/table&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/form&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/center&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/html&gt;</span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>创建MYSQL</tag>
        <tag>数据库表</tag>
      </tags>
  </entry>
  <entry>
    <title>小内存VPS安装LNMP的优化，你做了吗？</title>
    <url>/2019/12/07/%E5%B0%8F%E5%86%85%E5%AD%98VPS%E5%AE%89%E8%A3%85LNMP%E7%9A%84%E4%BC%98%E5%8C%96%EF%BC%8C%E4%BD%A0%E5%81%9A%E4%BA%86%E5%90%97%EF%BC%9F/</url>
    <content><![CDATA[<img src="/2019/12/07/%E5%B0%8F%E5%86%85%E5%AD%98VPS%E5%AE%89%E8%A3%85LNMP%E7%9A%84%E4%BC%98%E5%8C%96%EF%BC%8C%E4%BD%A0%E5%81%9A%E4%BA%86%E5%90%97%EF%BC%9F/u=1087030622,884055929&fm=26&gp=0.jpg" class="" title="这是一个新的博客的图片的说明">

<p>很多做站的朋友，可能为了避免国内麻烦的备案程序，和我一样购买和使用国外的VPS，有很多新手对国外VPS的使用了解太少，虽然买了个512M内存的VPS或者256M内存的VPS，总觉得速度不行或者经常出现502错误等问题，那么今天就由我来告诉你，购买VPS后，要如何进行优化才能发挥VPS最大的性能。当然，购买后我建议大家都使用lnmp，而不要使用什么iis以及apache之类的服务器软件，因为小内存VPS使用iis以及apache的话你会觉得内存占用太大。</p>
<h2 id="1-优化CPU"><a href="#1-优化CPU" class="headerlink" title="1.优化CPU"></a>1.优化CPU</h2><p>先来优化CPU吧，使用命令cat /proc/cpuinfo看看自己的CPU是几核的，Linode虽然内存给的不多，但是CPU还是挺实在的，我这服务器的CPU是4核的，使用该命令可以看到processor 0，1，2，3。</p>
<p>确定了CPU之后，在Nginx的配置文件中写入如下这样两行：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">worker_processes</span> <span class="number">4</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">worker_cpu_affinity <span class="number">0001</span> <span class="number">0010</span> <span class="number">0100</span> <span class="number">1000</span></span></pre></td></tr></table></figure>
<a id="more"></a>
<p>这两行的意思是说，开启4个工作进程，并同时启用CPU的4个核心，这样能加快Nginx的响应速度。之后可以用top命令来验证，是不是开启了4个CPU在工作。</p>
<h2 id="2-在events中开启epoll。"><a href="#2-在events中开启epoll。" class="headerlink" title="2. 在events中开启epoll。"></a>2. 在events中开启epoll。</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">events&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">use</span> <span class="literal">epoll</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>Epoll事件模型是Nginx之所以优于Apache的杀手锏技术，但只有在Linux 2.6及以上内核中才可采用，如果内核是2.6以上的，一定要打开。</p>
<h2 id="3-设定Nginx文件句柄数"><a href="#3-设定Nginx文件句柄数" class="headerlink" title="3. 设定Nginx文件句柄数"></a>3. 设定Nginx文件句柄数</h2><p>使用ulimit -n得到文件查看数限制，设置到worker_rlimit_nofile中，我的系统中是1024。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">worker_rlimit_nofile</span> <span class="number">1024</span></span></pre></td></tr></table></figure>
<h2 id="4-设定连接数worker-connections："><a href="#4-设定连接数worker-connections：" class="headerlink" title="4. 设定连接数worker_connections："></a>4. 设定连接数worker_connections：</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">events&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">worker_connections</span> <span class="number">1024</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<p>根据Nginx的理论计算公式：最大连接数=worker_processes*worker_connections/4，因此，本例中的计算结果应该是：</p>
<p>最大连接数=4*1024/4=1024</p>
<p>所以，如果要设置max_clients的话，可将其设置为1024。我这是小内存Server，内存充足的话，设置成8000-10000也没问题的。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">events&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">max_clients</span> <span class="number">1024</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
<h2 id="5-在某些情况下（具体可参考-wiki-nginx-org）"><a href="#5-在某些情况下（具体可参考-wiki-nginx-org）" class="headerlink" title="5. 在某些情况下（具体可参考 wiki.nginx.org）"></a>5. 在某些情况下（具体可参考 wiki.nginx.org）</h2><p>Nginx 内部重定向规则会被启动。如：当 URL 指向一个目录并且在最后没有包含“/”时，Nginx 内部会自动的做一个 301的重定向，这时会有两种情况：</p>
<p>server_name_in_redirect on（默认），URL 重定向为： server_name 中的第一个域名 + 目录名 + /；<br>server_name_in_redirect off，URL 重定向为： 原 URL 中的域名 + 目录名 + /。<br>这里建议设置成off：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">server_name_in_redirect</span> <span class="literal">off</span></span></pre></td></tr></table></figure>
<h2 id="6-设置server-names-hash-bucket-size"><a href="#6-设置server-names-hash-bucket-size" class="headerlink" title="6. 设置server_names_hash_bucket_size"></a>6. 设置server_names_hash_bucket_size</h2><p>保存服务器名字的hash表是由指令 server_names_hash_max_size和 server_names_hash_bucket_size所控制的。参数hash_bucket_size总是等于hash表的大小，并且是一路处理器缓存大小的倍数。在减少了在内存中的存取次数后，使在处理器中加速查找hash表键值成为可能。如果hash_bucket_size等于一路处理器缓存的大小，那么在查找键的时候，最坏的情况下在内存中查找的次数为2。第一次是确定存储单元的地址，第二次是在存储单元中查找键 值。因此，如果Nginx给出需要增大hash_max_size 或 hash_bucket_size的提示，那么首要的是增大前一个参数的大小。这里直接给出结果吧：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">server_names_hash_bucket_size</span> <span class="number">128</span>;</span></pre></td></tr></table></figure>
<h2 id="7-隐藏Nginx版本号，设置server-tokens："><a href="#7-隐藏Nginx版本号，设置server-tokens：" class="headerlink" title="7. 隐藏Nginx版本号，设置server_tokens："></a>7. 隐藏Nginx版本号，设置server_tokens：</h2><p>server_tokens off;</p>
<h2 id="8-设置client-header-buffer-size和large-client-header-buffers"><a href="#8-设置client-header-buffer-size和large-client-header-buffers" class="headerlink" title="8. 设置client_header_buffer_size和large_client_header_buffers"></a>8. 设置client_header_buffer_size和large_client_header_buffers</h2><p>Nginx中经常出现难以查找原因的400错误，主要是这两个配置造成的，配置这两项：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">client_header_bufffer_size</span> <span class="number">32k</span>;</span></pre></td></tr></table></figure>
<p>large_client_header_buffers 4 32k;</p>
<h2 id="9-设置客户端通过Nginx提交文件的最大尺寸："><a href="#9-设置客户端通过Nginx提交文件的最大尺寸：" class="headerlink" title="9. 设置客户端通过Nginx提交文件的最大尺寸："></a>9. 设置客户端通过Nginx提交文件的最大尺寸：</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">client_max_body_size</span> <span class="number">8m</span>;</span></pre></td></tr></table></figure>
<p>我这里写的是8M，足够上传照片了，如果还嫌不够，可以修改成32M。</p>
<h2 id="10-打开sendfile："><a href="#10-打开sendfile：" class="headerlink" title="10. 打开sendfile："></a>10. 打开sendfile：</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sendfile</span> <span class="literal">on</span>;</span></pre></td></tr></table></figure>
<h2 id="11-禁止TCP-Push："><a href="#11-禁止TCP-Push：" class="headerlink" title="11. 禁止TCP Push："></a>11. 禁止TCP Push：</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">tcp_nopush</span> <span class="literal">on</span>;</span></pre></td></tr></table></figure>
<p>该指令用于在FreeBSD或Linux系统上允许/禁止使用TCP PUSH标志位，仅当sendfile on开启时有效。</p>
<h2 id="12-设置keepalive超时时间"><a href="#12-设置keepalive超时时间" class="headerlink" title="12. 设置keepalive超时时间"></a>12. 设置keepalive超时时间</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">keepalive_timeout</span> <span class="number">60</span>;</span></pre></td></tr></table></figure>
<p>该指令用于设置keepalive会话超时时间，默认为75秒。</p>
<h2 id="13-设置tcp-nodelay"><a href="#13-设置tcp-nodelay" class="headerlink" title="13.设置tcp_nodelay"></a>13.设置tcp_nodelay</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">tcp_nodelay</span> <span class="literal">on</span>;</span></pre></td></tr></table></figure>
<p>该指令用于允许或禁止Socket中的TCP延时。</p>
<h2 id="14-设置client-body-timeout"><a href="#14-设置client-body-timeout" class="headerlink" title="14. 设置client_body_timeout"></a>14. 设置client_body_timeout</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">client_body_timeout</span> <span class="number">10</span>;</span></pre></td></tr></table></figure>
<p>该指令用于客户端的读取操作超时时间。</p>
<p>其他设置：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">output_buffers</span> <span class="number">1</span> <span class="number">32k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">postpone_output</span> <span class="number">1460</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">open_file_cache</span> max=<span class="number">1000</span> inactive=<span class="number">20s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">open_file_cache_valid</span> <span class="number">30s</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">open_file_cache_min_uses</span> <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">open_file_cache_errors</span> <span class="literal">on</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_connect_timeout</span> <span class="number">300</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_send_timeout</span> <span class="number">300</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_read_timeout</span> <span class="number">300</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_buffer_size</span> <span class="number">32k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_buffers</span> <span class="number">4</span> <span class="number">32k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_busy_buffers_size</span> <span class="number">32k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">fastcgi_temp_file_write_size</span> <span class="number">32k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">gzip</span> <span class="literal">on</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">gzip_buffers</span> <span class="number">4</span> <span class="number">16k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">gzip_http_version</span> <span class="number">1</span>.<span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">gzip_comp_level</span> <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">gzip_types</span> text/plain application/x-javascript text/css application/xml;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">gzip_proxied</span> expired <span class="literal">no</span>-cache <span class="literal">no</span>-store private auth;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_cache_path</span> /var/lib/nginx/cache levels=<span class="number">1</span>:<span class="number">2</span> keys_zone=staticfilecache:<span class="number">80m</span> inactive=<span class="number">1d</span> max_size=<span class="number">2500m</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_temp_path</span> /var/lib/nginx/proxy;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_connect_timeout</span> <span class="number">300</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_read_timeout</span> <span class="number">120</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_send_timeout</span> <span class="number">120</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_buffer_size</span> <span class="number">16k</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">proxy_buffers</span> <span class="number">4</span> <span class="number">16k</span>;</span></pre></td></tr></table></figure>
<p>最后，一定要优化php-fpm，以上的优化你可以不做，但是以下的优化你必须做。</p>
<p>再来优化PHP-FPM，打开/usr/local/php/etc/php-fpm.conf，这个文件和PHP的语法很相似，凡是需要激活的配置，直接删掉前面的分号（;）即可：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">[global]</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attribute">pid</span> = run/php-fpm.pid</span></pre></td></tr><tr><td class="code"><pre><span class="line">process_control_timeout=<span class="number">5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">[www]</span></pre></td></tr><tr><td class="code"><pre><span class="line">listen.allowed_clients = <span class="number">127.0.0.1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">user=www-data</span></pre></td></tr><tr><td class="code"><pre><span class="line">group=www-data</span></pre></td></tr><tr><td class="code"><pre><span class="line">pm=dynamic</span></pre></td></tr><tr><td class="code"><pre><span class="line">pm.max_children=<span class="number">20</span>（一般情况，每增加<span class="number">1</span>，则内存使用会增加<span class="number">20M</span>。<span class="number">256M</span>的VPS建议设置为<span class="number">10</span>，<span class="number">512M</span>的VPS建议设置为<span class="number">20</span>）</span></pre></td></tr><tr><td class="code"><pre><span class="line">pm.max_requests=<span class="number">10000</span>（并发数越大，此请求数应越大）</span></pre></td></tr><tr><td class="code"><pre><span class="line">pm.start_servers =<span class="number">10</span>（初始php-fpm进程数）</span></pre></td></tr><tr><td class="code"><pre><span class="line">emergency_restart_threshold = <span class="number">60</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">emergency_restart_interval = <span class="number">60s</span></span></pre></td></tr></table></figure>
<p>上边这两个，表示在emergency_restart_interval所设值内出现SIGSEGV或者SIGBUS错误的php-cgi进程数如果超过 emergency_restart_threshold个，php-fpm就会优雅重启。这两个选项一般保持默认值。</p>
<p>学问却是太大了，有的时候连我自己都会忘记很多设置，如果你也使用VPS，那么赶快给你的VPS进行优化吧！</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>LNMP</tag>
        <tag>VPS</tag>
        <tag>优化</tag>
      </tags>
  </entry>
</search>
